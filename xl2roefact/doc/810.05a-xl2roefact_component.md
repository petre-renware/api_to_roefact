<!-- NOTE:
- This is the general technical design for `xl2roefactPyPi` component
- The DLD doc is a tech desc of every module, functions
-->


# xl2roefact component

[TOC]



## System modules

`xl2roefact` main and basic modules are:

* `rdinv` read an Excel file and extract invoice data to a JSON file format
* `wrxml`  write, convert the JSON invoice file to a XML file format, respecting schemes required by *RO EFact* standard
* `chkxml` check generated XML file
* `ldxml` load an invoice (ie, its XML associated file) to *ANAF SPV system*
* `chkisld` check if an invoice is already loaded in *ANAF SPV system*
* `config_settings` define system settings & parameters mainly used in invoice info / data detection and extract from invoice Excel format file
* `app_cli` contains the code for `xl2roefact` application command line (CLI) format


Below is presented the ***skeleton logic*** of those modules which and where is relevant <small markdpwn="1">ie meaning where is not enough obvious from code or code complexity exceed usual limits (*for example nore than 100 lines of code per function*)</small>. For more technical details and specification regarding modules [see 810.05a-xl2roefact_DLD_specs.md file](./810.05a-xl2roefact_DLD_specs.md)


### rdinv module logic

Main function of `rdinv` module is `rdinv(...)` which has the following logic sections which are in ***strict sequence in presented order***:

* *search of `invoice_items_area` subtable*. This area is expected to contain invoice lines and is "processed" first because it is more structured and easier to identify; after its identification the header area is considered upper of it and footer area below it

* *solve `invoice_items_area` in 2 step...*. In this step the code-data-variables of items area will be initialized in order to hold information that will be found

* *localize and mark areas for...* section that follows natural the previous one by initializing code-data-variables forcheader and footer areas to hold their corresponding information

* *solve `invoice_header_area`* detailed initialize of header area code-data-variables

* *`ReNaSt`-RegNameStrategy* section that identify and extract the legal registered name of invoice customer

* ...wip... <!-- #FIXME here is a wip (@240115) area that need to be included after finish it -->

* *section to ( Excel data )--->( JSON ) format preparation and finishing* section which prepare Excel original data found to be be saved as JSON as a more "electronic interchangeable" structure




## Working directories

Below is a short description of most important directories that will (can !) be found on local development environment.

* __`invoice_files/`__ default directory for Excel files which is intended to be processed

* ___`build/` this directory which will contain intermediary files resulted from building CLI application, library distribution parts, etc. Directory is subject of `.gitignore`

* ___`dist/`___ package files (wheels, dist), Windows executables, etc, generally all files subject of "public" distribution and download

* __`test_*/`__ contains test invoice samples (from client, a RENware one, a 3rd party one) and some useful specs in dev & test process













<!--#FIXME move at the beginning of doc as a general description and 1st level breakdown of `xl2roefactPyPi` component (ie, a kind of "who's who") -->




## [Detailed design technical documentation](./810.05a-xl2roefact_DLD_specs.md)



