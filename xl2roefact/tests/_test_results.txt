***INFO: Application settings loaded from file.
*** Application xl2roefact launched at 2024-04-04
04:19:01.969623
INFO note: files to process: 
/home/petre/api_to_roefact/xl2roefact/tests/*.xls
x
*** Module rdinv started at 2024-04-04 
04:19:01.973709 to process file 
Fact_Petrom_11017969.xlsx (full path: 
/home/petre/api_to_roefact/xl2roefact/tests/Fact_
Petrom_11017969.xlsx)
INFO note: `rdinv` module, no worksheet 
specified, will open first one: 
'Factura(Invoice)'

Read data as suppl_data_read={'PostalAddress': 
{'StreetName': '...', 'CityName': '...', 
'PostalZone': '...', 'CountryCode': 'RO'}, 
'PartyTaxScheme': {'CompanyID"': '...', 
'TaxScheme': 'VAT'}, 'PartyLegalEntity': 
{'RegistrationName': '...', 'CompanyID': '...'}, 
'Contact': {'Telephone': None, 'ElectronicMail': 
None}}

╭────── Traceback (most recent call last) ──────╮
│ /home/petre/api_to_roefact/xl2roefact/xl2roef │
│ act/app_cli.py:157 in xl2json                 │
│                                               │
│   154 │   │   if owner_datafile is not None:  │
│   155 │   │   │   full_path_owner_datafile =  │
│   156 │   │   │   if full_path_owner_datafile │
│ ❱ 157 │   │   │   │   invoice_datadict = rdin │
│   158 │   │   │   else:                       │
│   159 │   │   │   │   print(f"[red]ERROR: Own │
│   160 │   │   │   │   return  # just exit...  │
│                                               │
│ ╭───────────────── locals ──────────────────╮ │
│ │             a_file = PosixPath('/home/pe… │ │
│ │          file_name = '*.xlsx'             │ │
│ │    files_directory = PosixPath('/home/pe… │ │
│ │ full_path_owner_dat… PosixPath('/home/pe… │ │
│ │                    =                      │ │
│ │ invoice_to_process = PosixPath('/home/pe… │ │
│ │ list_of_files_to_pr… [                    │ │
│ │                    = │                    │ │
│ │                      PosixPath('/home/pe… │ │
│ │                      │                    │ │
│ │                      PosixPath('/home/pe… │ │
│ │                      ]                    │ │
│ │     owner_datafile = PosixPath('owner.ym… │ │
│ │ tmp_files_to_process PosixPath('/home/pe… │ │
│ │                    =                      │ │
│ │            verbose = False                │ │
│ ╰───────────────────────────────────────────╯ │
│                                               │
│ /home/petre/api_to_roefact/xl2roefact/xl2roef │
│ act/rdinv.py:309 in rdinv                     │
│                                               │
│    306 │   │   │   │   │   },                 │
│    307 │   │   │   │   │   "cac_PostalAddress │
│    308 │   │   │   │   │   "cac_Contact": {   │
│ ❱  309 │   │   │   │   │   │   "cbc_Telephone │
│    310 │   │   │   │   │   │   "cbc_Electroni │
│    311 │   │   │   │   │   │   "RegCom": copy │
│    312 │   │   │   │   │   │   "Bank": copy.d │
│                                               │
│ ╭───────────────── locals ──────────────────╮ │
│ │                  _ = None                 │ │
│ │    _area_to_search = ((1, 1), (28, 8))    │ │
│ │          _cell_col = 3                    │ │
│ │        _cell_index = (32, 3)              │ │
│ │          _cell_row = 32                   │ │
│ │ _found_cell_for_inv… (29, 1, 'No. crt.')  │ │
│ │                    =                      │ │
│ │    _start_cell_val = ''                   │ │
│ │    _tmp_label_info = {                    │ │
│ │                      │   'value':         │ │
│ │                      'Denumirea lucrarii  │ │
│ │                      (Request             │ │
│ │                      description)',       │ │
│ │                      │   'location': (    │ │
│ │                      │   │   29,          │ │
│ │                      │   │   2            │ │
│ │                      │   ),               │ │
│ │                      │   'label_value':   │ │
│ │                      'No. crt.',          │ │
│ │                      │                    │ │
│ │                      'label_location': (  │ │
│ │                      │   │   29,          │ │
│ │                      │   │   1            │ │
│ │                      │   )                │ │
│ │                      }                    │ │
│ │    _ulc_footer_row = 34                   │ │
│ │                 db = pylightxl.Database   │ │
│ │         debug_info = False                │ │
│ │ detected_cells_whic… (                    │ │
│ │                    = │   (30, 8),         │ │
│ │                      │   (30, 5),         │ │
│ │                      │   (36, 2),         │ │
│ │                      │   (36, 3),         │ │
│ │                      │   (36, 4),         │ │
│ │                      │   (36, 5),         │ │
│ │                      │   (36, 6),         │ │
│ │                      │   (36, 7),         │ │
│ │                      │   (36, 8),         │ │
│ │                      │   (31, 3),         │ │
│ │                      │   ... +33          │ │
│ │                      )                    │ │
│ │    file_to_process = PosixPath('/home/pe… │ │
│ │ invoice_currency_in… {                    │ │
│ │                    = │   'value': 'RON',  │ │
│ │                      │   'location': (    │ │
│ │                      │   │   28,          │ │
│ │                      │   │   8            │ │
│ │                      │   ),               │ │
│ │                      │   'label_value':   │ │
│ │                      'Currency: RON',     │ │
│ │                      │                    │ │
│ │                      'label_location': (  │ │
│ │                      │   │   28,          │ │
│ │                      │   │   8            │ │
│ │                      │   )                │ │
│ │                      }                    │ │
│ │  invoice_footer_area {                    │ │
│ │                    = │   'start_cell': (  │ │
│ │                      │   │   34,          │ │
│ │                      │   │   1            │ │
│ │                      │   ),               │ │
│ │                      │   'end_cell': (    │ │
│ │                      │   │   49,          │ │
│ │                      │   │   8            │ │
│ │                      │   )                │ │
│ │                      }                    │ │
│ │  invoice_header_area {                    │ │
│ │                    = │   'start_cell': (  │ │
│ │                      │   │   1,           │ │
│ │                      │   │   1            │ │
│ │                      │   ),               │ │
│ │                      │   'end_cell': (    │ │
│ │                      │   │   28,          │ │
│ │                      │   │   8            │ │
│ │                      │   ),               │ │
│ │                      │                    │ │
│ │                      'invoice_number': {  │ │
│ │                      │   │   'value':     │ │
│ │                      '11017969',          │ │
│ │                      │   │   'location':  │ │
│ │                      (                    │ │
│ │                      │   │   │   10,      │ │
│ │                      │   │   │   6        │ │
│ │                      │   │   ),           │ │
│ │                      │   │                │ │
│ │                      'label_value': 'Nr.  │ │
│ │                      Facturii',           │ │
│ │                      │   │                │ │
│ │                      'label_location': (  │ │
│ │                      │   │   │   10,      │ │
│ │                      │   │   │   5        │ │
│ │                      │   │   )            │ │
│ │                      │   },               │ │
│ │                      │   'issued_date': { │ │
│ │                      │   │   'value':     │ │
│ │                      '2023-10-17',        │ │
│ │                      │   │   'location':  │ │
│ │                      (                    │ │
│ │                      │   │   │   11,      │ │
│ │                      │   │   │   6        │ │
│ │                      │   │   ),           │ │
│ │                      │   │                │ │
│ │                      'label_value': 'Data │ │
│ │                      Factura',            │ │
│ │                      │   │                │ │
│ │                      'label_location': (  │ │
│ │                      │   │   │   11,      │ │
│ │                      │   │   │   5        │ │
│ │                      │   │   )            │ │
│ │                      │   },               │ │
│ │                      │   'currency': {    │ │
│ │                      │   │   'value':     │ │
│ │                      'RON',               │ │
│ │                      │   │   'location':  │ │
│ │                      (                    │ │
│ │                      │   │   │   28,      │ │
│ │                      │   │   │   8        │ │
│ │                      │   │   ),           │ │
│ │                      │   │                │ │
│ │                      'label_value':       │ │
│ │                      'Currency: RON',     │ │
│ │                      │   │                │ │
│ │                      'label_location': (  │ │
│ │                      │   │   │   28,      │ │
│ │                      │   │   │   8        │ │
│ │                      │   │   )            │ │
│ │                      │   },               │ │
│ │                      │   'customer_area': │ │
│ │                      {                    │ │
│ │                      │   │   'area_info': │ │
│ │                      {                    │ │
│ │                      │   │   │   'value': │ │
│ │                      'OMV Petrom S.A.',   │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │   (    │ │
│ │                      │   │   │   │   │    │ │
│ │                      8,                   │ │
│ │                      │   │   │   │   │    │ │
│ │                      2                    │ │
│ │                      │   │   │   │   ),   │ │
│ │                      │   │   │   │   (    │ │
│ │                      │   │   │   │   │    │ │
│ │                      18,                  │ │
│ │                      │   │   │   │   │    │ │
│ │                      3                    │ │
│ │                      │   │   │   │   )    │ │
│ │                      │   │   │   )        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'CUI': {     │ │
│ │                      │   │   │   'value': │ │
│ │                      'RO1590082',         │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │   10,  │ │
│ │                      │   │   │   │   2    │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value':       │ │
│ │                      'C.U.I. RO1590082',  │ │
│ │                      │   │   │            │ │
│ │                      'label_location': (  │ │
│ │                      │   │   │   │   10,  │ │
│ │                      │   │   │   │   2    │ │
│ │                      │   │   │   )        │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'RegistrationName':  │ │
│ │                      {                    │ │
│ │                      │   │   │   'value': │ │
│ │                      'OMV Petrom S.A.',   │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │   8,   │ │
│ │                      │   │   │   │   2    │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value':       │ │
│ │                      'n/a',               │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      'n/a'                │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'PostalAddress': {   │ │
│ │                      │   │   │            │ │
│ │                      'cbc_StreetName':    │ │
│ │                      'Coralilor Nr. 22',  │ │
│ │                      │   │   │            │ │
│ │                      'cbc_CityName': '',  │ │
│ │                      │   │   │            │ │
│ │                      'cbc_PostalZone':    │ │
│ │                      'Postal 013329',     │ │
│ │                      │   │   │            │ │
│ │                      'cac_Country': {     │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Identification… │ │
│ │                      'RO'                 │ │
│ │                      │   │   │   }        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'reg_com': { │ │
│ │                      │   │   │   'value': │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │        │ │
│ │                      None,                │ │
│ │                      │   │   │   │   None │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │   'bank': {    │ │
│ │                      │   │   │   'value': │ │
│ │                      'Comerciala Romana', │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │   16,  │ │
│ │                      │   │   │   │   2    │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value':       │ │
│ │                      'Banca Comerciala    │ │
│ │                      Romana',             │ │
│ │                      │   │   │            │ │
│ │                      'label_location': (  │ │
│ │                      │   │   │   │   16,  │ │
│ │                      │   │   │   │   2    │ │
│ │                      │   │   │   )        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'IBAN': {    │ │
│ │                      │   │   │   'value': │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │        │ │
│ │                      None,                │ │
│ │                      │   │   │   │   None │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │   'phone': {   │ │
│ │                      │   │   │   'value': │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │        │ │
│ │                      None,                │ │
│ │                      │   │   │   │   None │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │   'email': {   │ │
│ │                      │   │   │   'value': │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'location': (        │ │
│ │                      │   │   │   │        │ │
│ │                      None,                │ │
│ │                      │   │   │   │   None │ │
│ │                      │   │   │   ),       │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   }            │ │
│ │                      │   },               │ │
│ │                      │   'supplier_area': │ │
│ │                      {                    │ │
│ │                      │   │   'area_info': │ │
│ │                      {                    │ │
│ │                      │   │   │   'value': │ │
│ │                      '/home/petre/api_to… │ │
│ │                      │   │   │            │ │
│ │                      'location':          │ │
│ │                      'external file'      │ │
│ │                      │   │   },           │ │
│ │                      │   │   'CUI': {     │ │
│ │                      │   │   │   'value': │ │
│ │                      '...',               │ │
│ │                      │   │   │            │ │
│ │                      'location':          │ │
│ │                      'external file       │ │
│ │                      (PartyLegalEntity -> │ │
│ │                      CompanyID)',         │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'RegistrationName':  │ │
│ │                      {                    │ │
│ │                      │   │   │   'value': │ │
│ │                      '...',               │ │
│ │                      │   │   │            │ │
│ │                      'location':          │ │
│ │                      'external file       │ │
│ │                      (PartyLegalEntity -> │ │
│ │                      CompanyID)',         │ │
│ │                      │   │   │            │ │
│ │                      'label_value': None, │ │
│ │                      │   │   │            │ │
│ │                      'label_location':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'PostalAddress': {   │ │
│ │                      │   │   │            │ │
│ │                      'cbc_StreetName':    │ │
│ │                      '...',               │ │
│ │                      │   │   │            │ │
│ │                      'cbc_CityName':      │ │
│ │                      '...',               │ │
│ │                      │   │   │            │ │
│ │                      'cbc_PostalZone':    │ │
│ │                      '...',               │ │
│ │                      │   │   │            │ │
│ │                      'cac_Country': {     │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Identification… │ │
│ │                      'RO'                 │ │
│ │                      │   │   │   }        │ │
│ │                      │   │   }            │ │
│ │                      │   }                │ │
│ │                      }                    │ │
│ │ invoice_items_area = {                    │ │
│ │                      │   'keyrows': [     │ │
│ │                      │   │   1,           │ │
│ │                      │   │   '1.NOTE-a',  │ │
│ │                      │   │   2            │ │
│ │                      │   ],               │ │
│ │                      │   'keycols': [     │ │
│ │                      │   │   'Denumirea   │ │
│ │                      lucrarii             │ │
│ │                      (Request             │ │
│ │                      description)',       │ │
│ │                      │   │   'Cantitatea  │ │
│ │                      (Quantity)',         │ │
│ │                      │   │   'Pret unitar │ │
│ │                      (Unit price)',       │ │
│ │                      │   │   'Cota TVA    │ │
│ │                      (VAT %)',            │ │
│ │                      │   │   'Valoare     │ │
│ │                      fara TVA (Value      │ │
│ │                      without VAT)',       │ │
│ │                      │   │   'Valoare TVA │ │
│ │                      (Value VAT)'         │ │
│ │                      │   ],               │ │
│ │                      │   'data': [        │ │
│ │                      │   │   [            │ │
│ │                      │   │   │            │ │
│ │                      'Inlocuit conducta   │ │
│ │                      PSI coloana C2       │ │
│ │                      DAV.',               │ │
│ │                      │   │   │   1,       │ │
│ │                      │   │   │            │ │
│ │                      42756.08,            │ │
│ │                      │   │   │   0.19,    │ │
│ │                      │   │   │            │ │
│ │                      42756.08,            │ │
│ │                      │   │   │            │ │
│ │                      8123.6552            │ │
│ │                      │   │   ],           │ │
│ │                      │   │   [            │ │
│ │                      │   │   │   'SES     │ │
│ │                      8105685514',         │ │
│ │                      │   │   │   '',      │ │
│ │                      │   │   │   '',      │ │
│ │                      │   │   │   '',      │ │
│ │                      │   │   │   '',      │ │
│ │                      │   │   │   ''       │ │
│ │                      │   │   ],           │ │
│ │                      │   │   [            │ │
│ │                      │   │   │   'Acciza  │ │
│ │                      de test (2%)',       │ │
│ │                      │   │   │   1,       │ │
│ │                      │   │   │            │ │
│ │                      855.1216000000001,   │ │
│ │                      │   │   │   0,       │ │
│ │                      │   │   │            │ │
│ │                      855.1216000000001,   │ │
│ │                      │   │   │   0        │ │
│ │                      │   │   ]            │ │
│ │                      │   ]                │ │
│ │                      }                    │ │
│ │ invoice_items_as_kv… [                    │ │
│ │                    = │   {                │ │
│ │                      │   │   'cbc_ID':    │ │
│ │                      '1',                 │ │
│ │                      │   │                │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      1,                   │ │
│ │                      │   │                │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   'cac_Item':  │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_Name':          │ │
│ │                      'Inlocuit conducta   │ │
│ │                      PSI coloana C2       │ │
│ │                      DAV.',               │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': 0.19, │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': 'VAT'      │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   }        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'cac_Price': │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      42756.08,            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_currencyID':    │ │
│ │                      'RON'                │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      42756.08,            │ │
│ │                      │   │                │ │
│ │                      'LineVatAmount':     │ │
│ │                      8123.66              │ │
│ │                      │   },               │ │
│ │                      │   {                │ │
│ │                      │   │   'cbc_ID':    │ │
│ │                      '1.NOTE-a',          │ │
│ │                      │   │                │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      None,                │ │
│ │                      │   │                │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   'cac_Item':  │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_Name': 'SES     │ │
│ │                      8105685514',         │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': None, │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': None       │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   }        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'cac_Price': │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'cbc_currencyID':    │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      None,                │ │
│ │                      │   │                │ │
│ │                      'LineVatAmount':     │ │
│ │                      None                 │ │
│ │                      │   },               │ │
│ │                      │   {                │ │
│ │                      │   │   'cbc_ID':    │ │
│ │                      '2',                 │ │
│ │                      │   │                │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      1,                   │ │
│ │                      │   │                │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   'cac_Item':  │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_Name': 'Acciza  │ │
│ │                      de test (2%)',       │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': 0.0,  │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': 'VAT'      │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   }        │ │
│ │                      │   │   },           │ │
│ │                      │   │   'cac_Price': │ │
│ │                      {                    │ │
│ │                      │   │   │            │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      855.1216000000001,   │ │
│ │                      │   │   │            │ │
│ │                      'cbc_currencyID':    │ │
│ │                      'RON'                │ │
│ │                      │   │   },           │ │
│ │                      │   │                │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      855.12,              │ │
│ │                      │   │                │ │
│ │                      'LineVatAmount': 0.0 │ │
│ │                      │   }                │ │
│ │                      ]                    │ │
│ │  invoice_number_info {                    │ │
│ │                    = │   'value':         │ │
│ │                      '11017969',          │ │
│ │                      │   'location': (    │ │
│ │                      │   │   10,          │ │
│ │                      │   │   6            │ │
│ │                      │   ),               │ │
│ │                      │   'label_value':   │ │
│ │                      'Nr. Facturii',      │ │
│ │                      │                    │ │
│ │                      'label_location': (  │ │
│ │                      │   │   10,          │ │
│ │                      │   │   5            │ │
│ │                      │   )                │ │
│ │                      }                    │ │
│ │ invoice_worksheet_n… 'Factura(Invoice)'   │ │
│ │                    =                      │ │
│ │   issued_date_info = {                    │ │
│ │                      │   'value':         │ │
│ │                      '2023-10-17',        │ │
│ │                      │   'location': (    │ │
│ │                      │   │   11,          │ │
│ │                      │   │   6            │ │
│ │                      │   ),               │ │
│ │                      │   'label_value':   │ │
│ │                      'Data Factura',      │ │
│ │                      │                    │ │
│ │                      'label_location': (  │ │
│ │                      │   │   11,          │ │
│ │                      │   │   5            │ │
│ │                      │   )                │ │
│ │                      }                    │ │
│ │ keyword_for_items_t… 'No. crt.'           │ │
│ │                    =                      │ │
│ │ list_of_excel_works… ['Factura(Invoice)'] │ │
│ │                    =                      │ │
│ │         lrc_footer = (49, 8)              │ │
│ │         lrc_header = (28, 8)              │ │
│ │          meta_info = {                    │ │
│ │                      │   'file':          │ │
│ │                      'Fact_Petrom_110179… │ │
│ │                      │   'file_CRC':      │ │
│ │                      '...file CRC         │ │
│ │                      (uniquely identify   │ │
│ │                      the invoice file     │ │
│ │                      used)',              │ │
│ │                      │                    │ │
│ │                      'last_processing_ti… │ │
│ │                      '2024-04-04T04:19:0… │ │
│ │                      │                    │ │
│ │                      'invoice_worksheet': │ │
│ │                      'Factura(Invoice)',  │ │
│ │                      │                    │ │
│ │                      'invoice_max_rows':  │ │
│ │                      49,                  │ │
│ │                      │                    │ │
│ │                      'invoice_max_cols':  │ │
│ │                      8,                   │ │
│ │                      │                    │ │
│ │                      'items_table_start_… │ │
│ │                      'No. crt.',          │ │
│ │                      │                    │ │
│ │                      'items_table_start_… │ │
│ │                      (                    │ │
│ │                      │   │   29,          │ │
│ │                      │   │   1            │ │
│ │                      │   ),               │ │
│ │                      │                    │ │
│ │                      'invoice_XML_scheme… │ │
│ │                      {                    │ │
│ │                      │   │   'xmlns':     │ │
│ │                      'urn:oasis:names:sp… │ │
│ │                      │   │   'xmlns:cbc': │ │
│ │                      'urn:oasis:names:sp… │ │
│ │                      │   │   'xmlns:cac': │ │
│ │                      'urn:oasis:names:sp… │ │
│ │                      │   │   'xmlns:ns4': │ │
│ │                      'urn:oasis:names:sp… │ │
│ │                      │   │   'xmlns:xsi': │ │
│ │                      'http://www.w3.org/… │ │
│ │                      │   │                │ │
│ │                      'xsi:schemaLocation… │ │
│ │                      'urn:oasis:names:sp… │ │
│ │                      http://docs.oasis-o… │ │
│ │                      │   },               │ │
│ │                      │                    │ │
│ │                      'map_JSONkeys_XMLta… │ │
│ │                      [                    │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cac_InvoiceLine',   │ │
│ │                      │   │   │            │ │
│ │                      'cac:InvoiceLine'    │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cac_Item',          │ │
│ │                      │   │   │            │ │
│ │                      'cac:Item'           │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      │   │   │            │ │
│ │                      'cac:ClassifiedTaxC… │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cac_TaxScheme',     │ │
│ │                      │   │   │            │ │
│ │                      'cac:TaxScheme'      │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cac_Price',         │ │
│ │                      │   │   │            │ │
│ │                      'cac:Price'          │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_ID',            │ │
│ │                      │   │   │   'cbc:ID' │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      │   │   │            │ │
│ │                      'cbc:InvoicedQuanti… │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_unitCode',      │ │
│ │                      │   │   │            │ │
│ │                      'cbc:unitCode'       │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_Name',          │ │
│ │                      │   │   │            │ │
│ │                      'cbc:Name'           │ │
│ │                      │   │   ),           │ │
│ │                      │   │   (            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_Percent',       │ │
│ │                      │   │   │            │ │
│ │                      'cbc:Percent'        │ │
│ │                      │   │   ),           │ │
│ │                      │   │   ... +35      │ │
│ │                      │   ]                │ │
│ │                      }                    │ │
│ │     owner_datafile = PosixPath('/home/pe… │ │
│ │            ret_val = None                 │ │
│ │ tmp_cac_TaxSummary = [                    │ │
│ │                      │   {                │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxableAmount': │ │
│ │                      42756.08,            │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxAmount':     │ │
│ │                      8123.66,             │ │
│ │                      │   │                │ │
│ │                      'cac_TaxCategory': { │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': 0.19, │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': 'VAT'      │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │   'ID':    │ │
│ │                      'S'                  │ │
│ │                      │   │   }            │ │
│ │                      │   },               │ │
│ │                      │   {                │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxableAmount': │ │
│ │                      None,                │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxAmount':     │ │
│ │                      None,                │ │
│ │                      │   │                │ │
│ │                      'cac_TaxCategory': { │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': None, │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': None       │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │   'ID':    │ │
│ │                      'S'                  │ │
│ │                      │   │   }            │ │
│ │                      │   },               │ │
│ │                      │   {                │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxableAmount': │ │
│ │                      855.12,              │ │
│ │                      │   │                │ │
│ │                      'cbc_TaxAmount':     │ │
│ │                      0.0,                 │ │
│ │                      │   │                │ │
│ │                      'cac_TaxCategory': { │ │
│ │                      │   │   │            │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Percent': 0.0,  │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_ID': 'VAT'      │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │   'ID':    │ │
│ │                      'S'                  │ │
│ │                      │   │   }            │ │
│ │                      │   }                │ │
│ │                      ]                    │ │
│ │ tmp_InvoiceLine_list (                    │ │
│ │                    = │   [                │ │
│ │                      │   │   {            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_ID': '1',       │ │
│ │                      │   │   │            │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      1,                   │ │
│ │                      │   │   │            │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'cac_Item': {        │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Name':          │ │
│ │                      'Inlocuit conducta   │ │
│ │                      PSI coloana C2       │ │
│ │                      DAV.',               │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_Percent': 0.19, │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      │   'cbc_ID': 'VAT'  │ │
│ │                      │   │   │   │   │    │ │
│ │                      }                    │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cac_Price': {       │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      42756.08,            │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_currencyID':    │ │
│ │                      'RON'                │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      42756.08,            │ │
│ │                      │   │   │            │ │
│ │                      'LineVatAmount':     │ │
│ │                      8123.66              │ │
│ │                      │   │   },           │ │
│ │                      │   │   {            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_ID':            │ │
│ │                      '1.NOTE-a',          │ │
│ │                      │   │   │            │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'cac_Item': {        │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Name': 'SES     │ │
│ │                      8105685514',         │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_Percent': None, │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      │   'cbc_ID': None   │ │
│ │                      │   │   │   │   │    │ │
│ │                      }                    │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cac_Price': {       │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      None,                │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_currencyID':    │ │
│ │                      None                 │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'LineVatAmount':     │ │
│ │                      None                 │ │
│ │                      │   │   },           │ │
│ │                      │   │   {            │ │
│ │                      │   │   │            │ │
│ │                      'cbc_ID': '2',       │ │
│ │                      │   │   │            │ │
│ │                      'cbc_InvoicedQuanti… │ │
│ │                      1,                   │ │
│ │                      │   │   │            │ │
│ │                      'cbc_unitCode':      │ │
│ │                      None,                │ │
│ │                      │   │   │            │ │
│ │                      'cac_Item': {        │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_Name': 'Acciza  │ │
│ │                      de test (2%)',       │ │
│ │                      │   │   │   │        │ │
│ │                      'cac_ClassifiedTaxC… │ │
│ │                      {                    │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cbc_Percent': 0.0,  │ │
│ │                      │   │   │   │   │    │ │
│ │                      'cac_TaxScheme': {   │ │
│ │                      │   │   │   │   │    │ │
│ │                      │   'cbc_ID': 'VAT'  │ │
│ │                      │   │   │   │   │    │ │
│ │                      }                    │ │
│ │                      │   │   │   │   }    │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cac_Price': {       │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_PriceAmount':   │ │
│ │                      855.1216000000001,   │ │
│ │                      │   │   │   │        │ │
│ │                      'cbc_currencyID':    │ │
│ │                      'RON'                │ │
│ │                      │   │   │   },       │ │
│ │                      │   │   │            │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      855.12,              │ │
│ │                      │   │   │            │ │
│ │                      'LineVatAmount': 0.0 │ │
│ │                      │   │   }            │ │
│ │                      │   ],               │ │
│ │                      )                    │ │
│ │ tmp_reusable_items = {                    │ │
│ │                      │                    │ │
│ │                      'cbc_LineExtensionA… │ │
│ │                      43611.0,             │ │
│ │                      │   'LineVatAmount': │ │
│ │                      8123.0               │ │
│ │                      }                    │ │
│ │         ulc_footer = (34, 1)              │ │
│ │         ulc_header = (1, 1)               │ │
│ │                 ws = pylightxl.Database.… │ │
│ ╰───────────────────────────────────────────╯ │
╰───────────────────────────────────────────────╯
KeyError: 'phone'
