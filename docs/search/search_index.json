{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Acasa","text":"<p>RENware Software Systems</p>"},{"location":"index.html#invoicetoroefact","title":"INVOICEtoROefact","text":"<p>Cuprins:</p> <ul> <li>INVOICEtoROefact<ul> <li>Componentele si facilitatile sistemului</li> <li>Date identificare</li> </ul> </li> </ul> <p>Acest sistem va asigura incarcarea facturilor emise in sistemul ANAF E-Factura.</p>"},{"location":"index.html#componentele-si-facilitatile-sistemului","title":"Componentele si facilitatile sistemului","text":"<p>Sistemul ofera urmatoarele componente:</p> <ul> <li> <p>xl2roefact - procesarea facturilor in mod linie de comanda</p> </li> <li> <p>web2roefact - procesarea facturilor din interfara web  </p> </li> <li> <p>xl2roefact PyPi library - procesarea facturilor prin cod / program (development propriu)</p> </li> <li> <p>invoice template - model / sablon factura in Excel</p> </li> </ul> <p>Descrierea tuturor acestora poate fi accessata aici.</p>"},{"location":"index.html#date-identificare","title":"Date identificare","text":"<ul> <li>p/n: <code>0000-0095</code></li> <li>code-name: <code>api_to_roefact</code></li> <li>commercial name: INVOICEtoROefact</li> <li>site web</li> <li>git repository</li> <li>copyright: RENware Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> <li>general system license</li> </ul>"},{"location":"CHANGELOG.html","title":"CHANGELOG sistem","text":"<p>RENware Software Systems</p> <p>INVOICEtoROefact Project</p> <ul> <li>CHANGELOG<ul> <li>0.1 (-#NOTE_wip...)<ul> <li>#TODO..._wip... 0.1.22.dev xl2roefact application interface improvements &amp; invoice customer info-optional items (bank, email, reg-com, phone) (#NOTE upd \".dev\" qualifier &amp; set date here...)</li> <li>0.1.21.post3 cleaned system documentation and site (240211 h23:59)</li> <li>0.1.21.post2 xl2roefact app detailed section with commands &amp; options \"--help\" like (240206 h23:59)</li> <li>0.1.21.post1 fixed missing links in site root index page (240203 h10:30)</li> <li>0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)</li> <li>0.1.20.dev invoice customer address (240123 h10:00)</li> <li>0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)</li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)</li> <li>0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)</li> </ul> </li> </ul> </li> <li>Archived CHANGELOGs</li> </ul>"},{"location":"CHANGELOG.html#changelog","title":"CHANGELOG","text":"<ul> <li>For version code structure meaning see SDEVEN methodology document</li> <li>with (F) are marked those changes that are features in order to be copied in a RELNOTE file and with (B) bug fixes from versions released</li> <li>publishing is made under <code>publishing</code> branch</li> <li><code>&lt;PROJECT ROOT&gt;/doc_src/</code> is the default starting location in a file path (if not clear from context) (ATTN - in production environment is <code>docs/</code>)</li> <li><code>&lt;WEB_ROOT&gt;/</code> is the HTTP server root directory, as default <code>docs/</code> and supposed if no other parent is specified</li> </ul>"},{"location":"CHANGELOG.html#01-note_wip","title":"0.1 (-#NOTE_wip...)","text":"<pre><code>    - ---[ #TODO general planning board ]---------------------------\n    * ai un exemplu complet si complet agnostic (trimis Gigi) de factura format XML si PDF tiparit ca sa faci: (1) incarcare XML (2) geenrare PDF (3) compararea variantelor si identificarea schemei XSD + document specificatii ANAF ref sistemul E-Factura (PDF trimis Liviu)\n    * -#NOTE link Swagger servicii web: `https://mfinante.gov.ro/web/efactura/informatii-tehnice`\n    * -#NOTE link specif API incarcare fact: `https://mfinante.gov.ro/static/10/eFactura/upload.html#/EFacturaUpload/handleRequest`\n\n    - ---[ #TODO short planning board ]---------------------------\n    * left OPEN ISSUES on: `0.1.7` release (and drop them when fixed).\n      ...Aici descrierea pe scurt: in file `xl2roefact\\invoice_files/_PLAN_model_test_factura_generat_anaf.xml`, line 114:_ `&lt;cbc:ID&gt;S&lt;/cbc:ID&gt; #FIXME clarify.me_ pare a fi TIPUL PRODUSULUI: (S)erviciu sau ??? (P)rodus sau ???`\n    -\n    * ... FUTURE NEW APP COMMANDS :\n        * `config` - set `config_settings.py` variables (make it INTERACTIVELY using `Rich prompt`)\n        * `xl2json` - crt_wip... (last upd @ 240123)\n        * `json2xml` - see module WRXML,\n        * `json2pdf` - new tbd..,\n        * `xml2roefact` - see mpdule LDXML\n        * chk for other commands from doc `https://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-xl2roefact`\n    -\n    * -#NOTE_PLAN `rdinv` module:\n        * invoice header\n            * [ ] wip... invoice header - customer bank, RegCom, email, tel, ...\n            * [ ] invoice header - supplier (`&lt;cac:AccountingSupplierParty&gt;`)\n            * [ ] invoice grand totals (there was left a comment ref whole XML structure in rdinv(), line # ~ where build &amp; write \"Invoice\" key)\n    -------------------------------------------------------------------------------------------------\n</code></pre>"},{"location":"CHANGELOG.html#todo_wip-0122dev-xl2roefact-application-interface-improvements-invoice-customer-info-optional-items-bank-email-reg-com-phone-note-upd-dev-qualifier-set-date-here","title":"#TODO..._wip... 0.1.22.dev xl2roefact application interface improvements &amp; invoice customer info-optional items (bank, email, reg-com, phone) (#NOTE upd \".dev\" qualifier &amp; set date here...)","text":"<ul> <li> <p>tbd.Must... @RELEASE follow <code>/RELEASE-QA_checklist.md</code></p> </li> <li> <p>wip.Would... automate GitHub site build &amp; publishing. Last attempt @<code>240216piu_a</code>.</p> </li> <li> <p>tbd.Should... [piu_240126] left in <code>setup.py</code> comments &amp; example ref how to pre-set MSI build meta information / parameters (obj: default target dir where install, path registration, ...)</p> </li> <li> <p>tbd.Must... publish <code>xl2roefact</code> package --&gt; read PDM doc ref package release</p> </li> <li> <p>tbd.Could... init a PDM simple env in project root. Keep in mind:</p> <ul> <li>root project is for SITE GENERATION. ? the <code>web2roefact</code> will need its own directory5like <code>xl2roefact</code> ?</li> <li>as consequence the project name is INVOICEtoROefact</li> <li>and the version is last from CHANGELOG</li> </ul> </li> <li> <p>tbd.Must... invoice customer search for other keys: \"reg com\", \"bank / IBAN / cont\", \"tel\", \"email\" (start in <code>rdinv()</code> w./line 179 &amp; then 331)</p> </li> <li> <p>wip...</p> </li> <li> <p>TODO: wip ...240214piu_b make in site a dedicated page for downloads: \"Help --&gt; Downloads\" and refer it in all places where downloads are intended. Detailed specs:</p> <ul> <li> dedicated downloads page <code>doc_src/downloads.md</code>  #NOTE use template from main README.md</li> <li> collected all existing dwndld links in <code>doc_src/downloads.md</code> - need to be moved at their right positions in file</li> <li> for next items, in <code>downloads.md</code> there are already built links to sections (as html comments in file):<ul> <li> refer that page in <code>xl2roefact/README.md</code></li> <li> refer that page in <code>xl2roefact/doc/README_xl2roefact_library.md</code>, <code>excel_invoice_template/README.md</code></li> <li> refer that page in <code>excel_invoice_template/README.md</code></li> </ul> </li> <li> <code>mkdocs.yml</code> nav entry for  \"Help --&gt; Descarcare resurse (Downloads)\" to <code>doc_src/downloads.md</code></li> <li> fill in <code>...downloads.md</code> page with all existing deliverables GROUPED BY file types &amp; ORDER BY version DESC</li> </ul> </li> <li> <p>-------TODO:.from.here.to.up:-------- test &amp; rebuild all (<code>pdm build_all</code>) &amp; site. Updates to check:         - page \"Help --&gt; Downloads\" (or in topnav area?)         - <code>app_cli.settings()</code> function docstring: display arguments in \"Referinta API\"         - chk if show <code>-r</code>  option in \"Referinta CLI\"</p> </li> <li> <p>240216piu_a automated GitHub site build &amp; publishing. FIXED ERROR: <code>mkdocs_typer._exceptions.MkDocsTyperException: 'run' must be a 'typer.main.Typer' object, got &lt;class 'function'&gt;</code> was changed <code>run</code> object to <code>app_cli</code> one</p> </li> <li>240214piu_c.BUGFIX ref <code>240213piu_a.FAILED</code> fixed &amp; enabled <code>.github/.../ci.yml</code>. To test by merging to <code>build</code></li> <li>240214piu_a xl2roefact component (<code>.../app_cli.py</code>) function <code>settings(...)</code> add <code>--rules</code> option (param) to display <code>config_settings.__doc__</code></li> <li>240213piu_a.FAILED merged for <code>/requirements.txt</code> lief package update as OK-PAS &amp; disabled gh-workflow by renaming <code>ci.yml</code> to <code>ci.yml temp_disabled</code>. Actions tried:  (-1.) updated <code>.gh-workflow.../ci.yml</code>  (-2.) \"small change\" in <code>/README.md</code> in copyright year to test  (-3.) merge to <code>build</code> branch for test</li> <li>240212piu_e.BUGFIX navigation \"xl2roefact --&gt; Referinta CLI\" (file <code>/mkdocs.yml</code>). Updated <code>xl2roefact/README.md</code> add a <code>&lt;a id=\"comenzile-aplicatiei\"&gt;&lt;/a&gt;</code> after header \"## Comenzile aplicatiei\" paragraph \"Detalii comenzi:\" and ref it accordingly in mkdocs.yml navigation following HTML file, not MARKDOWN one</li> <li>240212piu_d rebuild all deliverables <code>pdm build_all</code> ==&gt; v0.1.22 MSI, WHL, SDIST &amp; moved them to a dedicated <code>_WIP_0.1.22_/</code> until decide to rebuild or keep</li> <li>240212piu_c added navigation \"xl2roefact --&gt; Referinta CLI\" (file <code>/mkdocs.yml</code>). Built &amp; published site (<code>mkdocs build</code>).</li> <li>240212piu_b updated <code>.../xl2roefact/app_cli.py</code> to format app logo string as markdown. Updated packages (<code>pdm build_all</code>).</li> <li>240212piu_a review and updated xl2roefact logo (file: <code>...xl2roefact/__version__</code>). Updated API Reference doc (<code>pdm build_doc</code>). Clean project of obsolete files &amp; open issues</li> </ul>"},{"location":"CHANGELOG.html#0121post3-cleaned-system-documentation-and-site-240211-h2359","title":"0.1.21.post3 cleaned system documentation and site (240211 h23:59)","text":"<ul> <li>240211piu_b tested &amp; reviewed <code>240211piu_a</code> ==&gt; published site</li> <li>240211piu_a upated <code>xl2roefact/README.md</code> clean section \"Instalarea\", preserved only Windows and Linux specs to run CLI component, ie, dropped library references as irrelevant at this point</li> <li>240210piu_b test for iss <code>240210piu_a</code> ==&gt; PASS<ul> <li> app as functional (there are updates in code),</li> <li> re-build tech doc (<code>pdm build_doc</code>),</li> <li> build &amp; publish site</li> </ul> </li> <li>240210piu_a reviewed &amp; updated all <code>xl2roefact</code> modules for their docstring</li> <li>240209piu_c updated <code>xl2roefact</code> component, README file, restructured info ref JSON file format (dropped redundant info)</li> <li>240209piu_b reviewed &amp; corrected <code>240209piu_a, 240208piu_a</code>. Published site</li> <li>240209piu_a updated <code>xl2roefact *</code> documentation to drop redundant info (badges, prev versions useless details)</li> <li>240208piu_a updated <code>xl2roefact library</code> documentation, docstring(s) and <code>mkdocs.yml</code> navigation entries to clarify subjects by using specific technical terms (this component address technical users not business ones)</li> <li>240207piu_b improve site readability by detailed description at bullet items level and dropping / moving in other parts the content non \"end user related\" from: <code>/README.md</code>, <code>doc_src/.../810.05a-system_components.md</code></li> <li>240207piu_a updated all site in pages references to system components &amp; deliverables version</li> </ul>"},{"location":"CHANGELOG.html#0121post2-xl2roefact-app-detailed-section-with-commands-options-help-like-240206-h2359","title":"0.1.21.post2 xl2roefact app detailed section with commands &amp; options \"--help\" like (240206 h23:59)","text":"<ul> <li>240206piu_c test &amp; release: -- create release, -- publish site, -- save deliverable archives</li> <li>240206piu_b install package: <code>pip install mkdocs-typer</code> &amp; upd back <code>requirements.txt</code></li> <li>240206piu_a add <code>mkdocs-typer</code> extension and update <code>xl2roefact/README.md</code>, section <code>Comenzile aplicatiei</code> page with generated documentation by this plugin</li> </ul>"},{"location":"CHANGELOG.html#0121post1-fixed-missing-links-in-site-root-index-page-240203-h1030","title":"0.1.21.post1 fixed missing links in site root index page (240203 h10:30)","text":"<ul> <li>240203piu_a fixed links in <code>/README.md</code> for: <code>xl2roefact PyPi</code> entry</li> </ul>"},{"location":"CHANGELOG.html#0121-rollout-news-in-system-portal-invoicetoroefactrenwareeu-240203-h0900","title":"0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)","text":"<ul> <li>240201piu_a reorganized <code>xl2roefact*</code> components by disseminating the installable application, which is something available \"as is now\" just for Windows operating system. For Linux there is no difference between command line application and Python package from an end user point of view.</li> <li>240131piu_a <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code> clean &amp; transform to \"first entry to <code>xl2roefactPyPi</code>\"</li> <li>240131piu_a updated <code>mkdocs.yml</code>: cleaned navigation, created version variables, updated default site build directory to <code>docs/</code>, cleared excluded directories entry</li> <li>240130piu_b reviewed all changes, update site PDF generator file (mvd <code>print_page.md</code> to root) location, fixed navigation. PUBLISHED for <code>xl2roefact</code> component</li> <li>240130piu_a reviewed <code>xl2roefact</code> README: cleaned, translated 2 RO, structured to \"end user needs\"</li> <li>240129piu_d updated <code>xl2roefact</code> to have \"Descrierea detliata\" link in <code>810.05a-system_components.md</code>. Prepared component to be published: mkdocs.yml navigation &amp; main site README index</li> <li>240129piu_c updated all site pages to contain <code>&lt;small&gt;**RENware Software Systems**&lt;/small&gt;</code> &amp; <code>[TOC]</code> after title</li> <li>240129piu_b cleanup project docs, requirements, fresh install ==&gt; published site as is at this point (invoice template finished)</li> <li>240129piu_a updated <code>xl2roefact/README.md</code> with section for assets download</li> <li>240128piu_e formal versioning <code>invoice template</code> component</li> <li>240128piu_d updated &amp; closed component <code>invoice template</code>. Referred in:<ul> <li><code>doc_src/810-DSGN/810.05a-system_components.md</code></li> <li>portal first page</li> <li>navigation in <code>mkdocs.yml</code></li> </ul> </li> <li>240128piu_c moved <code>xl2roefact/excel_invoice_template/</code> directory to root as being distinct component, review it and closed to be published</li> <li>240128piu_b revised, updated and closed crt version of <code>excel_invoice_template/README.md</code></li> <li>240128piu_a updated <code>xl2roefact/README.md</code> &amp; <code>excel_invoice_template/README.md</code> files, cleared modularization &amp; structure presented in system public site</li> <li>240127piu_d Unify main project <code>/READMEmd</code> with <code>doc_src/index.md</code>:<ul> <li>make the same INDEX just in the project root == index / README of whole project</li> <li>keep from actual project README.md the section ref project identification and move it to end of file as last section</li> </ul> </li> <li>240127piu_c created <code>/index.html</code> to redirect to \"real\" system index (<code>doc_src/index.md</code>) and prevent usage of project <code>README.md</code> file instead</li> <li>240128piu_c checked work <code>240127piu_a</code>, <code>240127piu_b</code>, updated <code>about.md</code> and navigation with ref to sys structure (<code>.../810.05a-system_components.md</code>)</li> <li>240127piu_b update system components and their classification (in <code>.../810-DSGN/810.05a-system_components.md</code>)</li> <li>240127piu_a updated <code>810-DSGN/810.05a-system_components.md</code>, defined a classification usable to quickly find out who-does-what</li> <li>240125piu_a updated <code>mkdocs.yml</code> by including <code>mkdocs-same-dir</code> plug-in</li> </ul>"},{"location":"CHANGELOG.html#0120dev-invoice-customer-address-240123-h1000","title":"0.1.20.dev invoice customer address (240123 h10:00)","text":"<ul> <li> <p>240123piu_b make a full chk / review for FIXME &amp; run <code>pdm build_all</code></p> </li> <li> <p>240123piu_a <code>def_inv_dir</code> issue ref Excel invoices default get directory, see comments in <code>app_cli.py</code> function <code>xl2json(...)</code></p> </li> <li> <p>240121piu_a updated <code>config_settings.py</code> &amp; <code>rdinv.py</code> with constants: <code>PATTERN_FOR_PARTNER_REGCOM</code>, <code>PATTERN_FOR_PARTNER_IBAN</code>, <code>PATTERN_FOR_PARTNER_TEL</code>, <code>PATTERN_FOR_PARTNER_EMAIL</code>, <code>PATTERN_FOR_PARTNER_BANK</code></p> </li> <li> <p>@CANCELED 240118_admin02 generalize a function <code>get_partner_info(partner_type: str \"customer\" | \"supplier\")</code> to get partner info with partner type as being parameter</p> </li> <li> <p>240118piu_a reviewed and cleaned code: <code>rdinv.rdinv()</code>, <code>config_settings</code>, <code>excel_invoice_template/invoice_template_CU_tva.xlsx</code> (according to updates in testing used invoice)</p> </li> <li> <p>240113piu_a to find <code>cac:PostalAddress</code> and write to:</p> <ul> <li> 1. right set position of key <code>\"cac_PostalAddress\"</code> in basic structure (invoice_header_area)</li> <li> 2a. find excel area ref customer address (...invoice_header_area...)</li> <li> 2b. disseminate &amp; save excel original area (...invoice_header_area...)</li> <li> 3. get &amp; set <code>[\"Invoice\"][\"cac_PostalAddress\"]</code> and all is subsequent keys</li> <li> 4. update XML - JSON map for item \"under\" <code>cac_PostalAddress</code></li> <li> 5. defined and included for use <code>DEFAULT_SUPPLIER_COUNTRY</code> and <code>DEFAULT_CUSTOMER_COUNTRY</code> both for \"RO\". Detailed desc and usage in <code>config_settings.py</code> &amp; <code>rdinv.rdinv(...)</code></li> <li> 6. updated invoice template for country explicit field</li> </ul> </li> <li> <p>240116_admin_01 upd version for 0.1.20</p> </li> </ul>"},{"location":"CHANGELOG.html#0119dev-invoice-customer-and-partial-invoice-total-values-calculations-240116-h0600","title":"0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)","text":"<ul> <li> <p>2401_xl2roefact_doc_01 <code>xl2roefact</code> update technical documentation, file <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code></p> </li> <li> <p>240112piu_b 95% clean code <code>rdinv()</code> from customer area identification, from line 204 (kept a DBG print just for area identification (useful for next task ref the same opers but for Supplier))</p> </li> <li> <p>240112piu_a module <code>app_cli.py</code>, created <code>called_when_no_command(...)</code> function called when no command is invoked and to provide only application version (for external users to test it!)</p> </li> <li> <p>240110piu_c <code>xl2json</code> <code>about</code> command to get version &amp; \"nice\" LOGO from <code>xl2roefact/__version__.py</code>, vars <code>__version__</code> &amp; <code>__doc__</code></p> </li> <li> <p>240110piu_b <code>xl2roefact/setup.py</code>ref get app version from file when build EXE/MSI test for <code>__version__</code> is correctly get and release</p> </li> <li> <p>240110piu.a reviewed &amp; updated <code>xl2roefact</code> package <code>README.md</code> + <code>xl2roefact/__version__.py</code> with an app logo and for text mistyping bugs</p> </li> <li> <p>240108piu_c changed <code>pyproject.toml</code> for auto update package version from file <code>xl2roefact/__version__.py</code> (see also opiss 240108piu_b)</p> </li> <li> <p>240108piu_b created <code>xl2roefact/__version__</code> file that contains variable <code>__version__</code> with INTENTION to use in <code>pyproject.toml</code> for app version key (in a future issue)</p> </li> <li> <p>240108piu_a more items:</p> <ul> <li><code>config_settings.py</code> created entry <code>PATTERN_FOR_PARTNER_ADDRESS</code> &amp; updated <code>rdinv</code> module in constants area</li> <li>add comments in <code>app_cli.py</code> ref <code>def_inv_dir</code> issue &amp;&amp;...</li> <li>updated environment dependencies and installed <code>pyinstaller</code> development package with intention to make \"single EXE\" application to be able to run \"from USB stick\"</li> </ul> </li> <li> <p>240107piu_a reviewed <code>xl2roefact</code> package <code>README.md</code>:</p> <ul> <li>(c) explained proposed &amp; promoted directory structure used by CLI application</li> <li>(b) short invoice JSON file structure</li> <li>(a) created first version of tutorial section</li> </ul> </li> <li> <p>240106piu_a invoice customer search and persist for \"RegistrationName\"</p> </li> </ul>"},{"location":"CHANGELOG.html#0118dev-invoice-customer-cui-partial-invoice-total-values-calculations-240105-h0800","title":"0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)","text":"<ul> <li> <p>240105piu_c updated <code>xl2roefact</code> package <code>README.md</code> file (with new sections for intro to Excel invoice content rules, tutorial TODO, reference to technical doc)</p> </li> <li> <p>240105piu_b invoice customer search and persist for \"CUI\"</p> </li> <li> <p>240105piu_a <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for DOWN search-method made it optional with default True (useful for Partners set-of KVs where is supposed to be or IN-LABEL or in RIGHT but NOT DOWN because there is a list of KVs not just one placed anywhere in Excel doc)  #TODO tgis is subject of doc update</p> </li> <li> <p>240103piu_d <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for IN-LABEL search-method to return all string except first word (supposed to be label) separated by space character (old strategy was to get only last work from all string)</p> </li> <li> <p>240103piu_c ref invoice customer created in <code>config_settings.py</code> PATTERNs for search keys <code>PATTERN_FOR_PARTNER_ID</code> (CUI or ID), <code>PATTERN_FOR_PARTNER_LEGAL_NAME</code></p> </li> <li> <p>240103piu_b calculated item lines VAT amount as <code>cac_InvoiceLine.LineVatAmmount</code> as raw float value (not rounded to be able to round just invoice TOTAL)</p> </li> <li> <p>240103piu_a <code>rdinv.rdinv()</code> updated JSON -- XML map (part of function <code>_build_meta_info_key(...)</code>)</p> </li> <li> <p>240102piu_a <code>rdinv.rdinv()</code> upd &amp; improved a clear Customer specific XML compliant structure. Targeted this XML structure:                 <pre><code>    &lt;cac:PartyLegalEntity&gt;\n        &lt;cbc:RegistrationName&gt;IORDANESCU PETRE PFA&lt;/cbc:RegistrationName&gt;\n        &lt;cbc:CompanyID&gt;21986376&lt;/cbc:CompanyID&gt;\n    &lt;/cac:PartyLegalEntity&gt;\n</code></pre></p> </li> <li> <p>240101piu_a clean useless &amp; obsolete project files, test new full build (MSI, Python wheel, documentation) ==&gt; PASS OK</p> </li> <li> <p>231229piu_a invoice customer (<code>&lt;cac:AccountingCustomerParty&gt;</code>) detect &amp; set area to search for specific keys (like CUI, RegCom, IBAN, ...)</p> <ul> <li> 1. established AREA TO SEARCH for PARTNER data an <code>_area_to_search</code> (~line 244)</li> <li> 2. updated <code>config_settings.py</code> changed: (for a clear understating of constant scope, because will follow others for specific keys like: \"reg com\", \"CUI\", \"bank / IBAN / cont\", ...)<ul> <li><code>PATTERN_FOR_INVOICE_CUSTOMER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_CUSTOMER_SUBTABLE_MARKER</code></li> <li><code>PATTERN_FOR_INVOICE_SUPPLIER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_SUPPLIER_SUBTABLE_MARKER</code></li> </ul> </li> <li> 3. set-persist <code>_area_to_search</code> for next steps &amp; save its key-info in associated invoice JSON (for further references) - <code>rdinv()</code> ~line 239</li> <li> 4. updated main xl2roefact README.md document ref latter changes and app structuring, concepts, ...(ideas evolving :)...</li> <li> 5. done code for <code>cac_AccountingSupplierParty</code> key by iterating full <code>invoice_header_area[\"customer_area\"]</code> structure</li> </ul> </li> <li> <p>231228piu_a improved documentation generation:</p> <ul> <li> updated all modules docstring(s) to a right markdown representation in generated documentation (ex: when use bullets THEN DO NOT indent at 1st level)</li> <li> @IMP_NOTE: Changed generated documentation file to <code>doc/810.05a-xl2roefact_DLD_specs.md</code> and referred in main <code>doc/810.05a-xl2roefact_component.md</code> as this being a final solution for whole project documentation (that generated with <code>mkdocs</code>)</li> <li> updated <code>pyproject.toml, [tool.pdm.scripts]</code> table with new generated doc file name (810.05a-xl2roefact_DLD_specs.md)</li> </ul> </li> <li> <p>231227piu_b updated <code>xl2roefact.rdinv</code> module ref dropped <code>_</code> chars from internal function names to allow doc generation by PyDoc until will produce a YAML file for PyDoc generator (where will be able to specify concrete list of objects regarding their names)</p> </li> <li> <p>231227piu_a generated a first draft of markdown documentation:</p> <ul> <li> used Pydoc Markdown @ <code>https://niklasrosenstein.github.io/pydoc-markdown/usage/yaml/#yaml-example</code></li> <li> results ==&gt; <code>&lt;PJ_ROOT&gt;/xl2roefact/doc/generated_810.05a-xl2roefact_component.md</code></li> <li> created PDM shell command <code>pdm run</code> (command just for quick remembers: <code>pydoc-markdown -I xl2roefact --render-toc &gt;doc/generated_810.05a-xl2roefact_component.md</code>)</li> </ul> </li> <li> <p>231226piu_b reviewed <code>xl2roefact</code> all \"in use\" code and updated <code>docstrings</code></p> </li> <li> <p>231226piu_a made some useful PDM scripts (ref <code>pyproject.toml</code>, table section <code>[tool.pdm.scripts]</code>) like build commands for:</p> <ul> <li> <code>pdm build_wheel</code> Python package,</li> <li> <code>pdm build_msi</code> MSI package,</li> <li> <code>pdm build_all</code> build all packages</li> <li> <code>pdm xl2roefact</code> run xl2roefact command</li> <li> updated <code>doc/810.05a-xl2roefact_component.md</code></li> </ul> </li> </ul>"},{"location":"CHANGELOG.html#0117dev-fixed-all-application-package-running-standard-ways-231224-h0530","title":"0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)","text":"<ul> <li> <p>RELEASES:</p> <ul> <li><code>.&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-win64.msi</code></li> <li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17.tar.gz</code></li> <li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-py3-none-any.whl</code></li> </ul> </li> <li> <p>231224piu_a made cli app to run as: Python package main app (<code>python -m xl2roefact</code>) and as script (<code>python xl2roefact.py</code>) while still letting the Python library <code>xl2roefact</code> as importable and use in a programmatic way:</p> <ul> <li> make <code>.../xl2roefact/app_cli.py</code> (from actual <code>.../xl2roefact/__main__.py</code>) which is complete code of CLI app plus a <code>run()</code> function that just launch it</li> <li> make <code>.../xl2roefact/__main__.py</code> that just import <code>app_cli</code> for <code>run()</code> function and call it</li> <li> change actual <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code> to import <code>xl2roefact.app_cli</code> for <code>run()</code> function and call it</li> <li> test for MSI package builds ref <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code></li> <li> clean code, test and close issue:<ul> <li><code>python xl2roefact.py [OPTIONS] COMMAND [ARGS]...</code></li> <li><code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code></li> </ul> </li> </ul> </li> <li> <p>231223piu_a multiple changes ref main code: <code>xl2roefact.py</code> and library <code>xl2roefact</code>, MAINLY created <code>xl2roefact/__main__.py</code> as normal of xl2roefact.py</p> </li> </ul>"},{"location":"CHANGELOG.html#archived-changelogs","title":"Archived CHANGELOGs","text":"<ul> <li>0.1.16.dev improving Excel kv-data search with \"IN-LABEL\" method</li> <li>0.1.15 updated solution portal <code>http://invoicetoroefact.renware.eu/</code></li> <li>0.1.14.dev invoice issue date</li> <li>0.1.13.dev invoice currency</li> <li>0.1.12.dev invoice number</li> <li>0.1.11.dev packaging improvements for app &amp; xl2roefact package</li> <li>0.1.10.dev command interface improved, <code>msi</code> package building, invoice template &amp; updated documentation</li> <li>0.1.9.dev <code>xl2roefact.RDINV</code> running executable and distribution kit</li> <li>0.1.8.dev improved application structure and first executable release</li> <li>0.1.7.dev <code>xl2roefact.RDINV</code> invoice items &amp; metadata + OPEN ISSUES</li> <li>0.1.6.dev commercial agreement OPTIONS document</li> <li>0.1.5.dev init component xl2roefact for CLI application</li> <li>0.1.4.dev Create system backbone structure</li> <li>0.1.3.dev Enhancing <code>payments_validation_board</code> technical proposal</li> <li>0.1.2.dev Enhancing <code>APItoROefact</code> technical proposal</li> <li>0.1.1.dev Elaborating technical proposal</li> <li>0.1.0.dev System raw backbone</li> </ul>"},{"location":"RELEASE-QA_checklist.html","title":"Useful TODOs","text":"<ul> <li>Useful TODOs<ul> <li>RELEASE QA checklist</li> <li>How to Install xl2roefact as local in project package</li> </ul> </li> </ul>"},{"location":"RELEASE-QA_checklist.html#release-qa-checklist","title":"RELEASE QA checklist","text":"<p>Before to publuc release a version check and do the following:</p> <ul> <li> full chk / review for FIXME &amp; run <code>pdm build_all</code></li> <li> change release name from \".dev\" to final one (change all occurrences)</li> <li> update version string in:<ul> <li><code>.../xl2roefact/__version__.py</code> variable <code>__version__</code></li> <li><code>/mkdocs.yml</code> section <code>extra</code></li> </ul> </li> <li> build all: app, documentations, site</li> <li> clean if necessary the <code>.../dist/</code> directory</li> </ul> <p>Optional if possible do:</p> <ul> <li> extract version items in a dedicated file in <code>changelog_history/</code>. The pattern for name is <code>CHANGELOG-&lt;version&gt;.md</code></li> <li> in main CHANGELOG refer thet file (archives section) and clean it from not achieved entries</li> <li> archive locally (in <code>880-RLSE/.../</code> directory) all resulted deliverable</li> </ul>"},{"location":"RELEASE-QA_checklist.html#how-to-install-xl2roefact-as-local-in-project-package","title":"How to Install <code>xl2roefact</code> as local in project package","text":"<p>In master project root (ie, not <code>xl2roefact/</code> directory, but main project directory) execute <code>pip install -e xl2roefact</code>. Now package is installed and all its modules are available.</p>"},{"location":"_curs_share_experience.html","title":"Clubul CALCULATOARUL UN PRIETEN LA JOB","text":"<p>Acest club se adreseaza celor interesati de domeniul IT si \"lumea calculatoarelor\" din diverse motive si ratiuni ce nu se exclud;</p> <ul> <li>face parte din viata lor profesionala, \"jobul\" lor este strins legat de asta</li> <li>este un hobby, o pasiune</li> <li>din curiozitate si vor sa afle mai multe despre 'dedesubturile\" acestora dar si despre activitatile conexe lor, cum ar fi project managementul in lumea IT, proiectarea arhitecturilor, ingineria sistemelor software</li> <li>inteleg / stiu / au auzit ca aceasta \"lume\" a calculatoarelor este un amalgam de \"hardware, software, networking, security\" si vir sa Inteleaga mai practic si concret ce inseamna acestea</li> <li>vor sa Inteleaga lucrurile fara a fi tratate cu formalism excesiv, cu multa teorie \"seaca\" ce uneori pare inutila si de neinteles la ce va folosi - vor sa Inteleaga aceasta lume in mod intuitiv adica \"stiu ca stiu\" si \"inteleg pentru ca inteleg\" chiar daca poate \"nu stiu sa iti demonstrez matematic si fizic\" ;) == ACEASTA INSEAMNA CUNOASTERE INTUITIVA</li> <li>... #TODO more ?</li> </ul>"},{"location":"_curs_share_experience.html#de-ce-acest-eveniment","title":"De ce acest eveniment","text":"<p>In primul rind vreau sa mentionez ca acesta nu este un curs. Nu in acceptiunea clasic incetatenita a ceea ce numim curs.</p> <p>El nu isi propune sa va invete ceva in modul formal clasic de tip teorie predata combinata cu practica. Va luati notite, va pregatiti de un examen. Il sustineti, il luati si aveti o diploma.</p> <p>Nu. Nu asa, dar tot asa :) Numai ca nu luati o diploma ci invatati sa va extindeti mintea, sa o folositi constient si nu mecanic. Iar in ceea ce priveste examinarea, aceasta o veti sustine singuri, in viata de zi cu zi. La acel auto-examen pe care il dam in fiecare clipa si tot noi ne evaluam prin ceea ce credem despre noi. Iar viata ne da feedback-ul final despre ceea ce facem, spunem si gindim...</p> <p>Pe parcursul carierei mele profesionale am impartasi experienta acumulata cu foarte multi oameni, atit subalterni cit si sefi. Am impartasit-o din punctul de vedere (de referinta !) pentru ca fiecare a luat-o (primit-o !) asa cum a crezut de cuviinta si a considerat+o in consecinta.</p> <p>Ea ramine exact si nimic altceva decit ce a fost, indiferent de ce crede fiecare, o experienta impartasita si atit. O informatie care a existat si continua sa existe in mintea mea si a altor oameni ca parte a universului in care existam.</p>"},{"location":"_curs_share_experience.html#ce-teme-isi-propune-acest-curs","title":"Ce teme isi propune acest curs","text":"<p>Subiectele de baza ale acestui curs sunt \"din lumea computerelor si a informaticii\" asa cum este ea cunoscuta acum. ...</p>"},{"location":"_curs_share_experience.html#cine-sunt-eu","title":"Cine sunt eu","text":"<p>...</p>"},{"location":"print_page.html","title":"NOTE: empty document that should be PPRESENT here (content not matters) to serve as reference for final generation of <code>print_page.html</code> (generation is delayed and is based on final result of site navigation structure)","text":""},{"location":"changelog_history/CHANGELOG-0.1.0.dev.html","title":"CHANGELOG 0.1.0.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.0.dev System raw backbone<ul> <li>0.1.0 System raw backbone (231104 07:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.0.dev.html#changelog-010dev-system-raw-backbone","title":"CHANGELOG 0.1.0.dev System raw backbone","text":""},{"location":"changelog_history/CHANGELOG-0.1.0.dev.html#010-system-raw-backbone-231104-0700","title":"0.1.0 System raw backbone (231104 07:00)","text":"<ul> <li>231104piu_a created first raw system backbone &amp; directories structure</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.1.dev.html","title":"CHANGELOG 0.1.1.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.1.dev<ul> <li>0.1.1 Elaborating technical proposal (231104 08:45)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.1.dev.html#changelog-011dev","title":"CHANGELOG 0.1.1.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.1.dev.html#011-elaborating-technical-proposal-231104-0845","title":"0.1.1 Elaborating technical proposal (231104 08:45)","text":"<ul> <li>231104piu_b got all commercial documents (including <code>110-SRE-general_requirements.md</code>) in directory <code>doc_src/commercial_agreement/</code></li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.10.dev.html","title":"CHANGELOG 0.1.10.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.10.dev<ul> <li>0.1.10 command interface improved, msi package building, invoice template &amp; updated documentation (231207 h12:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.10.dev.html#changelog-0110dev","title":"CHANGELOG 0.1.10.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.10.dev.html#0110-command-interface-improved-msi-package-building-invoice-template-updated-documentation-231207-h1200","title":"0.1.10 command interface improved, <code>msi</code> package building, invoice template &amp; updated documentation (231207 h12:00)","text":"<ul> <li> <p>231207piu_b build a <code>MSI</code> package for <code>0.1.10</code> version ==&gt; <code>0.1.10-xl2roefact-0.1-win64.msi</code>, also installed <code>Python 3.11</code> + <code>cx-Freeze</code> &amp; updated <code>requirements_xl2roefact.txt</code></p> </li> <li> <p>231207piu_a FIXED errors due to Excel files directory duplication in <code>xl2roefact</code> &amp; <code>rdinv()</code></p> </li> <li> <p>231206piu_a clean code for <code>rdinv</code> &amp; <code>xl2roefact</code>, reviewed cnd closed some open issues (todos, notes, ...)</p> </li> <li> <p>231205piu_b made a directory for INVOICE TEMPLATE (<code>excel_invoice_template/</code>) to be delivered with solutions \"for who need a simple template\", also write here a <code>README_excel_invoice_rules.md</code> to describe all required conditions in order to be \"RECOGNIZED &amp; TRANSLATED to JSON\"</p> </li> <li> <p>231205piu_a change all solution to use <code>rich</code> library instead of <code>colorama</code> (Rich library ref <code>https://rich.readthedocs.io/en/stable/index.html</code>)</p> <ul> <li> drop all <code>from colorama import Fore, Back, Style</code></li> <li> add new <code>from rich import print</code></li> <li> update all places where <code>{Fore....}</code> with <code>[...]</code> as:<ul> <li> <code>{Fore.YELLOW}</code> with <code>[yellow]</code></li> <li> <code>{Fore.GREEN}</code> with <code>[green]</code></li> <li> <code>{Fore.MAGENTA}</code> with <code>[magenta]</code></li> <li> <code>{Fore.BLUE}</code> with <code>[blue]</code></li> <li> <code>{Fore.CYAN}</code> with <code>[cyan]</code></li> <li> <code>{Fore.RED}</code> with <code>[red]</code></li> </ul> </li> <li> change all <code>typer.echo</code> with <code>print</code></li> <li> update all places where <code>{Style.RESET_ALL}</code> with <code>[/]</code></li> </ul> </li> <li> <p>231204piu_c build new executable and installer ==&gt; <code>dist/0.1.10.231204piu_a-xl2roefact-0.1-win64.msi</code></p> </li> <li> <p>231204piu_b created <code>./doc/</code> renamed and moved all documentation documents - intention to keep clean <code>xl2roefact root</code></p> </li> <li> <p>231204piu_a <code>xl2roefact xl2json</code> check rdinv() result and if return False, ONLY print a message of \"INFO note\" then continue with next file (the effective error was print by module itself) &amp;&amp; build a new executable package ==&gt; <code>dist/0.1.10.231204piu_a-exe.win-amd64-3.10.zip</code></p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.11.dev.html","title":"CHANGELOG 0.1.11.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.11.dev</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.11.dev.html#changelog-0111dev","title":"CHANGELOG 0.1.11.dev","text":"<ul> <li> <p>231209piu_c build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.11-xl2roefact-0.1-win64.msi</code></li> <li> excel invoice template package ==&gt; <code>dist/0.1.11-excel_invoice_template.zip</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> </ul> </li> <li> <p>231209piu_b fixed <code>xl2roefact</code> CLI options, help, defaults, short names and STABILIZED EXECUTION</p> </li> <li> <p>closed <code>231209piu_a</code> more actions:</p> <ul> <li>changed <code>README.md</code>: translated to RO, updated installation &amp; usage information</li> <li>dropped old, obsolete deployment packages</li> <li>test PASS</li> </ul> </li> <li> <p>231208piu_b add an INVOICE TEMPLATE (<code>excel_invoice_template/invoice_template_CU_tva.xlsx</code>) as deliverable with application</p> </li> <li> <p>231208piu_a review, cleaning and formatting code (generalized &amp; moved some debug-verbose code from <code>rdinv</code> to <code>xl2roefact.xl2json</code>), test PASS</p> </li> <li> <p>231207piu_b cleaned <code>rdinv</code> of \"...for debug purposes...\" prints, test PASS</p> </li> <li> <p>231207piu_c reviewed and updated <code>xl2roefact</code>: README, LICENSE, pyproject.toml</p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.12.dev.html","title":"CHANGELOG 0.1.12.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.12.dev</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.12.dev.html#changelog-0112dev","title":"CHANGELOG 0.1.12.dev","text":"<ul> <li> <p>231212piu_b write canonical form (as @invoice lines, see line ~122) ==&gt; <code>invoice[\"Invoice\"][\"cbc_ID\"]</code> and released <code>0.1.12-xl2roefact-0.1-win64.msi</code></p> </li> <li> <p>231212piu_a <code>rdinv.rdinv()</code> invoice header, invoice number as: <code>{\"value\": ..., \"location\": (row..., col...)}</code></p> </li> <li> <p>231211piu_b <code>rdinv.rdinv()</code> create a function special to get \"one key Excel values\", like invoice number or invoice issue date.  Signature:</p> <ul> <li><code>pattern_to_search_for: list[str]</code> - for inv number will pass the <code>PATTERN_FOR_INVOICE_NUMBER_LABEL</code></li> <li><code>area_to_scan: list[start_cell, end_cell]</code> - for inv number will pass <code>(invoice_header_area[\"start_cell\"], invoice_header_area[\"end_cell\"])</code></li> <li>targeted_tye: type - what type expect (will try to convert to, if cannot will return str)</li> </ul> </li> <li> <p>231211piu_a updated <code>config_settings.py</code> ref how to find it: string labels to search, direction to search effective info starting from label</p> </li> <li> <p>231210piu_a localized and marked areas for invoice header (<code>invoice_header_area</code>) &amp; invoice footer (<code>invoice_footer_area</code>) ==&gt; dicts for header and footer with structure <code>{ start_cell = (row, col), end_cell = (row, col) }</code></p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.13.dev.html","title":"CHANGELOG 0.1.13.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.13.dev</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.13.dev.html#changelog-0113dev","title":"CHANGELOG 0.1.13.dev","text":"<ul> <li> <p>231213piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> </ul> </li> <li> <p>231213piu_a get invoice header - invoice currency</p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.14.dev.html","title":"CHANGELOG 0.1.14.dev","text":"<p>RENware Software Systems</p> <p>INVOICEtoROefact Project</p> <ul> <li>CHANGELOG 0.1.14.dev<ul> <li>0.1.14.dev invoice issue date  (231217 h07:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.14.dev.html#changelog-0114dev","title":"CHANGELOG 0.1.14.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.14.dev.html#0114dev-invoice-issue-date-231217-h0700","title":"0.1.14.dev invoice issue date  (231217 h07:00)","text":"<ul> <li> <p>231217piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> <li> updated <code>pyproject.toml</code></li> </ul> </li> <li> <p>231217piu_a invoice header, issue date (&amp;&amp; ATTN pendulum raise error, see <code>rdinv.py</code> line #17, ==&gt; MAYBE JUST TRY <code>Arrow</code> or standard <code>datetime</code>)</p> </li> <li> <p>231216piu_a review, improve &amp; clean code for: <code>xl_invoices/config_settings.py</code>, <code>xl_invoices/rdinv.py</code></p> </li> <li> <p>231215piu_b FIXED configs loaded from config_settings: <code>rdinv</code> module load (init) all constants as global variables (because they are subject to change / \"improve\" values as reading Excel file, for example <code>DEFAULT_CURRENCY</code>)</p> </li> <li> <p>231215piu_a changed dir name <code>xl_invoice_modules/</code> to <code>xl_invoices</code> or classic <code>xl2roefact</code>  as this will be the package name. This is a Python official RECOMMENDATION not a constraint</p> </li> <li> <p>231214piu_a made xl2roefact Python standard package (moved <code>xl2roefact</code> modules to a dedicated directory (<code>xl_invoice_modules/</code>) with intention to publish package)</p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.15.html","title":"CHANGELOG 0.1.15","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.15<ul> <li>0.1.15 updated solution portal http://invoicetoroefact.renware.eu/ (231222 h05:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.15.html#changelog-0115","title":"CHANGELOG 0.1.15","text":""},{"location":"changelog_history/CHANGELOG-0.1.15.html#0115-updated-solution-portal-httpinvoicetoroefactrenwareeu-231222-h0500","title":"0.1.15 updated solution portal <code>http://invoicetoroefact.renware.eu/</code> (231222 h05:00)","text":"<ul> <li>231222piu_a updated CNAME to <code>invoicetoroefact.renware.eu</code></li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.16.dev.html","title":"CHANGELOG 0.1.16.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.16.dev<ul> <li>0.1.16.dev improving Excel kv-data search with \"IN-LABEL\" method (231222 h07:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.16.dev.html#changelog-0116dev","title":"CHANGELOG 0.1.16.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.16.dev.html#0116dev-improving-excel-kv-data-search-with-in-label-method-231222-h0700","title":"0.1.16.dev improving Excel kv-data search with \"IN-LABEL\" method (231222 h07:00)","text":"<ul> <li> <p>231222piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> <li> updated <code>pyproject.toml</code></li> </ul> </li> <li> <p>231222piu_a refactor <code>rdinv.__get_excel_data_at_label(...)</code> to search in label (named \"IN-LABEL\" method)</p> </li> <li> <p>231220piu_b made a first PDM build: [@ 231220 h09:55] ==&gt; test PASS (both created files in <code>dist/</code> was \"git-ignored\")</p> </li> <li> <p>231220piu_b refactored <code>rdinv(...)</code> section \"section for search of <code>invoice_items_area</code> ...\" to use <code>__get_excel_data_at_label(...)</code> function`</p> </li> <li> <p>231220piu_a refactored <code>rdinv.__get_excel_data_at_label(...)</code> for returned \"label_position\" key`</p> </li> <li> <p>231219piu_a update <code>rdinv.__get_excel_data_at_label(...)</code> to return found label value in dictionary as key <code>\"label_value\"</code></p> </li> <li> <p>231218piu_c <code>PDM</code> environment manager, updated <code>pyproject.toml</code> structures ref package building, still preps to create env, generate lock file...</p> </li> <li> <p>231218piu_b CLI application, fixed bug of print settings when deployed from a package (command: <code>xl2roefact.py settings</code>)</p> </li> <li> <p>231218piu_a installed <code>PDM</code> environment manager, updated <code>pyproject.toml</code> structures, nxt to create env, generate lock file...</p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.2.dev.html","title":"CHANGELOG 0.1.2.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.2.dev<ul> <li>0.1.2 Enhancing APItoROefact technical proposal (231104 10:30)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.2.dev.html#changelog-012dev","title":"CHANGELOG 0.1.2.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.2.dev.html#012-enhancing-apitoroefact-technical-proposal-231104-1030","title":"0.1.2 Enhancing <code>APItoROefact</code> technical proposal (231104 10:30)","text":"<ul> <li>231104piu_c <code>APItoROefact</code> technical proposal: closed a discussion version</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.3.dev.html","title":"CHANGELOG 0.1.3.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.3.dev<ul> <li>0.1.3 Enhancing payments_validation_board technical proposal (231105 h05:30)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.3.dev.html#changelog-013dev","title":"CHANGELOG 0.1.3.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.3.dev.html#013-enhancing-payments_validation_board-technical-proposal-231105-h0530","title":"0.1.3 Enhancing <code>payments_validation_board</code> technical proposal (231105 h05:30)","text":"<ul> <li>231105piu_a review, update &amp; publish site <code>apitoroefact.renware.eu</code></li> <li>231104piu_i updated project README file</li> <li>231104piu_h <code>payments_validation_board</code> updated commercial name of system to PayValidaBoa and related documentation files</li> <li>231104piu_g update general considerations proposal doc ref using <code>UTC</code> date and times in applications databases</li> <li>231104piu_f add new top level component for administration of: users, e-mails, signature certificates, roles</li> <li>231104piu_e updated site server name to <code>apitoroefact.renware.eu</code> and <code>doc_src/CNAME</code> file</li> <li>231104piu_d <code>payments_validation_board</code> technical proposal - first / draft components decomposition</li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.4.dev.html","title":"CHANGELOG 0.1.4.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.4.dev<ul> <li>0.1.4 Create system backbone structure (231105 h08:15)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.4.dev.html#changelog-014dev","title":"CHANGELOG 0.1.4.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.4.dev.html#014-create-system-backbone-structure-231105-h0815","title":"0.1.4 Create system backbone structure (231105 h08:15)","text":"<ul> <li>231105piu_c create system backbone as directories structure (and initialized min with a <code>README_xxx.md</code> file):<ul> <li><code>web_dashb_app/</code> for component WEB_DASHB (as renaming actual <code>api_to_roefact_app/</code>)</li> <li><code>xl2roefact/</code> for component xl2roefact</li> <li><code>data/</code> for component SYSTEM_DB</li> </ul> </li> <li>231105piu_b revisit and review existing directories and refactored:<ul> <li><code>sysInit/</code> --&gt; <code>sys_init/</code></li> <li><code>setup/</code> --&gt; <code>setup_web_sys/</code></li> <li>published site</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.5.dev.html","title":"CHANGELOG 0.1.5.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.5.dev<ul> <li>0.1.5 init component xl2roefact for CLI application (231106 h06:30)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.5.dev.html#changelog-015dev","title":"CHANGELOG 0.1.5.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.5.dev.html#015-init-component-xl2roefact-for-cli-application-231106-h0630","title":"0.1.5 init component xl2roefact for CLI application (231106 h06:30)","text":"<ul> <li>231106piu_d published changed commercial documents</li> <li>231106piu_c get test invoices: from client, a RENware one, a 3rd party one ==&gt; directory <code>xl2roefact/test_data_and_specs/</code></li> <li>231106piu_b updated <code>doc_src/110-SRE-payments_validation_board_requirements.md</code> ref system decomposition &amp; list of components</li> <li>231106piu_a prepare environment for xl2roefact component:<ul> <li> make a distinct Python-Windows environment in <code>xl2roefact/</code></li> <li> set as git ignore the intended new environment directory: <code>.wenv_xl2roefact/</code></li> <li> install required modules in new environment (<code>pylightxl</code> core module)</li> <li> create specific requirements file: <code>requirements_xl2roefact.txt</code></li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.6.dev.html","title":"CHANGELOG 0.1.6.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.6.dev<ul> <li>0.1.6 commercial agreement OPTIONS document (231107 h07:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.6.dev.html#changelog-016dev","title":"CHANGELOG 0.1.6.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.6.dev.html#016-commercial-agreement-options-document-231107-h0700","title":"0.1.6 commercial agreement OPTIONS document (231107 h07:00)","text":"<ul> <li>231106piu_e document for TECHNICAL agreement with (a) agreed options, (b) estimated deadlines ==&gt; published i <code>commercial_agreement/</code> as <code>agreed_options.md</code> under \"Options\": menu<ul> <li> (a.) for APItoROefact system</li> <li> (b.) for PayValidaBoa system</li> <li> (c.) publish updates</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.7.dev.html","title":"CHANGELOG 0.1.7.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.7.dev<ul> <li>0.1.7 xl2roefact.RDINV invoice items &amp; metadata (231126 h05:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.7.dev.html#changelog-017dev","title":"CHANGELOG 0.1.7.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.7.dev.html#017-xl2roefactrdinv-invoice-items-metadata-231126-h0500","title":"0.1.7 <code>xl2roefact.RDINV</code> invoice items &amp; metadata (231126 h05:00)","text":"<ul> <li> <p>left OPEN ISSUES in this release [piu@231126: marked on todo plan of <code>0.1.8</code> version]</p> <ul> <li> (CLOSED@231213) file <code>xl2roefact/rdinv.py</code>, function <code>__mk_kv_invoice_items_area(...)</code>: <code>FIXME this will be identified in</code>invoice_header_area<code>==&gt; should be changed accordingly</code></li> <li> --&gt; file <code>xl2roefact\\invoice_files/_PLAN_model_test_factura_generat_anaf.xml</code>, line 114: <code>&lt;cbc:ID&gt;S&lt;/cbc:ID&gt; #FIXME clarify.me_ pare a fi TIPUL PRODUSULUI: (S)erviciu sau ??? (P)rodus sau ???</code></li> </ul> </li> <li> <p>231126piu_a item(s) line extensions == item VAT total, item VALUE total</p> </li> <li> <p>231125piu_c changed dir <code>excel_invoices/</code> with <code>invoice_files/</code></p> </li> <li> <p>231125piu_b make a plan from <code>__model_test_factura_generat_anaf.xml</code> marking TODOs &amp; DONE tags &amp; renaming as <code>_PLAN_...idem...</code></p> </li> <li> <p>231125piu_a final review, complete find of invoice relevant columns and write them in <code>invoice</code> dict:</p> <ul> <li>quantity (cbc:InvoicedQuantity),</li> <li>VAT percent (cbc:Percent),</li> <li>description (cbc:Name),</li> <li>uom (cbc:unitCode),</li> <li>unit price (cbc:PriceAmount),</li> <li>currency (c:currencyID)</li> </ul> </li> <li> <p>231224piu_a FIXED VAT calculation for lines which specify a VAT as 0% - USE CASE lines for other taxes like \"acciza\"... - still unsolved for very simplified invoices (see code line containing text \"<code>_vat_percent</code> calculation should also\")</p> </li> <li> <p>231123piu_c <code>rdinv</code> module, defined function <code>libutils.isnumber(a_string: str) -&gt; bool</code> to test is a string is valid as any kind of number</p> </li> <li> <p>231123piu_b <code>rdinv</code> module, function to search for a list of string in a list items (suitable to identify useful / relevant invoice columns from Excel format) ==&gt; <code>__find_str_in_list(str_to_find: str, list_to_search: list)</code></p> </li> <li> <p>231123piu_a prepared function <code>__mk_kv_invoice_items_area(...)</code> to transform <code>invoice_items_area</code> in \"canonical JSON format\" (as kv pairs)</p> </li> <li> <p>231122piu_a  <code>invoice_items_area</code> &amp; <code>meta_info</code> review, check and clean code</p> </li> <li> <p>231121piu_a final <code>invoice</code> dict / JSON data: moved all effective data under key <code>\"excel_data\"</code> (preparing so for final storable invoice \"real keys\")</p> </li> <li> <p>231119piu_b <code>invoice_items_area</code> set unknown rows header to <code>&lt;current line number&gt;.NOTE-&lt;seq&gt;</code>, where <code>seq</code> is an ordered sequence of letters (ie, resulting something like: <code>1.a, 1.b, ...</code>) * 231119piu_a closed:</p> <ul> <li> invoice <code>meta_info</code> area</li> <li> a more defined, clean &amp; clear <code>invoice_items_area</code></li> <li> add <code>last_processing_UTCtime</code> in <code>meta_info</code> dictionary</li> <li> written <code>invoice</code> dict to a JSON (<code>f-JSON</code> file, see doc: <code>https://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html#vedere-de-ansamblu-a-solutiei</code>)</li> </ul> </li> <li> <p>231112piu_a refactor:</p> <ul> <li> <code>base_proc</code> to <code>xl2roefact</code></li> <li> <code>BASE_PROC</code> to <code>xl2roefact</code></li> <li> update documentation</li> <li> publish site</li> </ul> </li> <li> <p>231109piu_a installed module <code>pylightxl</code> in base environment (ie, in project root) to allow modules calling from root for future web components &amp; updated requirements.txt</p> </li> <li> <p>231108piu_f RDINV (<code>rdinv.py</code>) secure for \"unwanted crashes\" errors (missing info) &amp; clean code</p> </li> <li> <p>2811080iu_e install <code>mkdocstrings</code>, update <code>mkdocs.yml</code> and create a markdown document for xl2roefact component (did) not succeeded search for 'FIXME temporary disabled because errs' ...longer_string_...</p> </li> <li> <p>231108piu_d documented that <code>XLSX</code> is the only Excel file format supported (in <code>110-SRE-api_to_roefact_requirements.md</code>) &amp; published site</p> </li> <li> <p>231108piu_c xl2roefact (<code>xl2roefact.py</code>) transformed in class &amp; parametrized worksheet name containing invoice ==&gt; class BaseProc()</p> </li> <li> <p>231108piu_b RDINV (<code>rdinv.py</code>) module set directories environment &amp; open invoice</p> </li> <li> <p>231108piu_a consolidate decomposition (from <code>231107piu_c</code>) ==&gt; directory <code>.../xl2roefact/modules/</code></p> </li> <li> <p>231107piu_c transform decomposition (from <code>231107piu_b</code>) into complete Python modules (making directories for each)</p> </li> <li> <p>231107piu_b created module files according to decomposition (specs doc <code>110-SRE-api_to_roefact_requirements.md</code>)</p> </li> <li> <p>230107piu_a made a first DRAFT runnable CLI program with <code>Typer</code> (<code>https://typer.tiangolo.com/</code>) from <code>xls2xml.py</code> ==&gt; <code>dist/xls2xml.exe</code></p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.8.dev.html","title":"CHANGELOG 0.1.8.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.8.dev<ul> <li>0.1.8 improved application structure and first executable release (231201 h07:30)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.8.dev.html#changelog-018dev","title":"CHANGELOG 0.1.8.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.8.dev.html#018-improved-application-structure-and-first-executable-release-231201-h0730","title":"0.1.8 improved application structure and first executable release (231201 h07:30)","text":"<ul> <li> <p>231201piu_b installed <code>cx-Freeze</code> library and build a new Windows executable, update documentation - need future improvement to make <code>msi</code> package, but TEST PASSED and works perfectly</p> </li> <li> <p>231201piu_a improve CLI application structure (<code>xl2roefact.py</code>) and commands: <code>xl2json</code>, <code>about</code></p> </li> <li> <p>231130piu_a <code>xl2roefact.py</code>, <code>\u2014\u2014excel_files_directory</code>: option, make it of type pathlib.Path, dealut remain as is, validators; is dir, exists, writable, readable, resolve_path</p> </li> <li> <p>231129piu_b updated <code>xl2roefact.py</code> (main application) changed command <code>run</code> --&gt; <code>xl2json</code> and add parameter <code>excel_files_directory</code> (future intention is to make commands: <code>xl2json - RDINV</code>, <code>json2xml - WRXML</code>, <code>json2pdf</code>, <code>xml2roefact - LDXML</code>)</p> </li> <li> <p>231129piu_a adopted new REN invoice template (test with data from RENF-1004)</p> </li> <li> <p>231128piu_b made <code>config_settings.py</code> for general application configuration purposes and an application command (<code>xl2roefact settings</code>) to print them</p> </li> <li> <p>231128piu_a made <code>xl2roefact.py</code> (main library file) as CLI executable structure (with <code>Typer</code> library)</p> </li> <li> <p>231127piu_c introduced key <code>Invoice</code> in  invoice JSON generated structure (also representing the \"entity\" in XML representation)</p> </li> <li> <p>231127piu_b module <code>rdinv</code> crated a distinct function for building of <code>meta_info</code> key (main <code>invoice</code> dictionary)</p> </li> <li> <p>231127piu_a created in invoice JSON map JSON key --&gt; XML property (<code>meta_info[\"map_JSONkeys_XMLtags\"]</code>) as <code>list of tuple(JSONkey: str, XMLtag: str)</code></p> </li> <li> <p>231127piu_a created draft data models for: invoice (exportable as JSON and XML) and other entities (owner, customer) ==&gt; <code>data_models.py</code></p> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.9.dev.html","title":"CHANGELOG 0.1.9.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.9.dev<ul> <li>0.1.9 xl2roefact.RDINV running executable and distribution kit (231203 h07:00)</li> </ul> </li> </ul>"},{"location":"changelog_history/CHANGELOG-0.1.9.dev.html#changelog-019dev","title":"CHANGELOG 0.1.9.dev","text":""},{"location":"changelog_history/CHANGELOG-0.1.9.dev.html#019-xl2roefactrdinv-running-executable-and-distribution-kit-231203-h0700","title":"0.1.9 <code>xl2roefact.RDINV</code> running executable and distribution kit (231203 h07:00)","text":"<ul> <li> <p>231103piu_b releasing ==&gt; made <code>dist/0.1.9-exe.win-amd64-3.10.zip</code> with executable file</p> </li> <li> <p>231103piu_a <code>xl2roefact.py</code> more updates:</p> <ul> <li> set verbose flag for debugging mode</li> <li> made <code>file_name</code> argument as file(s) to be processed with wildcards like Python standard function <code>os.glob.glob()</code> (reference here <code>https://docs.python.org/2/library/glob.html</code>)</li> <li> build a new fresh executable in <code>build/exe.win-amd64-3.10/</code></li> </ul> </li> <li> <p>231202piu_b <code>xl2roefact.py</code> started a skeleton for <code>file_name</code> argument - see code-in-file @\"TODO here to use <code>excel_files_directory</code> + / + <code>file_name</code> to find all files and process them in a loop\"</p> </li> <li> <p>231202piu_a build complete <code>cxFreeze</code> configuration in order to build Windows executable and installer package (as <code>msi</code> package):</p> <ul> <li> create a minimal setup (<code>setup.py</code>)</li> <li> create <code>build/</code> directory with all building commands for xl2roefact app: <code>python setup.py build</code> (see official doc here <code>https://cx-freeze.readthedocs.io/en/latest/setup_script.html</code>)</li> <li>CONCLUSION <code>msi</code> package OK, <code>exe</code> file NOK - see <code>setup.py</code> for a detailed comment marked <code>NOTE-[piu@231202]</code></li> </ul> </li> </ul>"},{"location":"changelog_history/_template-CHANGELOG-version.html","title":"template CHANGELOG version","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG #NOTE_version_string_here...<ul> <li>...here to work</li> </ul> </li> </ul>"},{"location":"changelog_history/_template-CHANGELOG-version.html#changelog-note_version_string_here","title":"CHANGELOG #NOTE_version_string_here...","text":"<p>-#TODO:     insert here the version log     usually from a <code>###</code> level, including it</p>"},{"location":"changelog_history/_template-CHANGELOG-version.html#here-to-work","title":"...here to work","text":""},{"location":"data/README_data.html","title":"README data","text":"<p>RENware Software Systems</p>"},{"location":"data/README_data.html#system_db-component","title":"SYSTEM_DB component","text":"<ul> <li>SYSTEM_DB component</li> </ul> <p>This component is presented in document `.../doc_src/...110-SRE-api_to_roefact_requirements.md``</p>"},{"location":"doc_src/downloads.html","title":"Descarcare resurse (Downloads)","text":"<p>RENware Software Systems</p>"},{"location":"doc_src/downloads.html#descarcare-resurse-downloads","title":"Descarcare resurse (downloads)","text":"<p>Cuprins:</p> <ul> <li>Descarcare resurse (downloads)<ul> <li>Format biblioteca Python</li> <li>Format MSI instalare Windows x64</li> <li>Format DEB instalare Linux</li> <li>Format XLSX Office Excel</li> </ul> </li> </ul>"},{"location":"doc_src/downloads.html#format-biblioteca-python","title":"Format biblioteca Python","text":"<ul> <li>0.1.20.dev invoice customer address WHEEL</li> <li>0.1.20.dev invoice customer address DIST</li> <li>0.1.19.dev invoice customer and partial invoice total values calculations WHEEL</li> <li>0.1.19.dev invoice customer and partial invoice total values calculations DIST</li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations WHEEL</li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations DIST</li> </ul>"},{"location":"doc_src/downloads.html#format-msi-instalare-windows-x64","title":"Format MSI instalare Windows x64","text":"<ul> <li>0.1.20.dev invoice customer address MSI installer win64</li> <li>0.1.19.dev invoice customer and partial invoice total values calculations MSI installer win64</li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations MSI installer win64</li> </ul>"},{"location":"doc_src/downloads.html#format-deb-instalare-linux","title":"Format DEB instalare Linux","text":"<p>No items available.</p>"},{"location":"doc_src/downloads.html#format-xlsx-office-excel","title":"Format XLSX Office Excel","text":"<ul> <li>office Excel XLSX 0.1.20</li> <li>arhiva ZIP 0.1.20</li> <li>arhiva ZIP 0.1.11</li> </ul> <p>.</p>"},{"location":"doc_src/wip.html","title":"Under construction page","text":"<p>UPCOMING...</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html","title":"Componentele sistemului","text":"<p>RENware Software Systems</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#componentele-sistemului","title":"Componentele sistemului","text":"<p>Cuprins:</p> <ul> <li>Componentele sistemului<ul> <li>Componente<ul> <li>xl2roefact</li> <li>web2roefact</li> <li>xl2roefact PyPi library</li> <li>invoice template</li> </ul> </li> <li>Criterii de clasificare</li> <li>Note</li> </ul> </li> </ul> <p>Sistemul consta din mai multe componente toate avind acelasi obiectiv central: emiterea de facturi si procesarea facturilor emise existente deja. Faptul ca sunt mai multe componente asigura mai multe cai alternative de a atinge obiectivul central, cai ce pot fi utilizate in paralel (concurent, in acelasi timp) in functie de \"dotarea tehnica\" a fiecaruia, de afinitatea fiecaruia la un \"gen\" de sisteme sau pur si simplu de preferinta de moment a fiecaruia.</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#componente","title":"Componente","text":"<p>Sistemul ofera urmatoarele componente:</p> <ul> <li> <p>xl2roefact - procesarea facturilor in mod linie de comanda</p> </li> <li> <p>web2roefact - procesarea facturilor din interfara web</p> </li> <li> <p>xl2roefact PyPi library - procesarea facturilor prin cod / program (development propriu)</p> </li> <li> <p>invoice template - model / sablon factura in Excel</p> </li> </ul> <p>Facilitatile generale ale fiecareia din acestea sunt prezentate in continuare.</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#xl2roefact","title":"xl2roefact","text":"<p>Aplicatie linie de comanda pentru procesarea facturilor. Facilitati (vezi \"Criterii de clasificare\"):  </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#web2roefact","title":"web2roefact","text":"<p>Aplicatie web pentru procesarea facturilor. Facilitati (vezi \"Criterii de clasificare\"):  </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#xl2roefact-pypi-library","title":"xl2roefact PyPi library","text":"<p>Pachet (biblioteca) public Python utilizabil pentru dezvoltare / extindere aplicatii proprii. Facilitati (vezi \"Criterii de clasificare\"):  </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#invoice-template","title":"invoice template","text":"<p>Sablon factura in format Office Excel. Facilitati (vezi \"Criterii de clasificare\"):  </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#criterii-de-clasificare","title":"Criterii de clasificare","text":"<p>In scopul identificarii mai usoare a componentelor necesare acestea sunt clasificate dupa urmatoarele criterii:</p> <ul> <li> <p>OpM modul de operare al componentei:</p> <ul> <li>CLI specifica o componenta ce va fi executata in mod linie de comanda (Windows din <code>Command</code>, Linux din <code>Terminal</code>)</li> <li>WEB specifica o componenta ce va fi accesata dintr-un browser</li> </ul> </li> <li> <p>INp  modul de introducere si import a facturii:</p> <ul> <li>XLSX import dintr-un document <code>Office Excel</code> unde a fost deja introdusa anterior preluarii. Ca si instrument de introducere poate fi folosit oricare din cele ce permit salvarea / exportul in format <code>XLSX</code> (alte formate, in special cel anterior - <code>XLS</code> nu sunt importabile - ci trebuiesc \"convertite\" la formatul <code>xlsx</code>)</li> <li>JSON import din format <code>JSON</code></li> <li>FORM factura se poate introduce manual direct in sistem, acesta punind la dispozitie un formular dedicat acestei operatii</li> </ul> </li> <li> <p>EXp formatul de exportare a facturilor1:</p> </li> <li>JSON format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>REST</code> (de exemplu Oracle EBS)</li> <li>XML format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>SOAP</code>2 (de exemplu RO eFact, SAP)</li> <li>EXCEL format Office Excel <code>xlsx</code></li> <li> <p>PDF format Adobe PDF tiparibil</p> </li> <li> <p>R2R specifica faptul ca acea componenta poate fi folosita ca atare, fara o instalare prealabila (\"ready to run\") altfel aceasta trebuie instalata inainte de utilizare</p> </li> <li> <p>ROeF specifica faptul ca acea componenta permite incarcarea automata3 a facturii in sistemul ANAF SPV RO eFact</p> </li> </ul>"},{"location":"doc_src/810-DSGN/810.05a-system_components.html#note","title":"Note","text":"<ol> <li> <p>Exportul facturilor in formatele <code>EXCEL</code> si respectiv <code>PDF</code> se face utilizind formatul vizual al documentului din componenta <code>invoice template</code> \u21a9</p> </li> <li> <p>schemele <code>XML</code> respectate sunt: <code>\"xmlns\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2\"</code>, <code>\"xmlns:cbc\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2\"</code>, <code>\"xmlns:cac\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2\"</code>, <code>\"xmlns:ns4\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2\"</code>, <code>\"xmlns:xsi\": \"http://www.w3.org/2001/XMLSchema-instance\"</code>, <code>\"xsi:schemaLocation\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd\"</code> \u21a9</p> </li> <li> <p>incarcarea automata a facturii in sistemul <code>ANAF RO eFact</code> este conditionata de configurarea respectivei componente cu credentialele necesare autentificarii in acest sistem (altfel acesta informatie va fi ceruta utilizatorui pentru introducere manuala)\u00a0\u21a9</p> </li> </ol>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html","title":"Sistem INVOICEtoROefact","text":"<p> INVOICEtoROefact System (c) 2023 RENware Software Systems </p>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#propunere-tehnica-sistem-invoicetoroefact","title":"Propunere tehnica sistem INVOICEtoROefact","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica sistem INVOICEtoROefact<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Componenta xl2roefact<ul> <li>Diagrama logica de functionare a componentei</li> </ul> </li> <li>Componenta WEB_DASHB</li> <li>Componenta SYSTEM_DB</li> </ul> </li> </ul> <ul> <li>p/n: <code>0000-0095</code></li> <li>code-name: <code>api_to_roefact</code></li> <li>commercial name: INVOICEtoROefact</li> <li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html</code></li> <li>git: <code>https://github.com/petre-renware/api_to_roefact</code></li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica sistem INVOICEtoROefact<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Componenta xl2roefact<ul> <li>Diagrama logica de functionare a componentei</li> </ul> </li> <li>Componenta WEB_DASHB</li> <li>Componenta SYSTEM_DB</li> </ul> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#obiective","title":"Obiective","text":"<p>Acest sistem va asigura incarcarea facturilor emise in sistemul ANAF E-Factura cu respectarea reglementarilor publicate in acest sens (lista contine si legaturi catre fisierele publicate de catre ANAF):</p> <ul> <li> <p>Conformarea la modificarile legislative si utilizarea sistemului</p> </li> <li> <p>Informatii de interes referitoare la implementarea sistemului na\u021bional privind factura electronic\u0103 RO e-Factura</p> </li> <li> <p>Instruc\u021biuni de utilizare</p> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#vedere-de-ansamblu-a-solutiei","title":"Vedere de ansamblu a solutiei","text":"<p>Solutia <code>api_to_roefact</code> consta din urmatoarele componente:</p> <ul> <li> <p><code>api_to_roefact</code>.<code>xl2roefact</code> aceasta componenta are rolul de a implementa efectiv obiectivele principale ale sistemului INVOICEtoROefact. Componenta este capabila sa ruleze atit \"standalone\" (ca linie de comanda CLI) dar si prin utilizarea ei de catre componenta <code>WEB_DASHB</code> si astfel utilizarea ei in varianta de sistem prezentat \"over internet / intranet\". Prezentarea detalita a acesteia se gaseste aici.</p> </li> <li> <p><code>api_to_roefact</code>.<code>WEB_DASHB</code> aceasta componenta are rolul de agrega componentele si de a prezenta solutia INVOICEtoROefact \"over internet / intranet\". De asemenea componenta asigura modulele UI necesare pentru administrarea sistemului. Prezentarea detalita a acesteia se gaseste aici.</p> </li> <li> <p><code>api_to_roefact</code>.<code>SYSTEM_DB</code> .Aceasta componente reprezita baza de date a sistemului INVOICEtoROefact atit partea relationala dar si partea <code>no-sql</code> a acesteia (utilizata pentru eventuale sincrnizari provenite din utilizarea CLI a componentei <code>xl2roefact</code>). Prezentarea detalita a acesteia se gaseste aici.</p> </li> </ul> <p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>api_to_roefact</code>.</p> <p></p>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-xl2roefact","title":"Componenta xl2roefact","text":"<ul> <li> <p>(RDINV) modul de procesare a fisierului format <code>XLSX</code> ce contine factura si colectare a datelor aferente</p> <ul> <li>INTRARI: fisier format <code>XLSX</code> ce contine factura emisa (cod: <code>f-XLSX</code>)</li> <li>IESIRI: fisier format <code>JSON</code> imagine a datelor facturii (cod: <code>f-JSON</code>)</li> </ul> </li> <li> <p>(WRXML) modul de generare a fisierului format <code>XML</code></p> <ul> <li>INTRARI: fisier <code>f-JSON</code></li> <li>IESIRI: fisier format <code>XML</code> conform cerintelor si sistemului <code>ANAF E-Factura</code> (cod: <code>f-XML</code>)</li> </ul> </li> <li> <p>(CHKXML) modul de validare a facturii in sistemul <code>ANAF E-Factura</code></p> <ul> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu eventualele erori de validare 1</li> </ul> </li> <li> <p>(LDXML) modul de incarcare a facturii in sistemul <code>ANAF E-Factura</code></p> <ul> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu validarea si identificatorul incarcarii 1</li> </ul> </li> <li> <p>(CHKISLD) modul de verificare a starii de incarcare a unei facturi emise</p> <ul> <li>INTRARI: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii</li> <li>IESIRI: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata 2</li> </ul> </li> </ul> <p>Formatul fisierelor Excel cu factura</p> <p><code>XLSX</code> este sigurul format de fisier acceptat</p>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#diagrama-logica-de-functionare-a-componentei","title":"Diagrama logica de functionare a componentei","text":"<pre><code>flowchart TD\n    start([\"start\"])\n    stop([\"stop &amp; \\nrepeta ciclul\"])\n    RDINV[\"procesare a fisierului format XLSX\"]\n    WRXML[\"generare a fisierului format XML\"]\n    CHKXML[\"validare a facturii\"]\n    LDXML[\"incarcare a facturii in sistemul E-Factura\"]\n    CHKISLD[\"verificare stare de incarcare facturi\"]\n\n    f-XLSX[\\\"f-XLSX\"/]\n    f-XML[\\\"f-XML\"/]\n    f-JSON[\\\"f-JSON\"/]\n    DBS[(\"system database\")]\n\n    loaded{\"incarcata?\"}\n\n    start ---&gt; RDINV\n    f-XLSX --&gt; RDINV\n    RDINV ---&gt; f-JSON\n    RDINV --&gt; CHKISLD\n\n    CHKISLD --&gt; loaded\n    loaded --DA--&gt; stop\n\n    loaded --NU--&gt; WRXML\n    WRXML --&gt; f-XML\n    WRXML --&gt; LDXML\n    LDXML --&gt; CHKXML\n    CHKXML --&gt; stop\n\n    CHKXML --&gt; DBS\n\n    LDXML ---&gt; DBS</code></pre> <p>...#FIXME explicatii necesare ?...</p>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-web_dashb","title":"Componenta WEB_DASHB","text":"<p>...INCOMING...  </p>"},{"location":"doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-system_db","title":"Componenta SYSTEM_DB","text":"<p>...INCOMING...  </p> <ol> <li> <p>raportul se scrie in baza de date a sistemului si in fisierul <code>f-XLSX</code> intr-un worksheet separat dedicat acestui scop\u00a0\u21a9\u21a9</p> </li> <li> <p>in cazul valorii echivalent <code>TRUE</code> se poate intoarce identificatorul incarcarii daca este disponibil\u00a0\u21a9</p> </li> </ol>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html","title":"Considerente tehnice generale","text":"<p>RENware Software Systems</p>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html#propunere-tehnica","title":"Propunere tehnica","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica<ul> <li>Aria de cuprindere</li> <li>Considerente generale de securitate</li> <li>Considerente generale privind bazele de date proprii sistemelor</li> <li>Considerente generale privind auditarea informatiilor</li> </ul> </li> </ul> <ul> <li>Client:  n/a - not public</li> <li>Data: 2023-Noiembrie</li> </ul> <p>Codificarea documentelor</p> <ul> <li>codificarea numelor documentelor si a proceselor este facuta in conformitate cu metodologia RENware SDEVEN</li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica<ul> <li>Aria de cuprindere</li> <li>Considerente generale de securitate</li> <li>Considerente generale privind bazele de date proprii sistemelor</li> <li>Considerente generale privind auditarea informatiilor</li> </ul> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html#aria-de-cuprindere","title":"Aria de cuprindere","text":"<p>Solutiile propuse prin aceasta propunere tehnica sunt:</p> <ul> <li> <p>INVOICEtoROefact (code-name <code>api_to_roefact</code>) integrare Sistemul National de Facturi Emise RO e-Factura descriere si cerinte aici</p> </li> <li> <p>PayValidaBoa (code-name <code>payments_validation_board</code>) Flux aprobare facturi primite pentru ordonantare la plata descriere si cerinte aici</p> </li> </ul> <p>In continuare se prezinta o serie de considerente generale valabile pentru toate sistemele din aria de acoperire.</p>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-de-securitate","title":"Considerente generale de securitate","text":"<ul> <li> <p>(RSEC-01) fisierele de configurare a sistemelor (fiind format text <code>UTF-8</code>) vor avea ca <code>owner</code> un utilizator dedicat sistemului respectiv sau utilizatorul <code>root</code>. Numai acesti doi utilizatori pot avea acces <code>RW</code> la aceste fisiere</p> </li> <li> <p>(RSEC-02) toate documentele de provenienta externa sistemelor vor fi \"purtatoare\" ale unui certificat digital ce atesta validitatea documentelor. Acest certificat va fi de preferinta de tip \"semnatura electronica\" dar nu obligatoriu calificata. Este suficient un simplu certificat (cheie) tip <code>RSA</code> generat intern si distribuit utilizatorilor autorizati sa emita documentele respective. O copie a certificatului (sau a certificatelor daca se vor emite mai multe) ce atesta validitatea unui document va sta pe server in locatii ce sunt conforme cu RSEC-01</p> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-privind-bazele-de-date-proprii-sistemelor","title":"Considerente generale privind bazele de date proprii sistemelor","text":"<ul> <li> <p>(DBS-01) bazele de date vor contine o cheie primara \"real primara\" (adica avind toate caracteristicile tehnice pentru <code>PK</code> in sensul uzual cunoscut din teoria bazalor de date). Aceasta cheie va fi de tip <code>Char(32)</code> reprezentind tipul <code>uuid4</code> (cunoscut si ca <code>guid</code>) convertit la sir de caractere <code>UTF-8</code> si reversibil ca transformare din <code>string</code> in <code>uuid4</code>. Aceasta cheie va fi generata automat si intretinuta de sistem deservind scopuri pur tehnice de referentiere si relationare a datelor. Modificarea manuala nu este permisa putind genera situatii de hazard.</p> </li> <li> <p>(DBS-02) bazele de date vor contine si o alta \"cheie primara uman recongnoscibila\" (<code>AK</code> in teoria bazelor de date) utilizata in scop de recunoastere si regasire a informatiei de catre utilizatori. Aceasta cheie va avea urmatoarele catacterisrici:</p> <ul> <li>va fi unica, tip <code>Char(10)</code> (limitarea lungimii se va aplica la introducerea datelo si nu in baza de date)</li> <li>agnostic case, nu se va face diferenta intre litere mari sau mici (pentru a evita confuziile)</li> <li>obligatorie iar daca utilizatorul \"nu o doreste\" se va default-a la <code>PK-ul</code> anterior</li> </ul> </li> <li> <p>(DBS-03) bazele de date vor fi intr-unul din formatele: (a) relational sau (b) JSON standard. Pentru bazele de date in format relational va fi preferata o solutie de SGBD tip open source matura,   intretinuta in urmatoarea ordine de aplicare:</p> <ul> <li><code>1.</code> SQLite pentru baze de date ce nu vor depasi 10,000 de inregistrari</li> <li><code>2.</code> PostgreSQL pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li> <li><code>3.</code> MariaDB pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li> <li>prima varianta va fi preferata datoritra \"portabilitatii datelor\"</li> <li>a treia varianta este enumerata ca optiune preferata a utilizatorului la varianta <code>2.</code></li> </ul> </li> <li> <p>(DBS-04) bazele de date vor folosi numai cimpuri formate standard, clasice si elemetare:</p> <ul> <li>sir de carectere (<code>CHAR</code> sau <code>VARCHAR</code>)</li> <li>numere intregi cu semn (<code>INTEGER</code>)</li> <li>numere reale cu semn (<code>FLOAT</code>)</li> <li>numere combinate a caror valoare poate fi intreg sau real (<code>NUMBER</code>)</li> <li>valori logice sub forma intreg cu semn astfel: <code>1</code> pentru TRUE si <code>0</code> sau <code>NULL</code> pentru FALSE</li> <li>valori logice sub forma de caracter astfel: prima litera din lista <code>[Y, y, D, d, T, t]</code> pentru TRUE si orice altceva inclusiv <code>NULL</code> pentru FALSE</li> </ul> </li> <li> <p>(DBS-05) in cazul bazelor de date relationale, integritatile referentiale vor fi evitate la maximum prin intretinerea datelor numai cu ajutorul aplicatiei sau in cazull necesitatii modificarii manuale a datelor, aceasta modfica re sa fie efectuata numai de personal calificat</p> </li> <li> <p>(DBS-06) informatiile de tip data-timp (data, ora, etc...) vor fi stocate de preferinta sub forma de <code>String</code> in formatul ISO: <code>YYYY-MM-DD HH:MM:SS.nnnnn</code>.</p> </li> <li> <p>(DBS-07) informatii de data-timp vor fi stocate avind valori agnostice de \"Time Zone\" adica vor fi considerate <code>UTC</code> lucru care va permite comparabilitatea acestora indiferent de locatia /zpna de timp de unde au fost generate.</p> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-privind-auditarea-informatiilor","title":"Considerente generale privind auditarea informatiilor","text":"<ul> <li> <p>Cimpurile de audit ce indica utilizatori:</p> <ul> <li>(AUD-01) pentru informatiile CONSTIENT GENERATE DE UTILIZATORI (adica generate prin activarea unor controale vizuale, prin lansarea manuala a unei aplicatii, etc), aceste cimpuri vor contine numele tip <code>username</code> al utilizatorului folosit pentru autentificarea in sistem</li> <li>(AUD-02) pentru informatiile GENERATE DE SISTEM la rulari automate, periodice, de verificare, de validare, etc, aceste cimpuri vor contine textul <code>system</code> (pentru a evita confuzii cu utilizatori reali la nivel de sistem de operare)</li> </ul> </li> <li> <p>(AUD-03) Cimpurile de audit ce indica date calendaristice vor respecta standardul ISO fiind in formatul maximal <code>YYYY-MM-DD hh:mm:ss</code></p> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html","title":"Sistem PayValidaBoa","text":"<p>RENware Software Systems</p>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#propunere-tehnica-sistem-payvalidaboa","title":"Propunere tehnica sistem PayValidaBoa","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica sistem PayValidaBoa<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Cerinte functionale generale</li> <li>Componenta xxx</li> </ul> </li> </ul> <ul> <li>p/n: <code>0000-0094</code></li> <li>code-name: <code>payments_validation_board</code></li> <li>commercial name: PayValidaBoa</li> <li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html</code></li> <li>git: <code>n/a</code></li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica sistem PayValidaBoa<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Cerinte functionale generale</li> <li>Componenta xxx</li> </ul> </li> </ul>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#obiective","title":"Obiective","text":"<p>Acest sistem asigura prezentarea unui \"dashboard\" cu lista facturilor primite si starea lor de verificare si aprobare interna in vederea ordonantarii lor la plata.</p>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#vedere-de-ansamblu-a-solutiei","title":"Vedere de ansamblu a solutiei","text":"<p>Sistemul <code>payments_validation_board</code> consta din urmatoarele componente:</p> <ul> <li> <p><code>INV_TOPMNG_BOARD</code> - aceasta componenta prezinta pentru MANAGEMNTul tip CFO lista facturilor primite si starea lor referitor la validarea si aprobarea lor finala si un control pentru APROBARE FINALA sau BUN DE PATA. </p> </li> <li> <p><code>INV_CHK_BOARD</code> - aceasta componenta prezinta pentru VERIFICATORI si APROBABTORI lista fa/turilor primite si diverse controale pentru aprobarea si scrierea de diverse note si observatii. </p> </li> <li> <p><code>INV_NOTIF_BOARD</code> aceasta componenta prezinta notificari referitoare la diversele OBSERVATII si NOTE facture asupra facturilor primite in diverse stadii de aprobare de catre persoanele care efectueaza verificari asupra lor (prin componenta <code>INV_CHK</code>). Notificarile sunt disponibile atit in interfata aplicatiei iar unele din ele pot fi transmise prin mail. </p> </li> <li> <p><code>INV_LD_FOR_APPRV</code> - aceasta componenta permite incarcarea facturilor in fluxul de aprobare. Optiuni de incarcare:</p> <ul> <li>manuala (dintr-un board al aplicatiei)</li> <li>automata dintr-un director</li> <li>dintr-o baza de date externa sistemului (cu \"marcarea\" facturilor ce vor trebui incarcate)</li> <li>la incarcare (indiferent de metoda) vor trebui specificati (sau dedusi din alte informatii) DESTINATARII ce primesc documentul</li> </ul> </li> <li> <p><code>ADMIN_CFG</code> aceasta componenta permite pentru ADMINISTRATORI diverse OPTIUNI DE CONFIGURARE:</p> <ul> <li>lista utilizatorilor ce fac parte dinfluxul de aprobare</li> <li>adresele e-mail ale utilizatorilor</li> <li>rolul utilizatorilor in accea ce priveste fluxul de aprobare facturile primite</li> <li>certificate si semnaturile de certificare a \"semnaturilor\" de aprobare</li> <li>... </li> </ul> </li> </ul> <p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>payments_validation_board</code>.</p> <p>...IN PROGRESS...  </p>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#cerinte-functionale-generale","title":"Cerinte functionale generale","text":"<p>...INCOMING...  </p>"},{"location":"doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#componenta-xxx","title":"Componenta xxx","text":"<p>...INCOMING...  </p>"},{"location":"doc_src/commercial_agreement/231109_meeting.html","title":"Meeting minute","text":"<ul> <li>Data: 2023-11-09</li> <li>Participants:<ul> <li>Costel Lungu, Kraftanlagen</li> <li>Alexandru Alexandru, Kraftanlagen</li> <li>Catalin Ristea, Kraftanlagen</li> <li>Margareta Stefanescu, Kraftanlagen</li> <li>Liviu Neacsu, Kraftanlagen</li> <li>Petre Iordanescu, RENware Software Solution</li> </ul> </li> <li>Organizare:<ul> <li>link conectare</li> <li>Meeting ID: 381 897 114 828</li> <li>Passcode: eeBDEH</li> </ul> </li> </ul>"},{"location":"doc_src/commercial_agreement/231109_meeting.html#discussions","title":"Discussions","text":""},{"location":"doc_src/commercial_agreement/231109_meeting.html#general-aspects","title":"General aspects","text":"<ul> <li>companii CUI distinct si fac diferentiere maxima (exceptie ca sunt operate de acelasi personal):<ul> <li>IPIP preluat</li> <li>Kraftlangen main / base</li> </ul> </li> </ul>"},{"location":"doc_src/commercial_agreement/231109_meeting.html#discutii-si-factori-decizionali","title":"Discutii si factori decizionali","text":"<ul> <li> <p>3 elemente:</p> <ul> <li>comunicarea cu SPV (cca 40 buc/luna, servicii, mayteriale)</li> <li>facturile vor ramine in Excel</li> <li>facturi Kraflangen merg si la 700/luna</li> </ul> </li> <li> <p>tipuri fact (emise?)</p> <ul> <li>facturi materiale</li> <li>facturi lucrari de la furnizori</li> <li>alte facturi (telefoane, etc)</li> </ul> </li> <li> <p>sist tb sa permita pe viitor math fact din SPV (primita mai ales) cu documentele primare din sistemul propriu (NIR, doc justificative, PVuri, ...) acest match ar trebui sa fie un flow (pentru ca sunt mai multe persoane)</p> </li> <li> <p>idem pentru aprobare (cred ca PayValidaBoa ar trebui deja sa faca)</p> </li> <li> <p>din 1 Iulie 2024 toate fact XML din SPV vor fi \"cu sigiliu\"</p> </li> <li> <p>facturile vor trebui sa ajunga in SAP - acum se trimit prin intermediul unei arhive (speciala...) pentru a fi incarcate automatizat de Germania in SAP solutia tb sa fie suficient de versatila astfel incit daca se schimba SAP sa ramina valida informatia trimisa ASTFEL un format intermediar (dedicat Romania) ar fi de dorit</p> </li> <li> <p>...</p> </li> </ul>"},{"location":"doc_src/commercial_agreement/agreed_options.html","title":"Specificatii si optiuni tehnice","text":"<p>RENware Software Systems</p>"},{"location":"doc_src/commercial_agreement/agreed_options.html#optiuni-tehnice","title":"Optiuni tehnice","text":"<p>Cuprins:</p> <ul> <li>Optiuni tehnice<ul> <li>Optiuni sistem INVOICEtoROefact<ul> <li>Recomandari sistem INVOICEtoROefact</li> </ul> </li> <li>Optiuni sistem PayValidaBoa</li> <li>Optiuni generale de implementare</li> </ul> </li> </ul> <p>Acest document prezinta posibilele optiuni tehnice la cele doua sisteme, optiuni care vor trebui agreate si (preferabil) planificate cel putin din punct de vedere al prioritatii.</p>"},{"location":"doc_src/commercial_agreement/agreed_options.html#optiuni-sistem-invoicetoroefact","title":"Optiuni sistem INVOICEtoROefact","text":"<p>Forma de utilizare si interactionare</p> <ul> <li>\u2610 (INVOICEtoROefact-RQ-01) - varianta CLI (command line) cu utilizare \"individuala\"</li> <li>\u2610 (INVOICEtoROefact-RQ-02) - varianta WEB cu utilizare centralizata</li> </ul> <p>Configurabilitate</p> <ul> <li>\u2610 (INVOICEtoROefact-RQ-03) - varianta in care se prelucreaza un model de fisier <code>Excel</code> in care sunt \"fixate si blocate\" locatiile celulelor ce contin date relevante</li> <li>\u2610 (INVOICEtoROefact-RQ-04) - varianta in care structura si formatul fisierului <code>Excel</code> contin \"cuvinte cheie\" ce determina regasirea date relevante (de exemplu textul \"Client:\" intr-o celula semnifica inceperea unei zone cu datele clientului de la acea celula in jos si pina prima celula necompletata ce va fi gasita)</li> </ul>"},{"location":"doc_src/commercial_agreement/agreed_options.html#recomandari-sistem-invoicetoroefact","title":"Recomandari sistem INVOICEtoROefact","text":"<ul> <li> <p>varianta (INVOICEtoROefact-RQ-01) este recomandata ca fiind \"aproape obligatorie\" deoarece chiar si in varianta WEB ea va trebui scrisa intr-o forma neutilizabila direct (sub forma de functie a sistemlui). Transformarea acestei functii in varianta CLI va permite o executie portabila (\"la purtator\") si offline (in situatii extreme se poate folosi doar fisierul <code>XML</code> generat si acesta va putea fi manual incarcat in ANAF-SPV). Informatia privind \"starea de incarcare a facturii\" va fi oricum salvata si in fisierul Excel aferent facturii si va putea fi preluata de catre varianta WEB pentru centralizarea informatiilor- a se vedea si modulul <code>LDXML</code> si notele de subsol aferente</p> </li> <li> <p>optiunea (INVOICEtoROefact-RQ-03) este recomandata ca varianta de start deoarece va permite realizarea unei variante OPERATIONALE (de lucru curent si testare) intr-un termen mai scurt, urmind ca aceasta optiune sa fie gradat extinsa si cu optiunea (INVOICEtoROefact-RQ-04). Aceasta \"linie de lucru\" nu va induce probleme, avind in vedere ca orice optiune / varianta aleasa ca varianta de start si planificata a fi extinsa va implica si MIGRAREA datelor deja produse la momentul extinderii ei</p> </li> </ul>"},{"location":"doc_src/commercial_agreement/agreed_options.html#optiuni-sistem-payvalidaboa","title":"Optiuni sistem PayValidaBoa","text":"<p>Framework standardizat de orchestrare</p> <ul> <li>\u2610 (PayValidaBoa-RQ-01) - utilizarea unui framework specializat de orchestrare si integrare cu alte sisteme \"externe\"<ul> <li>Implicatii: poate mari durata de implementare</li> <li>Avantaje: utilizarea ulterioara pentru integrare intre sisteme ce prezita interfata standardizata (REST, SOA, NTFS, EXT4, OAuth, ...)</li> </ul> </li> </ul> <p>Semnare electronica a facturilor verificate</p> <ul> <li>\u2610 (PayValidaBoa-RQ-02) - utilizarea de certificat tip \"semnatura electronica\" pentru autentificarea verificarii facturilor EMBEDDED IN FACTURA</li> <li>\u2610 (PayValidaBoa-RQ-03) - utilizarea de certificat tip \"semnatura electronica\" pentru autentificarea verificarii facturilor adiacet facturii - disponibil pentru consultare numai in sistemul PayValidaBoa</li> <li>\u2610 (PayValidaBoa-RQ-04) - verificarea facturilor nu necesita certificat tip \"semnatura electronica\" ci simpla informatie existenta in sistemul PayValidaBoa este suficienta</li> </ul> <p>Baza de date 'interna / specifica' sistemului PayValidaBoa</p> <ul> <li>a se vedea documentul \"Considerente tehnice generale\", sectiunea \"Considerente generale privind bazele de date proprii sistemelor\", item \"(DBS-03)\" pentru opptiuni privind baza de date ce va fi utilizata \"pentru operatiuni interne si specifice\" de catre sistemul PayValidaBoa</li> </ul>"},{"location":"doc_src/commercial_agreement/agreed_options.html#optiuni-generale-de-implementare","title":"Optiuni generale de implementare","text":"<p>Sistemele tip infrastructura ce vor fi utilizate</p> <ul> <li>\u2610 (general-RQ-01) - server web-HTTP pentru aplicatiile de tip WEB (ATENTIE: sistemele WEB ce vor fi implementate necesita interfata / mod de operare standard <code>WSGI</code>)</li> <li>\u2610 (general-RQ-02) - sistem de autentificare utilizat (intern aplicatie, Google, Identity Management propriu, ...)</li> <li>\u2610 (general-RQ-03) - sistemele vor rula pe infrastructura proprie sau aceastea vor rula in infrastructuri gazduite</li> </ul> <p>Alte optiuni 'ad-hoc' (in sedinta)</p> <ul> <li>...</li> <li>...</li> <li>...</li> <li>...</li> <li>...</li> <li>...</li> </ul>"},{"location":"doc_src/help/880.30-ADMA_catalog.html","title":"Index manuale Administrare (ADMA)","text":"<p> INVOICEtoROefact System (c) 2023, 2024 RENware Software Systems </p>"},{"location":"doc_src/help/880.30-ADMA_catalog.html#catalogul-manualelor-de-configurare-si-administrare","title":"Catalogul manualelor de configurare si administrare","text":"<p>Cuprins:</p> <ul> <li>Catalogul manualelor de configurare si administrare</li> </ul> <ul> <li>...</li> </ul>"},{"location":"doc_src/help/880.30-EUMA_catalog.html","title":"Index manuale End User (EUMA)","text":"<p> INVOICEtoROefact System (c) 2023 RENware Software Systems </p>"},{"location":"doc_src/help/880.30-EUMA_catalog.html#catalogul-manualelor-de-utilizare","title":"Catalogul manualelor de utilizare","text":"<p>Cuprins:</p> <ul> <li>Catalogul manualelor de utilizare</li> </ul> <ul> <li>...</li> </ul>"},{"location":"excel_invoice_template/index.html","title":"Descriere","text":"<p>Copyright (C) RENware Software Systems</p>"},{"location":"excel_invoice_template/index.html#invoice-template","title":"invoice template","text":"<ul> <li>invoice template<ul> <li>Instalarea sablonului de factura emisa</li> <li>Recomandari in utilizarea sablonului</li> <li>Descarcare (download) sablon factura</li> <li>License</li> </ul> </li> </ul>"},{"location":"excel_invoice_template/index.html#instalarea-sablonului-de-factura-emisa","title":"Instalarea sablonului de factura emisa","text":"<p>Aceasta componenta consta dintr-un director (ce nu necesita instalare speciala ci simpla copiere locala acolo unde va fi utilizat). Acest director contine:</p> <ul> <li> <p>fisierul pentru factura <code>invoice_template_CU_tva.xlsx</code> ce este disponibil pentru descarcare aici</p> </li> <li> <p>directorul <code>released_packages/</code> ce contine versiuni anterioare de sablon ce sunt inca suportate</p> </li> <li> <p>prezentul document</p> </li> </ul>"},{"location":"excel_invoice_template/index.html#recomandari-in-utilizarea-sablonului","title":"Recomandari in utilizarea sablonului","text":"<p>Aceasta sectiune se refera la modul in care ar trebui \"tratat\" continutul fisierului Excel cu factura in conditiile in care se intentioneaza ca aceasta sa fi procesata ulterior cu sistemul <code>INVOICEtoROeFact</code>. Acest sablon este general valabil (este un fisier Excel ca oricare altul) deci in acest caz este important a \"constientiza\" faptul ca informatia aferenta facturii din Excel va fi cautata, identificata si gasita in scopul de a fi salvata in formatele de factura electronica (utilizarea acestui sablon de factura Excel impreuna cu sistemul <code>INVOICEtoROeFact</code> ESTE O VARIANTA DE LUCRU RECOMANDATA, dar nu obligatorie).</p> <p>Astfel se recomanda ca acest sablon sa fie utilizat asa cum este livrat, fara a efectua modificari majore in structura sa cum ar fi:</p> <ul> <li> <p>modificarea formatelor (de tip de date) celulelor in scopul unei afisari \"mai frumoase\"</p> </li> <li> <p>adaugarea de informatii prin concatenare de siruri de caractere sau orice alte metode de a altera continutul vizibil al celulelor in scopul unei afisari \"mai frumoase\"</p> </li> <li> <p>modificarea locatiilor celulelor prin inserarea sau stergerea de linii, coloane sau celule noi</p> </li> </ul> <p>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</p> <p> <p>DETALII TEHNICE:</p> <p>Continutul informational al facturii nu trebuie nici confundat si nici mixat cu formatul de afisare al acesteia (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere regulile de formatare din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p> <ul> <li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li> <li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li> </ul> <p></p>"},{"location":"excel_invoice_template/index.html#descarcare-download-sablon-factura","title":"Descarcare (download) sablon factura","text":"<ul> <li> <p>office Excel XLSX 0.1.20</p> </li> <li> <p>arhiva ZIP 0.1.20</p> </li> <li> <p>arhiva ZIP 0.1.11</p> </li> </ul>"},{"location":"excel_invoice_template/index.html#license","title":"License","text":""},{"location":"setup_web_sys/INSTALL-CHROME-On_WSL.html","title":"Install Google Chrome on WSL","text":""},{"location":"setup_web_sys/INSTALL-CHROME-On_WSL.html#download-and-install-chrome","title":"Download and install Chrome:","text":"<pre><code>wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb\nsudo apt -y install ./google-chrome-stable_current_amd64.deb\n\nrm ./google-chrome-stable_current_amd64.deb\n</code></pre>"},{"location":"setup_web_sys/INSTALL-CHROME-On_WSL.html#check-that-its-installed-ok","title":"Check that it\u2019s installed ok:","text":"<pre><code>google-chrome --version\n</code></pre> <p>Running is done with <code>google-chrome</code> command. All X-Windows graphical elements should be installed (normally if WSL is up to date, these are already installed)</p>"},{"location":"setup_web_sys/INSTALL_chrome_driver.html","title":"Setup Chrome Driver on WSL","text":""},{"location":"setup_web_sys/INSTALL_chrome_driver.html#installing-chromedriver","title":"Installing ChromeDriver","text":"<p>Find the URL of the ChromeDriver version that matches your Chrome version on the ChromeDriver website. It should be a zip file; in my case it\u2019s</p> <p><code>wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/linux64/chrome-linux64.zip</code></p> <p>Download, unzip, and put it in your bin directory:</p> <pre><code>wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/linux64/chrome-linux64.zip\nunzip chrome-linux64.zip\ncd  chrome-linux64/\nsudo cp chrome /usr/bin/chromedriver\nsudo chown root:root /usr/bin/chromedriver\nsudo chmod +x /usr/bin/chromedriver\n</code></pre> <p>Double check it worked:</p> <p><code>chromedriver --version</code></p> <p>If was previously installed drivers, check version</p> <p><code>which chromedriver</code></p>"},{"location":"src/xl2roefact/index.html","title":"Index","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/index.html#invoicetoroefact","title":"INVOICEtoROefact","text":"<p>Cuprins:</p> <ul> <li>INVOICEtoROefact<ul> <li>Componentele sistemului</li> <li>Date identificare</li> </ul> </li> </ul> <p>Acest sistem va asigura incarcarea facturilor emise in sistemul ANAF E-Factura.</p>"},{"location":"src/xl2roefact/index.html#componentele-sistemului","title":"Componentele sistemului","text":"<p>Sistemul ofera urmatoarele componente:</p> <ul> <li>xl2roefact</li> <li>web2roefact  </li> <li>xl2roefact PyPi</li> <li>invoice template</li> </ul> <p>Descrierea tuturor acestora poate fi accessata aici.</p>"},{"location":"src/xl2roefact/index.html#date-identificare","title":"Date identificare","text":"<ul> <li>p/n: <code>0000-0095</code></li> <li>code-name: <code>api_to_roefact</code></li> <li>commercial name: INVOICEtoROefact</li> <li>eDataSheet</li> <li>git</li> <li>copyright: RENware Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> <li>general system license</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html","title":"CHANGELOG","text":"<p>RENware Software Systems</p> <p>INVOICEtoROefact Project</p> <ul> <li>CHANGELOG<ul> <li>0.1 (-#NOTE_wip...)<ul> <li>0.1.22.dev invoice customer address optional items (email, reg-com, phone) (#NOTE nxt...)</li> <li>0.1.21.post2</li> <li>0.1.21.post1 fixed missing links in site root index page (240203 10h:30)</li> <li>0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)</li> <li>0.1.20.dev invoice customer address (240123 h10:00)</li> <li>0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)</li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)</li> <li>0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)</li> <li>0.1.16.dev improving Excel kv-data search with \"IN-LABEL\" method (231222 h07:00)</li> <li>0.1.15 updated solution portal http://invoicetoroefact.renware.eu/ (231222 h05:00)</li> </ul> </li> </ul> </li> <li>Archived CHANGELOGs</li> <li>Release Notes #TODO this file should be created</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#changelog","title":"CHANGELOG","text":"<ul> <li>For version code structure meaning see SDEVEN methodology document</li> <li>with (F) are marked those changes that are features in order to be copied in a RELNOTE file and with (B) bug fixes from versions released</li> <li>publishing is made under <code>publishing</code> branch</li> <li><code>&lt;PROJECT ROOT&gt;/doc_src/</code> is the default starting location in a file path (if not clear from context) (ATTN - in production environment is <code>docs/</code>)</li> <li><code>&lt;WEB_ROOT&gt;/</code> is the HTTP server root directory, as default <code>docs/</code> and supposed if no other parent is specified</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#01-note_wip","title":"0.1 (-#NOTE_wip...)","text":"<pre><code>    - ---[ #TODO general planning board ]---------------------------\n    * ai un exemplu complet si complet agnostic (trimis Gigi) de factura format XML si PDF tiparit ca sa faci: (1) incarcare XML (2) geenrare PDF (3) compararea variantelor si identificarea schemei XSD + document specificatii ANAF ref sistemul E-Factura (PDF trimis Liviu)\n    * -#NOTE link Swagger servicii web: `https://mfinante.gov.ro/web/efactura/informatii-tehnice`\n    * -#NOTE link specif API incarcare fact: `https://mfinante.gov.ro/static/10/eFactura/upload.html#/EFacturaUpload/handleRequest`\n\n    - ---[ #TODO short planning board ]---------------------------\n    * left OPEN ISSUES on: `0.1.7` release (and drop them when fixed)\n        * [ ] _file `xl2roefact\\invoice_files/_PLAN_model_test_factura_generat_anaf.xml`, line 114:_ `&lt;cbc:ID&gt;S&lt;/cbc:ID&gt; #FIXME clarify.me_ pare a fi TIPUL PRODUSULUI: (S)erviciu sau ??? (P)rodus sau ???`\n    -\n    * ... FUTURE NEW APP COMMANDS :\n        * `config` - set `config_settings.py` variables (make it INTERACTIVELY using `Rich prompt`)\n        * `xl2json` - crt_wip... (last upd @ 240123)\n        * `json2xml` - see module WRXML,\n        * `json2pdf` - new tbd..,\n        * `xml2roefact` - see mpdule LDXML\n        * chk for other commands from doc `https://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-xl2roefact`\n        * PACKAGE SOLUTION:\n            * [ ] publish `xl2roefact` package --&gt; read `TODO_packaging.md`\n    -\n    * -#NOTE_PLAN `rdinv` module:\n        * invoice header\n            * [ ] wip... invoice header - customer bank, RegCom, email, tel, ...\n            * [ ] invoice header - supplier (`&lt;cac:AccountingSupplierParty&gt;`)\n            * [ ] invoice grand totals (there was left a comment ref whole XML structure in rdinv(), line # ~ where build &amp; write \"Invoice\" key)\n    -------------------------------------------------------------------------------------------------\n</code></pre>"},{"location":"src/xl2roefact/CHANGELOG.html#0122dev-invoice-customer-address-optional-items-email-reg-com-phone-note-nxt","title":"0.1.22.dev invoice customer address optional items (email, reg-com, phone) (#NOTE nxt...)","text":"<ul> <li> <p>tbd... WHEN RELEASE UPDATE make a full chk / review for FIXME &amp; run <code>pdm build_all</code></p> </li> <li> <p>tbd.optional... [piu_240126] left in <code>setup.py</code> comments &amp; example ref how to pre-set MSI build meta information / parameters (obj: default target dir where install, path registration, ...)</p> </li> <li> <p>tbd... invoice customer search for other keys: \"reg com\", \"bank / IBAN / cont\", \"tel\", \"email\" (start in <code>rdinv()</code> w./line 179 &amp; then 331)</p> </li> <li> <p>tbd... use for xl2roefact app help generation IN A markdown page' <code>https://pypi.org/project/mkdocs-typer/</code></p> </li> <li> <p>wip... last item used 240206piu_c</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0121post2","title":"0.1.21.post2","text":"<ul> <li>tbd... 240206piu_c test &amp; release: -- create release, -- publish site, -- upd back <code>requirements.txt</code>, -- save deliverable archives</li> <li> <p>tbd...#TODO... 240206piu_b install package: <code>pip install mkdocs-typer</code></p> </li> <li> <p>240206piu_a add <code>mkdocs-typer</code> extension and update <code>xl2roefact/README.md</code>, section <code>Comenzile aplicatiei</code> page with generated documentation by this plugin</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0121post1-fixed-missing-links-in-site-root-index-page-240203-10h30","title":"0.1.21.post1 fixed missing links in site root index page (240203 10h:30)","text":"<ul> <li>240203piu_a fixed links in <code>/README.md</code> for: <code>xl2roefact PyPi</code> entry</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0121-rollout-news-in-system-portal-invoicetoroefactrenwareeu-240203-h0900","title":"0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)","text":"<ul> <li>240201piu_a reorganized <code>xl2roefact*</code> components by disseminating the installable application, which is something available \"as is now\" just for Windows operating system. For Linux there is no difference between command line application and Python package from an end user point of view.</li> <li>240131piu_a <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code> clean &amp; transform to \"first entry to <code>xl2roefactPyPi</code>\"</li> <li>240131piu_a updated <code>mkdocs.yml</code>: cleaned navigation, created version variables, updated default site build directory to <code>docs/</code>, cleared excluded directories entry</li> <li>240130piu_b reviewed all changes, update site PDF generator file (mvd <code>print_page.md</code> to root) location, fixed navigation. PUBLISHED for <code>xl2roefact</code> component</li> <li>240130piu_a reviewed <code>xl2roefact</code> README: cleaned, translated 2 RO, structured to \"end user needs\"</li> <li>240129piu_d updated <code>xl2roefact</code> to have \"Descrierea detliata\" link in <code>810.05a-system_components.md</code>. Prepared component to be published: mkdocs.yml navigation &amp; main site README index</li> <li>240129piu_c updated all site pages to contain <code>&lt;small&gt;**RENware Software Systems**&lt;/small&gt;</code> &amp; <code>[TOC]</code> after title</li> <li>240129piu_b cleanup project docs, requirements, fresh install ==&gt; published site as is at this point (invoice template finished)</li> <li>240129piu_a updated <code>xl2roefact/README.md</code> with section for assets download</li> <li>240128piu_e formal versioning <code>invoice template</code> component</li> <li>240128piu_d updated &amp; closed component <code>invoice template</code>. Referred in:<ul> <li><code>doc_src/810-DSGN/810.05a-system_components.md</code></li> <li>portal first page</li> <li>navigation in <code>mkdocs.yml</code></li> </ul> </li> <li>240128piu_c moved <code>xl2roefact/excel_invoice_template/</code> directory to root as being distinct component, review it and closed to be published</li> <li>240128piu_b revised, updated and closed crt version of <code>excel_invoice_template/README.md</code></li> <li>240128piu_a updated <code>xl2roefact/README.md</code> &amp; <code>excel_invoice_template/README.md</code> files, cleared modularization &amp; structure presented in system public site</li> <li>240127piu_d Unify main project <code>/READMEmd</code> with <code>doc_src/index.md</code>:<ul> <li>make the same INDEX just in the project root == index / README of whole project</li> <li>keep from actual project README.md the section ref project identification and move it to end of file as last section</li> </ul> </li> <li>240127piu_c created <code>/index.html</code> to redirect to \"real\" system index (<code>doc_src/index.md</code>) and prevent usage of project <code>README.md</code> file instead</li> <li>240128piu_c checked work <code>240127piu_a</code>, <code>240127piu_b</code>, updated <code>about.md</code> and navigation with ref to sys structure (<code>.../810.05a-system_components.md</code>)</li> <li>240127piu_b update system components and their classification (in <code>.../810-DSGN/810.05a-system_components.md</code>)</li> <li>240127piu_a updated <code>810-DSGN/810.05a-system_components.md</code>, defined a classification usable to quickly find out who-does-what</li> <li>240125piu_a updated <code>mkdocs.yml</code> by including <code>mkdocs-same-dir</code> plug-in</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0120dev-invoice-customer-address-240123-h1000","title":"0.1.20.dev invoice customer address (240123 h10:00)","text":"<ul> <li> <p>240123piu_b make a full chk / review for FIXME &amp; run <code>pdm build_all</code></p> </li> <li> <p>240123piu_a <code>def_inv_dir</code> issue ref Excel invoices default get directory, see comments in <code>app_cli.py</code> function <code>xl2json(...)</code></p> </li> <li> <p>240121piu_a updated <code>config_settings.py</code> &amp; <code>rdinv.py</code> with constants: <code>PATTERN_FOR_PARTNER_REGCOM</code>, <code>PATTERN_FOR_PARTNER_IBAN</code>, <code>PATTERN_FOR_PARTNER_TEL</code>, <code>PATTERN_FOR_PARTNER_EMAIL</code>, <code>PATTERN_FOR_PARTNER_BANK</code></p> </li> <li> <p>@CANCELED 240118_admin02 generalize a function <code>get_partner_info(partner_type: str \"customer\" | \"supplier\")</code> to get partner info with partner type as being parameter</p> </li> <li> <p>240118piu_a reviewed and cleaned code: <code>rdinv.rdinv()</code>, <code>config_settings</code>, <code>excel_invoice_template/invoice_template_CU_tva.xlsx</code> (according to updates in testing used invoice)</p> </li> <li> <p>240113piu_a to find <code>cac:PostalAddress</code> and write to:</p> <ul> <li> 1. right set position of key <code>\"cac_PostalAddress\"</code> in basic structure (invoice_header_area)</li> <li> 2a. find excel area ref customer address (...invoice_header_area...)</li> <li> 2b. disseminate &amp; save excel original area (...invoice_header_area...)</li> <li> 3. get &amp; set <code>[\"Invoice\"][\"cac_PostalAddress\"]</code> and all is subsequent keys</li> <li> 4. update XML - JSON map for item \"under\" <code>cac_PostalAddress</code></li> <li> 5. defined and included for use <code>DEFAULT_SUPPLIER_COUNTRY</code> and <code>DEFAULT_CUSTOMER_COUNTRY</code> both for \"RO\". Detailed desc and usage in <code>config_settings.py</code> &amp; <code>rdinv.rdinv(...)</code></li> <li> 6. updated invoice template for country explicit field</li> </ul> </li> <li> <p>240116_admin_01 upd version for 0.1.20</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0119dev-invoice-customer-and-partial-invoice-total-values-calculations-240116-h0600","title":"0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)","text":"<ul> <li> <p>2401_xl2roefact_doc_01 <code>xl2roefact</code> update technical documentation, file <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code></p> </li> <li> <p>240112piu_b 95% clean code <code>rdinv()</code> from customer area identification, from line 204 (kept a DBG print just for area identification (useful for next task ref the same opers but for Supplier))</p> </li> <li> <p>240112piu_a module <code>app_cli.py</code>, created <code>called_when_no_command(...)</code> function called when no command is invoked and to provide only application version (for external users to test it!)</p> </li> <li> <p>240110piu_c <code>xl2json</code> <code>about</code> command to get version &amp; \"nice\" LOGO from <code>xl2roefact/__version__.py</code>, vars <code>__version__</code> &amp; <code>__doc__</code></p> </li> <li> <p>240110piu_b <code>xl2roefact/setup.py</code>ref get app version from file when build EXE/MSI test for <code>__version__</code> is correctly get and release</p> </li> <li> <p>240110piu.a reviewed &amp; updated <code>xl2roefact</code> package <code>README.md</code> + <code>xl2roefact/__version__.py</code> with an app logo and for text mistyping bugs</p> </li> <li> <p>240108piu_c changed <code>pyproject.toml</code> for auto update package version from file <code>xl2roefact/__version__.py</code> (see also opiss 240108piu_b)</p> </li> <li> <p>240108piu_b created <code>xl2roefact/__version__</code> file that contains variable <code>__version__</code> with INTENTION to use in <code>pyproject.toml</code> for app version key (in a future issue)</p> </li> <li> <p>240108piu_a more items:</p> <ul> <li><code>config_settings.py</code> created entry <code>PATTERN_FOR_PARTNER_ADDRESS</code> &amp; updated <code>rdinv</code> module in constants area</li> <li>add comments in <code>app_cli.py</code> ref <code>def_inv_dir</code> issue &amp;&amp;...</li> <li>updated environment dependencies and installed <code>pyinstaller</code> development package with intention to make \"single EXE\" application to be able to run \"from USB stick\"</li> </ul> </li> <li> <p>240107piu_a reviewed <code>xl2roefact</code> package <code>README.md</code>:</p> <ul> <li>(c) explained proposed &amp; promoted directory structure used by CLI application</li> <li>(b) short invoice JSON file structure</li> <li>(a) created first version of tutorial section</li> </ul> </li> <li> <p>240106piu_a invoice customer search and persist for \"RegistrationName\"</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0118dev-invoice-customer-cui-partial-invoice-total-values-calculations-240105-h0800","title":"0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)","text":"<ul> <li> <p>240105piu_c updated <code>xl2roefact</code> package <code>README.md</code> file (with new sections for intro to Excel invoice content rules, tutorial TODO, reference to technical doc)</p> </li> <li> <p>240105piu_b invoice customer search and persist for \"CUI\"</p> </li> <li> <p>240105piu_a <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for DOWN search-method made it optional with default True (useful for Partners set-of KVs where is supposed to be or IN-LABEL or in RIGHT but NOT DOWN because there is a list of KVs not just one placed anywhere in Excel doc)  #TODO tgis is subject of doc update</p> </li> <li> <p>240103piu_d <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for IN-LABEL search-method to return all string except first word (supposed to be label) separated by space character (old strategy was to get only last work from all string)</p> </li> <li> <p>240103piu_c ref invoice customer created in <code>config_settings.py</code> PATTERNs for search keys <code>PATTERN_FOR_PARTNER_ID</code> (CUI or ID), <code>PATTERN_FOR_PARTNER_LEGAL_NAME</code></p> </li> <li> <p>240103piu_b calculated item lines VAT amount as <code>cac_InvoiceLine.LineVatAmmount</code> as raw float value (not rounded to be able to round just invoice TOTAL)</p> </li> <li> <p>240103piu_a <code>rdinv.rdinv()</code> updated JSON -- XML map (part of function <code>_build_meta_info_key(...)</code>)</p> </li> <li> <p>240102piu_a <code>rdinv.rdinv()</code> upd &amp; improved a clear Customer specific XML compliant structure. Targeted this XML structure:                 <pre><code>    &lt;cac:PartyLegalEntity&gt;\n        &lt;cbc:RegistrationName&gt;IORDANESCU PETRE PFA&lt;/cbc:RegistrationName&gt;\n        &lt;cbc:CompanyID&gt;21986376&lt;/cbc:CompanyID&gt;\n    &lt;/cac:PartyLegalEntity&gt;\n</code></pre></p> </li> <li> <p>240101piu_a clean useless &amp; obsolete project files, test new full build (MSI, Python wheel, documentation) ==&gt; PASS OK</p> </li> <li> <p>231229piu_a invoice customer (<code>&lt;cac:AccountingCustomerParty&gt;</code>) detect &amp; set area to search for specific keys (like CUI, RegCom, IBAN, ...)</p> <ul> <li> 1. established AREA TO SEARCH for PARTNER data an <code>_area_to_search</code> (~line 244)</li> <li> 2. updated <code>config_settings.py</code> changed: (for a clear understating of constant scope, because will follow others for specific keys like: \"reg com\", \"CUI\", \"bank / IBAN / cont\", ...)<ul> <li><code>PATTERN_FOR_INVOICE_CUSTOMER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_CUSTOMER_SUBTABLE_MARKER</code></li> <li><code>PATTERN_FOR_INVOICE_SUPPLIER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_SUPPLIER_SUBTABLE_MARKER</code></li> </ul> </li> <li> 3. set-persist <code>_area_to_search</code> for next steps &amp; save its key-info in associated invoice JSON (for further references) - <code>rdinv()</code> ~line 239</li> <li> 4. updated main xl2roefact README.md document ref latter changes and app structuring, concepts, ...(ideas evolving :)...</li> <li> 5. done code for <code>cac_AccountingSupplierParty</code> key by iterating full <code>invoice_header_area[\"customer_area\"]</code> structure</li> </ul> </li> <li> <p>231228piu_a improved documentation generation:</p> <ul> <li> updated all modules docstring(s) to a right markdown representation in generated documentation (ex: when use bullets THEN DO NOT indent at 1st level)</li> <li> @IMP_NOTE: Changed generated documentation file to <code>doc/810.05a-xl2roefact_DLD_specs.md</code> and referred in main <code>doc/810.05a-xl2roefact_component.md</code> as this being a final solution for whole project documentation (that generated with <code>mkdocs</code>)</li> <li> updated <code>pyproject.toml, [tool.pdm.scripts]</code> table with new generated doc file name (810.05a-xl2roefact_DLD_specs.md)</li> </ul> </li> <li> <p>231227piu_b updated <code>xl2roefact.rdinv</code> module ref dropped <code>_</code> chars from internal function names to allow doc generation by PyDoc until will produce a YAML file for PyDoc generator (where will be able to specify concrete list of objects regarding their names)</p> </li> <li> <p>231227piu_a generated a first draft of markdown documentation:</p> <ul> <li> used Pydoc Markdown @ <code>https://niklasrosenstein.github.io/pydoc-markdown/usage/yaml/#yaml-example</code></li> <li> results ==&gt; <code>&lt;PJ_ROOT&gt;/xl2roefact/doc/generated_810.05a-xl2roefact_component.md</code></li> <li> created PDM shell command <code>pdm run</code> (command just for quick remembers: <code>pydoc-markdown -I xl2roefact --render-toc &gt;doc/generated_810.05a-xl2roefact_component.md</code>)</li> </ul> </li> <li> <p>231226piu_b reviewed <code>xl2roefact</code> all \"in use\" code and updated <code>docstrings</code></p> </li> <li> <p>231226piu_a made some useful PDM scripts (ref <code>pyproject.toml</code>, table section <code>[tool.pdm.scripts]</code>) like build commands for:</p> <ul> <li> <code>pdm build_wheel</code> Python package,</li> <li> <code>pdm build_msi</code> MSI package,</li> <li> <code>pdm build_all</code> build all packages</li> <li> <code>pdm xl2roefact</code> run xl2roefact command</li> <li> updated <code>doc/810.05a-xl2roefact_component.md</code></li> </ul> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0117dev-fixed-all-application-package-running-standard-ways-231224-h0530","title":"0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)","text":"<ul> <li> <p>RELEASES:</p> <ul> <li><code>.&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-win64.msi</code></li> <li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17.tar.gz</code></li> <li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-py3-none-any.whl</code></li> </ul> </li> <li> <p>231224piu_a made cli app to run as: Python package main app (<code>python -m xl2roefact</code>) and as script (<code>python xl2roefact.py</code>) while still letting the Python library <code>xl2roefact</code> as importable and use in a programmatic way:</p> <ul> <li> make <code>.../xl2roefact/app_cli.py</code> (from actual <code>.../xl2roefact/__main__.py</code>) which is complete code of CLI app plus a <code>run()</code> function that just launch it</li> <li> make <code>.../xl2roefact/__main__.py</code> that just import <code>app_cli</code> for <code>run()</code> function and call it</li> <li> change actual <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code> to import <code>xl2roefact.app_cli</code> for <code>run()</code> function and call it</li> <li> test for MSI package builds ref <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code></li> <li> clean code, test and close issue:<ul> <li><code>python xl2roefact.py [OPTIONS] COMMAND [ARGS]...</code></li> <li><code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code></li> </ul> </li> </ul> </li> <li> <p>231223piu_a multiple changes ref main code: <code>xl2roefact.py</code> and library <code>xl2roefact</code>, MAINLY created <code>xl2roefact/__main__.py</code> as normal of xl2roefact.py</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0116dev-improving-excel-kv-data-search-with-in-label-method-231222-h0700","title":"0.1.16.dev improving Excel kv-data search with \"IN-LABEL\" method (231222 h07:00)","text":"<ul> <li> <p>231222piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> <li> updated <code>pyproject.toml</code></li> </ul> </li> <li> <p>231222piu_a refactor <code>rdinv.__get_excel_data_at_label(...)</code> to search in label (named \"IN-LABEL\" method)</p> </li> <li> <p>231220piu_b made a first PDM build: [@ 231220 h09:55] ==&gt; test PASS (both created files in <code>dist/</code> was \"git-ignored\")</p> </li> <li> <p>231220piu_b refactored <code>rdinv(...)</code> section \"section for search of <code>invoice_items_area</code> ...\" to use <code>__get_excel_data_at_label(...)</code> function`</p> </li> <li> <p>231220piu_a refactored <code>rdinv.__get_excel_data_at_label(...)</code> for returned \"label_position\" key`</p> </li> <li> <p>231219piu_a update <code>rdinv.__get_excel_data_at_label(...)</code> to return found label value in dictionary as key <code>\"label_value\"</code></p> </li> <li> <p>231218piu_c <code>PDM</code> environment manager, updated <code>pyproject.toml</code> structures ref package building, still preps to create env, generate lock file...</p> </li> <li> <p>231218piu_b CLI application, fixed bug of print settings when deployed from a package (command: <code>xl2roefact.py settings</code>)</p> </li> <li> <p>231218piu_a installed <code>PDM</code> environment manager, updated <code>pyproject.toml</code> structures, nxt to create env, generate lock file...</p> </li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#0115-updated-solution-portal-httpinvoicetoroefactrenwareeu-231222-h0500","title":"0.1.15 updated solution portal <code>http://invoicetoroefact.renware.eu/</code> (231222 h05:00)","text":"<ul> <li>231222piu_a updated CNAME to <code>invoicetoroefact.renware.eu</code></li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#archived-changelogs","title":"Archived CHANGELOGs","text":"<ul> <li>0.1.14.dev invoice issue date</li> <li>0.1.13.dev invoice currency</li> <li>0.1.12.dev invoice number</li> <li>0.1.11.dev packaging improvements for app &amp; xl2roefact package</li> <li>0.1.10.dev command interface improved, <code>msi</code> package building, invoice template &amp; updated documentation</li> <li>0.1.9.dev <code>xl2roefact.RDINV</code> running executable and distribution kit</li> <li>0.1.8.dev improved application structure and first executable release</li> <li>0.1.7.dev <code>xl2roefact.RDINV</code> invoice items &amp; metadata + OPEN ISSUES</li> <li>0.1.6.dev commercial agreement OPTIONS document</li> <li>0.1.5.dev init component xl2roefact for CLI application</li> <li>0.1.4.dev Create system backbone structure</li> <li>0.1.3.dev Enhancing <code>payments_validation_board</code> technical proposal</li> <li>0.1.2.dev Enhancing <code>APItoROefact</code> technical proposal</li> <li>0.1.1.dev Elaborating technical proposal</li> <li>0.1.0.dev System raw backbone</li> </ul>"},{"location":"src/xl2roefact/CHANGELOG.html#release-notes-todo-this-file-should-be-created","title":"Release Notes #TODO this file should be created","text":"<ul> <li>wip... not_yet_created... 0.1</li> </ul>"},{"location":"src/xl2roefact/TODO_and_HOWTO.html","title":"TODO and HOWTO","text":"<ul> <li>TODOs &amp; HOWTOs<ul> <li>Install xl2roefact package</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/TODO_and_HOWTO.html#todos-howtos","title":"TODOs &amp; HOWTOs","text":""},{"location":"src/xl2roefact/TODO_and_HOWTO.html#install-xl2roefact-package","title":"Install <code>xl2roefact</code> package","text":"<p>In master project root (ie, not <code>xl2roefact/</code> directory, but main project directory) execute <code>pip install -e xl2roefact</code>. Now package is installed and all its modules are available.</p>"},{"location":"src/xl2roefact/print_page.html","title":"NOTE: empty document that should be PPRESENT here (content not matters) to serve as reference for final generation of <code>print_page.html</code> (generation is delayed and is based on final result of site navigation structure)","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.0.dev.html","title":"CHANGELOG 0.1.0.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.0.dev System raw backbone<ul> <li>0.1.0 System raw backbone (231104 07:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.0.dev.html#changelog-010dev-system-raw-backbone","title":"CHANGELOG 0.1.0.dev System raw backbone","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.0.dev.html#010-system-raw-backbone-231104-0700","title":"0.1.0 System raw backbone (231104 07:00)","text":"<ul> <li>231104piu_a created first raw system backbone &amp; directories structure</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.1.dev.html","title":"CHANGELOG 0.1.1.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.1.dev<ul> <li>0.1.1 Elaborating technical proposal (231104 08:45)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.1.dev.html#changelog-011dev","title":"CHANGELOG 0.1.1.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.1.dev.html#011-elaborating-technical-proposal-231104-0845","title":"0.1.1 Elaborating technical proposal (231104 08:45)","text":"<ul> <li>231104piu_b got all commercial documents (including <code>110-SRE-general_requirements.md</code>) in directory <code>doc_src/commercial_agreement/</code></li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.10.dev.html","title":"CHANGELOG 0.1.10.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.10.dev<ul> <li>0.1.10 command interface improved, msi package building, invoice template &amp; updated documentation (231207 h12:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.10.dev.html#changelog-0110dev","title":"CHANGELOG 0.1.10.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.10.dev.html#0110-command-interface-improved-msi-package-building-invoice-template-updated-documentation-231207-h1200","title":"0.1.10 command interface improved, <code>msi</code> package building, invoice template &amp; updated documentation (231207 h12:00)","text":"<ul> <li> <p>231207piu_b build a <code>MSI</code> package for <code>0.1.10</code> version ==&gt; <code>0.1.10-xl2roefact-0.1-win64.msi</code>, also installed <code>Python 3.11</code> + <code>cx-Freeze</code> &amp; updated <code>requirements_xl2roefact.txt</code></p> </li> <li> <p>231207piu_a FIXED errors due to Excel files directory duplication in <code>xl2roefact</code> &amp; <code>rdinv()</code></p> </li> <li> <p>231206piu_a clean code for <code>rdinv</code> &amp; <code>xl2roefact</code>, reviewed cnd closed some open issues (todos, notes, ...)</p> </li> <li> <p>231205piu_b made a directory for INVOICE TEMPLATE (<code>excel_invoice_template/</code>) to be delivered with solutions \"for who need a simple template\", also write here a <code>README_excel_invoice_rules.md</code> to describe all required conditions in order to be \"RECOGNIZED &amp; TRANSLATED to JSON\"</p> </li> <li> <p>231205piu_a change all solution to use <code>rich</code> library instead of <code>colorama</code> (Rich library ref <code>https://rich.readthedocs.io/en/stable/index.html</code>)</p> <ul> <li> drop all <code>from colorama import Fore, Back, Style</code></li> <li> add new <code>from rich import print</code></li> <li> update all places where <code>{Fore....}</code> with <code>[...]</code> as:<ul> <li> <code>{Fore.YELLOW}</code> with <code>[yellow]</code></li> <li> <code>{Fore.GREEN}</code> with <code>[green]</code></li> <li> <code>{Fore.MAGENTA}</code> with <code>[magenta]</code></li> <li> <code>{Fore.BLUE}</code> with <code>[blue]</code></li> <li> <code>{Fore.CYAN}</code> with <code>[cyan]</code></li> <li> <code>{Fore.RED}</code> with <code>[red]</code></li> </ul> </li> <li> change all <code>typer.echo</code> with <code>print</code></li> <li> update all places where <code>{Style.RESET_ALL}</code> with <code>[/]</code></li> </ul> </li> <li> <p>231204piu_c build new executable and installer ==&gt; <code>dist/0.1.10.231204piu_a-xl2roefact-0.1-win64.msi</code></p> </li> <li> <p>231204piu_b created <code>./doc/</code> renamed and moved all documentation documents - intention to keep clean <code>xl2roefact root</code></p> </li> <li> <p>231204piu_a <code>xl2roefact xl2json</code> check rdinv() result and if return False, ONLY print a message of \"INFO note\" then continue with next file (the effective error was print by module itself) &amp;&amp; build a new executable package ==&gt; <code>dist/0.1.10.231204piu_a-exe.win-amd64-3.10.zip</code></p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.11.dev.html","title":"CHANGELOG 0.1.11.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.11.dev</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.11.dev.html#changelog-0111dev","title":"CHANGELOG 0.1.11.dev","text":"<ul> <li> <p>231209piu_c build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.11-xl2roefact-0.1-win64.msi</code></li> <li> excel invoice template package ==&gt; <code>dist/0.1.11-excel_invoice_template.zip</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> </ul> </li> <li> <p>231209piu_b fixed <code>xl2roefact</code> CLI options, help, defaults, short names and STABILIZED EXECUTION</p> </li> <li> <p>closed <code>231209piu_a</code> more actions:</p> <ul> <li>changed <code>README.md</code>: translated to RO, updated installation &amp; usage information</li> <li>dropped old, obsolete deployment packages</li> <li>test PASS</li> </ul> </li> <li> <p>231208piu_b add an INVOICE TEMPLATE (<code>excel_invoice_template/invoice_template_CU_tva.xlsx</code>) as deliverable with application</p> </li> <li> <p>231208piu_a review, cleaning and formatting code (generalized &amp; moved some debug-verbose code from <code>rdinv</code> to <code>xl2roefact.xl2json</code>), test PASS</p> </li> <li> <p>231207piu_b cleaned <code>rdinv</code> of \"...for debug purposes...\" prints, test PASS</p> </li> <li> <p>231207piu_c reviewed and updated <code>xl2roefact</code>: README, LICENSE, pyproject.toml</p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.12.dev.html","title":"CHANGELOG 0.1.12.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.12.dev</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.12.dev.html#changelog-0112dev","title":"CHANGELOG 0.1.12.dev","text":"<ul> <li> <p>231212piu_b write canonical form (as @invoice lines, see line ~122) ==&gt; <code>invoice[\"Invoice\"][\"cbc_ID\"]</code> and released <code>0.1.12-xl2roefact-0.1-win64.msi</code></p> </li> <li> <p>231212piu_a <code>rdinv.rdinv()</code> invoice header, invoice number as: <code>{\"value\": ..., \"location\": (row..., col...)}</code></p> </li> <li> <p>231211piu_b <code>rdinv.rdinv()</code> create a function special to get \"one key Excel values\", like invoice number or invoice issue date.  Signature:</p> <ul> <li><code>pattern_to_search_for: list[str]</code> - for inv number will pass the <code>PATTERN_FOR_INVOICE_NUMBER_LABEL</code></li> <li><code>area_to_scan: list[start_cell, end_cell]</code> - for inv number will pass <code>(invoice_header_area[\"start_cell\"], invoice_header_area[\"end_cell\"])</code></li> <li>targeted_tye: type - what type expect (will try to convert to, if cannot will return str)</li> </ul> </li> <li> <p>231211piu_a updated <code>config_settings.py</code> ref how to find it: string labels to search, direction to search effective info starting from label</p> </li> <li> <p>231210piu_a localized and marked areas for invoice header (<code>invoice_header_area</code>) &amp; invoice footer (<code>invoice_footer_area</code>) ==&gt; dicts for header and footer with structure <code>{ start_cell = (row, col), end_cell = (row, col) }</code></p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.13.dev.html","title":"CHANGELOG 0.1.13.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.13.dev</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.13.dev.html#changelog-0113dev","title":"CHANGELOG 0.1.13.dev","text":"<ul> <li> <p>231213piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> </ul> </li> <li> <p>231213piu_a get invoice header - invoice currency</p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.14.dev.html","title":"CHANGELOG 0.1.14.dev","text":"<p>RENware Software Systems</p> <p>INVOICEtoROefact Project</p> <ul> <li>CHANGELOG 0.1.14.dev<ul> <li>0.1.14.dev invoice issue date  (231217 h07:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.14.dev.html#changelog-0114dev","title":"CHANGELOG 0.1.14.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.14.dev.html#0114dev-invoice-issue-date-231217-h0700","title":"0.1.14.dev invoice issue date  (231217 h07:00)","text":"<ul> <li> <p>231217piu_b build packages for:</p> <ul> <li> application deployment package ==&gt; <code>dist/0.1.13-xl2roefact-0.1-win64.msi</code></li> <li> cleaned, tested, created packages (saved to ==&gt; <code>.../880-RLSE/880.90-RLSE Source Code Archives</code>)</li> <li> updated <code>pyproject.toml</code></li> </ul> </li> <li> <p>231217piu_a invoice header, issue date (&amp;&amp; ATTN pendulum raise error, see <code>rdinv.py</code> line #17, ==&gt; MAYBE JUST TRY <code>Arrow</code> or standard <code>datetime</code>)</p> </li> <li> <p>231216piu_a review, improve &amp; clean code for: <code>xl_invoices/config_settings.py</code>, <code>xl_invoices/rdinv.py</code></p> </li> <li> <p>231215piu_b FIXED configs loaded from config_settings: <code>rdinv</code> module load (init) all constants as global variables (because they are subject to change / \"improve\" values as reading Excel file, for example <code>DEFAULT_CURRENCY</code>)</p> </li> <li> <p>231215piu_a changed dir name <code>xl_invoice_modules/</code> to <code>xl_invoices</code> or classic <code>xl2roefact</code>  as this will be the package name. This is a Python official RECOMMENDATION not a constraint</p> </li> <li> <p>231214piu_a made xl2roefact Python standard package (moved <code>xl2roefact</code> modules to a dedicated directory (<code>xl_invoice_modules/</code>) with intention to publish package)</p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.2.dev.html","title":"CHANGELOG 0.1.2.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.2.dev<ul> <li>0.1.2 Enhancing APItoROefact technical proposal (231104 10:30)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.2.dev.html#changelog-012dev","title":"CHANGELOG 0.1.2.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.2.dev.html#012-enhancing-apitoroefact-technical-proposal-231104-1030","title":"0.1.2 Enhancing <code>APItoROefact</code> technical proposal (231104 10:30)","text":"<ul> <li>231104piu_c <code>APItoROefact</code> technical proposal: closed a discussion version</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.3.dev.html","title":"CHANGELOG 0.1.3.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.3.dev<ul> <li>0.1.3 Enhancing payments_validation_board technical proposal (231105 h05:30)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.3.dev.html#changelog-013dev","title":"CHANGELOG 0.1.3.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.3.dev.html#013-enhancing-payments_validation_board-technical-proposal-231105-h0530","title":"0.1.3 Enhancing <code>payments_validation_board</code> technical proposal (231105 h05:30)","text":"<ul> <li>231105piu_a review, update &amp; publish site <code>apitoroefact.renware.eu</code></li> <li>231104piu_i updated project README file</li> <li>231104piu_h <code>payments_validation_board</code> updated commercial name of system to PayValidaBoa and related documentation files</li> <li>231104piu_g update general considerations proposal doc ref using <code>UTC</code> date and times in applications databases</li> <li>231104piu_f add new top level component for administration of: users, e-mails, signature certificates, roles</li> <li>231104piu_e updated site server name to <code>apitoroefact.renware.eu</code> and <code>doc_src/CNAME</code> file</li> <li>231104piu_d <code>payments_validation_board</code> technical proposal - first / draft components decomposition</li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.4.dev.html","title":"CHANGELOG 0.1.4.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.4.dev<ul> <li>0.1.4 Create system backbone structure (231105 h08:15)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.4.dev.html#changelog-014dev","title":"CHANGELOG 0.1.4.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.4.dev.html#014-create-system-backbone-structure-231105-h0815","title":"0.1.4 Create system backbone structure (231105 h08:15)","text":"<ul> <li>231105piu_c create system backbone as directories structure (and initialized min with a <code>README_xxx.md</code> file):<ul> <li><code>web_dashb_app/</code> for component WEB_DASHB (as renaming actual <code>api_to_roefact_app/</code>)</li> <li><code>xl2roefact/</code> for component xl2roefact</li> <li><code>data/</code> for component SYSTEM_DB</li> </ul> </li> <li>231105piu_b revisit and review existing directories and refactored:<ul> <li><code>sysInit/</code> --&gt; <code>sys_init/</code></li> <li><code>setup/</code> --&gt; <code>setup_web_sys/</code></li> <li>published site</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.5.dev.html","title":"CHANGELOG 0.1.5.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.5.dev<ul> <li>0.1.5 init component xl2roefact for CLI application (231106 h06:30)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.5.dev.html#changelog-015dev","title":"CHANGELOG 0.1.5.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.5.dev.html#015-init-component-xl2roefact-for-cli-application-231106-h0630","title":"0.1.5 init component xl2roefact for CLI application (231106 h06:30)","text":"<ul> <li>231106piu_d published changed commercial documents</li> <li>231106piu_c get test invoices: from client, a RENware one, a 3rd party one ==&gt; directory <code>xl2roefact/test_data_and_specs/</code></li> <li>231106piu_b updated <code>doc_src/110-SRE-payments_validation_board_requirements.md</code> ref system decomposition &amp; list of components</li> <li>231106piu_a prepare environment for xl2roefact component:<ul> <li> make a distinct Python-Windows environment in <code>xl2roefact/</code></li> <li> set as git ignore the intended new environment directory: <code>.wenv_xl2roefact/</code></li> <li> install required modules in new environment (<code>pylightxl</code> core module)</li> <li> create specific requirements file: <code>requirements_xl2roefact.txt</code></li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.6.dev.html","title":"CHANGELOG 0.1.6.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.6.dev<ul> <li>0.1.6 commercial agreement OPTIONS document (231107 h07:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.6.dev.html#changelog-016dev","title":"CHANGELOG 0.1.6.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.6.dev.html#016-commercial-agreement-options-document-231107-h0700","title":"0.1.6 commercial agreement OPTIONS document (231107 h07:00)","text":"<ul> <li>231106piu_e document for TECHNICAL agreement with (a) agreed options, (b) estimated deadlines ==&gt; published i <code>commercial_agreement/</code> as <code>agreed_options.md</code> under \"Options\": menu<ul> <li> (a.) for APItoROefact system</li> <li> (b.) for PayValidaBoa system</li> <li> (c.) publish updates</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.7.dev.html","title":"CHANGELOG 0.1.7.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.7.dev<ul> <li>0.1.7 xl2roefact.RDINV invoice items &amp; metadata (231126 h05:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.7.dev.html#changelog-017dev","title":"CHANGELOG 0.1.7.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.7.dev.html#017-xl2roefactrdinv-invoice-items-metadata-231126-h0500","title":"0.1.7 <code>xl2roefact.RDINV</code> invoice items &amp; metadata (231126 h05:00)","text":"<ul> <li> <p>left OPEN ISSUES in this release [piu@231126: marked on todo plan of <code>0.1.8</code> version]</p> <ul> <li> (CLOSED@231213) file <code>xl2roefact/rdinv.py</code>, function <code>__mk_kv_invoice_items_area(...)</code>: <code>FIXME this will be identified in</code>invoice_header_area<code>==&gt; should be changed accordingly</code></li> <li> --&gt; file <code>xl2roefact\\invoice_files/_PLAN_model_test_factura_generat_anaf.xml</code>, line 114: <code>&lt;cbc:ID&gt;S&lt;/cbc:ID&gt; #FIXME clarify.me_ pare a fi TIPUL PRODUSULUI: (S)erviciu sau ??? (P)rodus sau ???</code></li> </ul> </li> <li> <p>231126piu_a item(s) line extensions == item VAT total, item VALUE total</p> </li> <li> <p>231125piu_c changed dir <code>excel_invoices/</code> with <code>invoice_files/</code></p> </li> <li> <p>231125piu_b make a plan from <code>__model_test_factura_generat_anaf.xml</code> marking TODOs &amp; DONE tags &amp; renaming as <code>_PLAN_...idem...</code></p> </li> <li> <p>231125piu_a final review, complete find of invoice relevant columns and write them in <code>invoice</code> dict:</p> <ul> <li>quantity (cbc:InvoicedQuantity),</li> <li>VAT percent (cbc:Percent),</li> <li>description (cbc:Name),</li> <li>uom (cbc:unitCode),</li> <li>unit price (cbc:PriceAmount),</li> <li>currency (c:currencyID)</li> </ul> </li> <li> <p>231224piu_a FIXED VAT calculation for lines which specify a VAT as 0% - USE CASE lines for other taxes like \"acciza\"... - still unsolved for very simplified invoices (see code line containing text \"<code>_vat_percent</code> calculation should also\")</p> </li> <li> <p>231123piu_c <code>rdinv</code> module, defined function <code>libutils.isnumber(a_string: str) -&gt; bool</code> to test is a string is valid as any kind of number</p> </li> <li> <p>231123piu_b <code>rdinv</code> module, function to search for a list of string in a list items (suitable to identify useful / relevant invoice columns from Excel format) ==&gt; <code>__find_str_in_list(str_to_find: str, list_to_search: list)</code></p> </li> <li> <p>231123piu_a prepared function <code>__mk_kv_invoice_items_area(...)</code> to transform <code>invoice_items_area</code> in \"canonical JSON format\" (as kv pairs)</p> </li> <li> <p>231122piu_a  <code>invoice_items_area</code> &amp; <code>meta_info</code> review, check and clean code</p> </li> <li> <p>231121piu_a final <code>invoice</code> dict / JSON data: moved all effective data under key <code>\"excel_data\"</code> (preparing so for final storable invoice \"real keys\")</p> </li> <li> <p>231119piu_b <code>invoice_items_area</code> set unknown rows header to <code>&lt;current line number&gt;.NOTE-&lt;seq&gt;</code>, where <code>seq</code> is an ordered sequence of letters (ie, resulting something like: <code>1.a, 1.b, ...</code>) * 231119piu_a closed:</p> <ul> <li> invoice <code>meta_info</code> area</li> <li> a more defined, clean &amp; clear <code>invoice_items_area</code></li> <li> add <code>last_processing_UTCtime</code> in <code>meta_info</code> dictionary</li> <li> written <code>invoice</code> dict to a JSON (<code>f-JSON</code> file, see doc: <code>https://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html#vedere-de-ansamblu-a-solutiei</code>)</li> </ul> </li> <li> <p>231112piu_a refactor:</p> <ul> <li> <code>base_proc</code> to <code>xl2roefact</code></li> <li> <code>BASE_PROC</code> to <code>xl2roefact</code></li> <li> update documentation</li> <li> publish site</li> </ul> </li> <li> <p>231109piu_a installed module <code>pylightxl</code> in base environment (ie, in project root) to allow modules calling from root for future web components &amp; updated requirements.txt</p> </li> <li> <p>231108piu_f RDINV (<code>rdinv.py</code>) secure for \"unwanted crashes\" errors (missing info) &amp; clean code</p> </li> <li> <p>2811080iu_e install <code>mkdocstrings</code>, update <code>mkdocs.yml</code> and create a markdown document for xl2roefact component (did) not succeeded search for 'FIXME temporary disabled because errs' ...longer_string_...</p> </li> <li> <p>231108piu_d documented that <code>XLSX</code> is the only Excel file format supported (in <code>110-SRE-api_to_roefact_requirements.md</code>) &amp; published site</p> </li> <li> <p>231108piu_c xl2roefact (<code>xl2roefact.py</code>) transformed in class &amp; parametrized worksheet name containing invoice ==&gt; class BaseProc()</p> </li> <li> <p>231108piu_b RDINV (<code>rdinv.py</code>) module set directories environment &amp; open invoice</p> </li> <li> <p>231108piu_a consolidate decomposition (from <code>231107piu_c</code>) ==&gt; directory <code>.../xl2roefact/modules/</code></p> </li> <li> <p>231107piu_c transform decomposition (from <code>231107piu_b</code>) into complete Python modules (making directories for each)</p> </li> <li> <p>231107piu_b created module files according to decomposition (specs doc <code>110-SRE-api_to_roefact_requirements.md</code>)</p> </li> <li> <p>230107piu_a made a first DRAFT runnable CLI program with <code>Typer</code> (<code>https://typer.tiangolo.com/</code>) from <code>xls2xml.py</code> ==&gt; <code>dist/xls2xml.exe</code></p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.8.dev.html","title":"CHANGELOG 0.1.8.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.8.dev<ul> <li>0.1.8 improved application structure and first executable release (231201 h07:30)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.8.dev.html#changelog-018dev","title":"CHANGELOG 0.1.8.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.8.dev.html#018-improved-application-structure-and-first-executable-release-231201-h0730","title":"0.1.8 improved application structure and first executable release (231201 h07:30)","text":"<ul> <li> <p>231201piu_b installed <code>cx-Freeze</code> library and build a new Windows executable, update documentation - need future improvement to make <code>msi</code> package, but TEST PASSED and works perfectly</p> </li> <li> <p>231201piu_a improve CLI application structure (<code>xl2roefact.py</code>) and commands: <code>xl2json</code>, <code>about</code></p> </li> <li> <p>231130piu_a <code>xl2roefact.py</code>, <code>\u2014\u2014excel_files_directory</code>: option, make it of type pathlib.Path, dealut remain as is, validators; is dir, exists, writable, readable, resolve_path</p> </li> <li> <p>231129piu_b updated <code>xl2roefact.py</code> (main application) changed command <code>run</code> --&gt; <code>xl2json</code> and add parameter <code>excel_files_directory</code> (future intention is to make commands: <code>xl2json - RDINV</code>, <code>json2xml - WRXML</code>, <code>json2pdf</code>, <code>xml2roefact - LDXML</code>)</p> </li> <li> <p>231129piu_a adopted new REN invoice template (test with data from RENF-1004)</p> </li> <li> <p>231128piu_b made <code>config_settings.py</code> for general application configuration purposes and an application command (<code>xl2roefact settings</code>) to print them</p> </li> <li> <p>231128piu_a made <code>xl2roefact.py</code> (main library file) as CLI executable structure (with <code>Typer</code> library)</p> </li> <li> <p>231127piu_c introduced key <code>Invoice</code> in  invoice JSON generated structure (also representing the \"entity\" in XML representation)</p> </li> <li> <p>231127piu_b module <code>rdinv</code> crated a distinct function for building of <code>meta_info</code> key (main <code>invoice</code> dictionary)</p> </li> <li> <p>231127piu_a created in invoice JSON map JSON key --&gt; XML property (<code>meta_info[\"map_JSONkeys_XMLtags\"]</code>) as <code>list of tuple(JSONkey: str, XMLtag: str)</code></p> </li> <li> <p>231127piu_a created draft data models for: invoice (exportable as JSON and XML) and other entities (owner, customer) ==&gt; <code>data_models.py</code></p> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.9.dev.html","title":"CHANGELOG 0.1.9.dev","text":"<p>api-to-roefact by RENware Software Systems</p> <ul> <li>CHANGELOG 0.1.9.dev<ul> <li>0.1.9 xl2roefact.RDINV running executable and distribution kit (231203 h07:00)</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.9.dev.html#changelog-019dev","title":"CHANGELOG 0.1.9.dev","text":""},{"location":"src/xl2roefact/changelog_history/CHANGELOG-0.1.9.dev.html#019-xl2roefactrdinv-running-executable-and-distribution-kit-231203-h0700","title":"0.1.9 <code>xl2roefact.RDINV</code> running executable and distribution kit (231203 h07:00)","text":"<ul> <li> <p>231103piu_b releasing ==&gt; made <code>dist/0.1.9-exe.win-amd64-3.10.zip</code> with executable file</p> </li> <li> <p>231103piu_a <code>xl2roefact.py</code> more updates:</p> <ul> <li> set verbose flag for debugging mode</li> <li> made <code>file_name</code> argument as file(s) to be processed with wildcards like Python standard function <code>os.glob.glob()</code> (reference here <code>https://docs.python.org/2/library/glob.html</code>)</li> <li> build a new fresh executable in <code>build/exe.win-amd64-3.10/</code></li> </ul> </li> <li> <p>231202piu_b <code>xl2roefact.py</code> started a skeleton for <code>file_name</code> argument - see code-in-file @\"TODO here to use <code>excel_files_directory</code> + / + <code>file_name</code> to find all files and process them in a loop\"</p> </li> <li> <p>231202piu_a build complete <code>cxFreeze</code> configuration in order to build Windows executable and installer package (as <code>msi</code> package):</p> <ul> <li> create a minimal setup (<code>setup.py</code>)</li> <li> create <code>build/</code> directory with all building commands for xl2roefact app: <code>python setup.py build</code> (see official doc here <code>https://cx-freeze.readthedocs.io/en/latest/setup_script.html</code>)</li> <li>CONCLUSION <code>msi</code> package OK, <code>exe</code> file NOK - see <code>setup.py</code> for a detailed comment marked <code>NOTE-[piu@231202]</code></li> </ul> </li> </ul>"},{"location":"src/xl2roefact/data/README_data.html","title":"README data","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/data/README_data.html#system_db-component","title":"SYSTEM_DB component","text":"<ul> <li>SYSTEM_DB component</li> </ul> <p>This component is presented in document `.../doc_src/...110-SRE-api_to_roefact_requirements.md``</p>"},{"location":"src/xl2roefact/doc_src/wip.html","title":"Under construction page","text":"<p>UPCOMING...</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html","title":"810.05a system components","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#componentele-sistemului","title":"Componentele sistemului","text":"<p>Cuprins:</p> <ul> <li>Componentele sistemului<ul> <li>Componente<ul> <li>xl2roefact</li> <li>web2roefact</li> <li>xl2roefact PyPi</li> <li>invoice template</li> </ul> </li> <li>Criterii de clasificare</li> <li>Note</li> </ul> </li> </ul> <p>Sistemul consta din mai multe componente toate avind acelasi obiectiv central: emiterea de facturi si procesarea facturilor emise existente deja. Faptul ca sunt mai multe componente asigura mai multe cai alternative de a atinge obiectivul central, cai ce pot fi utilizate in paralel (concurent, in acelasi timp) in functie de \"dotarea tehnica\" a fiecaruia, de afinitatea fiecaruia la un \"gen\" de sisteme sau pur si simplu de preferinta de moment a fiecaruia.</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#componente","title":"Componente","text":"<p>Sistemul ofera urmatoarele componente:</p> <ul> <li>xl2roefact</li> <li>web2roefact</li> <li>xl2roefact PyPi</li> <li>invoice template</li> </ul> <p>Facilitatile si functionalitatile generale (pe scurt) ale fiecareia din acestea sunt prezentate mai jos. (Pentru intelegerea facilitatilor unei componente a se citi sectiunea Criterii de clasificare)  </p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#xl2roefact","title":"xl2roefact","text":"<p>Aplicatie linie de comanda pentru procesarea facturilor. Facilitati: </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#web2roefact","title":"web2roefact","text":"<p>Aplicatie web pentru procesarea facturilor. Facilitati: </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#xl2roefact-pypi","title":"xl2roefact PyPi","text":"<p>Pachet (biblioteca) public Python utilizabil pentru dezvoltare / extindere aplicatii proprii. Facilitati: </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#invoice-template","title":"invoice template","text":"<p>Sablon factura in format Office Excel. Facilitati: </p> <ul> <li> OpM CLI</li> <li> OpM WEB</li> <li> INp XLSX</li> <li> INp JSON</li> <li> INp FORM</li> <li> EXp JSON</li> <li> EXp XML</li> <li> EXp EXCEL</li> <li> EXp PDF</li> <li> R2R</li> <li> ROeF</li> </ul> <p>Descriere detaliata aici</p>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#criterii-de-clasificare","title":"Criterii de clasificare","text":"<p>In scopul identificarii mai usoare a componentelor necesare acestea sunt clasificate dupa urmatoarele criterii:</p> <ul> <li> <p>OpM modul de operare al componentei:</p> <ul> <li>CLI specifica o componenta ce va fi executata in mod linie de comanda (Windows din <code>Command</code>, Linux din <code>Terminal</code>)</li> <li>WEB specifica o componenta ce va fi accesata dintr-un browser</li> </ul> </li> <li> <p>INp  modul de introducere si import a facturii:</p> <ul> <li>XLSX import dintr-un document <code>Office Excel</code> unde a fost deja introdusa anterior preluarii. Ca si instrument de introducere poate fi folosit oricare din cele ce permit salvarea / exportul in format <code>XLSX</code> (alte formate, in special cel anterior - <code>XLS</code> nu sunt importabile - ci trebuiesc \"convertite\" la formatul <code>xlsx</code>)</li> <li>JSON import din format <code>JSON</code></li> <li>FORM factura se poate introduce manual direct in sistem, acesta punind la dispozitie un formular dedicat acestei operatii</li> </ul> </li> <li> <p>EXp formatul de exportare a facturilor1:</p> </li> <li>JSON format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>REST</code> (de exemplu Oracle EBS)</li> <li>XML format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>SOAP</code>2 (de exemplu RO eFact, SAP)</li> <li>EXCEL format Office Excel <code>xlsx</code></li> <li> <p>PDF format Adobe PDF tiparibil</p> </li> <li> <p>R2R specifica faptul ca acea componenta poate fi folosita ca atare, fara o instalare prealabila (\"ready to run\") altfel aceasta trebuie instalata inainte de utilizare</p> </li> <li> <p>ROeF specifica faptul ca acea componenta permite incarcarea automata3 a facturii in sistemul ANAF SPV RO eFact</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/810-DSGN/810.05a-system_components.html#note","title":"Note","text":"<ol> <li> <p>Exportul facturilor in formatele <code>EXCEL</code> si respectiv <code>PDF</code> se face utilizind formatul vizual al documentului din componenta <code>invoice template</code> \u21a9</p> </li> <li> <p>schemele <code>XML</code> respectate sunt: <code>\"xmlns\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2\"</code>, <code>\"xmlns:cbc\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2\"</code>, <code>\"xmlns:cac\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2\"</code>, <code>\"xmlns:ns4\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2\"</code>, <code>\"xmlns:xsi\": \"http://www.w3.org/2001/XMLSchema-instance\"</code>, <code>\"xsi:schemaLocation\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd\"</code> \u21a9</p> </li> <li> <p>incarcarea automata a facturii in sistemul <code>ANAF RO eFact</code> este conditionata de configurarea respectivei componente cu credentialele necesare autentificarii in acest sistem (altfel acesta informatie va fi ceruta utilizatorui pentru introducere manuala)\u00a0\u21a9</p> </li> </ol>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html","title":"110 SRE api to roefact requirements","text":"<p> INVOICEtoROefact System (c) 2023 RENware Software Systems </p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#propunere-tehnica-sistem-invoicetoroefact","title":"Propunere tehnica sistem INVOICEtoROefact","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica sistem INVOICEtoROefact<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Componenta xl2roefact<ul> <li>Diagrama logica de functionare a componentei</li> </ul> </li> <li>Componenta WEB_DASHB</li> <li>Componenta SYSTEM_DB</li> </ul> </li> </ul> <ul> <li>p/n: <code>0000-0095</code></li> <li>code-name: <code>api_to_roefact</code></li> <li>commercial name: INVOICEtoROefact</li> <li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html</code></li> <li>git: <code>https://github.com/petre-renware/api_to_roefact</code></li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica sistem INVOICEtoROefact<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Componenta xl2roefact<ul> <li>Diagrama logica de functionare a componentei</li> </ul> </li> <li>Componenta WEB_DASHB</li> <li>Componenta SYSTEM_DB</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#obiective","title":"Obiective","text":"<p>Acest sistem va asigura incarcarea facturilor emise in sistemul ANAF E-Factura cu respectarea reglementarilor publicate in acest sens (lista contine si legaturi catre fisierele publicate de catre ANAF):</p> <ul> <li> <p>Conformarea la modificarile legislative si utilizarea sistemului</p> </li> <li> <p>Informatii de interes referitoare la implementarea sistemului na\u021bional privind factura electronic\u0103 RO e-Factura</p> </li> <li> <p>Instruc\u021biuni de utilizare</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#vedere-de-ansamblu-a-solutiei","title":"Vedere de ansamblu a solutiei","text":"<p>Solutia <code>api_to_roefact</code> consta din urmatoarele componente:</p> <ul> <li> <p><code>api_to_roefact</code>.<code>xl2roefact</code> aceasta componenta are rolul de a implementa efectiv obiectivele principale ale sistemului INVOICEtoROefact. Componenta este capabila sa ruleze atit \"standalone\" (ca linie de comanda CLI) dar si prin utilizarea ei de catre componenta <code>WEB_DASHB</code> si astfel utilizarea ei in varianta de sistem prezentat \"over internet / intranet\". Prezentarea detalita a acesteia se gaseste aici.</p> </li> <li> <p><code>api_to_roefact</code>.<code>WEB_DASHB</code> aceasta componenta are rolul de agrega componentele si de a prezenta solutia INVOICEtoROefact \"over internet / intranet\". De asemenea componenta asigura modulele UI necesare pentru administrarea sistemului. Prezentarea detalita a acesteia se gaseste aici.</p> </li> <li> <p><code>api_to_roefact</code>.<code>SYSTEM_DB</code> .Aceasta componente reprezita baza de date a sistemului INVOICEtoROefact atit partea relationala dar si partea <code>no-sql</code> a acesteia (utilizata pentru eventuale sincrnizari provenite din utilizarea CLI a componentei <code>xl2roefact</code>). Prezentarea detalita a acesteia se gaseste aici.</p> </li> </ul> <p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>api_to_roefact</code>.</p> <p></p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-xl2roefact","title":"Componenta xl2roefact","text":"<ul> <li> <p>(RDINV) modul de procesare a fisierului format <code>XLSX</code> ce contine factura si colectare a datelor aferente</p> <ul> <li>INTRARI: fisier format <code>XLSX</code> ce contine factura emisa (cod: <code>f-XLSX</code>)</li> <li>IESIRI: fisier format <code>JSON</code> imagine a datelor facturii (cod: <code>f-JSON</code>)</li> </ul> </li> <li> <p>(WRXML) modul de generare a fisierului format <code>XML</code></p> <ul> <li>INTRARI: fisier <code>f-JSON</code></li> <li>IESIRI: fisier format <code>XML</code> conform cerintelor si sistemului <code>ANAF E-Factura</code> (cod: <code>f-XML</code>)</li> </ul> </li> <li> <p>(CHKXML) modul de validare a facturii in sistemul <code>ANAF E-Factura</code></p> <ul> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu eventualele erori de validare 1</li> </ul> </li> <li> <p>(LDXML) modul de incarcare a facturii in sistemul <code>ANAF E-Factura</code></p> <ul> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu validarea si identificatorul incarcarii 1</li> </ul> </li> <li> <p>(CHKISLD) modul de verificare a starii de incarcare a unei facturi emise</p> <ul> <li>INTRARI: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii</li> <li>IESIRI: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata 2</li> </ul> </li> </ul> <p>Formatul fisierelor Excel cu factura</p> <p><code>XLSX</code> este sigurul format de fisier acceptat</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#diagrama-logica-de-functionare-a-componentei","title":"Diagrama logica de functionare a componentei","text":"<pre><code>flowchart TD\n    start([\"start\"])\n    stop([\"stop &amp; \\nrepeta ciclul\"])\n    RDINV[\"procesare a fisierului format XLSX\"]\n    WRXML[\"generare a fisierului format XML\"]\n    CHKXML[\"validare a facturii\"]\n    LDXML[\"incarcare a facturii in sistemul E-Factura\"]\n    CHKISLD[\"verificare stare de incarcare facturi\"]\n\n    f-XLSX[\\\"f-XLSX\"/]\n    f-XML[\\\"f-XML\"/]\n    f-JSON[\\\"f-JSON\"/]\n    DBS[(\"system database\")]\n\n    loaded{\"incarcata?\"}\n\n    start ---&gt; RDINV\n    f-XLSX --&gt; RDINV\n    RDINV ---&gt; f-JSON\n    RDINV --&gt; CHKISLD\n\n    CHKISLD --&gt; loaded\n    loaded --DA--&gt; stop\n\n    loaded --NU--&gt; WRXML\n    WRXML --&gt; f-XML\n    WRXML --&gt; LDXML\n    LDXML --&gt; CHKXML\n    CHKXML --&gt; stop\n\n    CHKXML --&gt; DBS\n\n    LDXML ---&gt; DBS</code></pre> <p>...#FIXME explicatii necesare ?...</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-web_dashb","title":"Componenta WEB_DASHB","text":"<p>...INCOMING...  </p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-system_db","title":"Componenta SYSTEM_DB","text":"<p>...INCOMING...  </p> <ol> <li> <p>raportul se scrie in baza de date a sistemului si in fisierul <code>f-XLSX</code> intr-un worksheet separat dedicat acestui scop\u00a0\u21a9\u21a9</p> </li> <li> <p>in cazul valorii echivalent <code>TRUE</code> se poate intoarce identificatorul incarcarii daca este disponibil\u00a0\u21a9</p> </li> </ol>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html","title":"110 SRE general requirements","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html#propunere-tehnica","title":"Propunere tehnica","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica<ul> <li>Aria de cuprindere</li> <li>Considerente generale de securitate</li> <li>Considerente generale privind bazele de date proprii sistemelor</li> <li>Considerente generale privind auditarea informatiilor</li> </ul> </li> </ul> <ul> <li>Client:  n/a - not public</li> <li>Data: 2023-Noiembrie</li> </ul> <p>Codificarea documentelor</p> <ul> <li>codificarea numelor documentelor si a proceselor este facuta in conformitate cu metodologia RENware SDEVEN</li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica<ul> <li>Aria de cuprindere</li> <li>Considerente generale de securitate</li> <li>Considerente generale privind bazele de date proprii sistemelor</li> <li>Considerente generale privind auditarea informatiilor</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html#aria-de-cuprindere","title":"Aria de cuprindere","text":"<p>Solutiile propuse prin aceasta propunere tehnica sunt:</p> <ul> <li> <p>INVOICEtoROefact (code-name <code>api_to_roefact</code>) integrare Sistemul National de Facturi Emise RO e-Factura descriere si cerinte aici</p> </li> <li> <p>PayValidaBoa (code-name <code>payments_validation_board</code>) Flux aprobare facturi primite pentru ordonantare la plata descriere si cerinte aici</p> </li> </ul> <p>In continuare se prezinta o serie de considerente generale valabile pentru toate sistemele din aria de acoperire.</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-de-securitate","title":"Considerente generale de securitate","text":"<ul> <li> <p>(RSEC-01) fisierele de configurare a sistemelor (fiind format text <code>UTF-8</code>) vor avea ca <code>owner</code> un utilizator dedicat sistemului respectiv sau utilizatorul <code>root</code>. Numai acesti doi utilizatori pot avea acces <code>RW</code> la aceste fisiere</p> </li> <li> <p>(RSEC-02) toate documentele de provenienta externa sistemelor vor fi \"purtatoare\" ale unui certificat digital ce atesta validitatea documentelor. Acest certificat va fi de preferinta de tip \"semnatura electronica\" dar nu obligatoriu calificata. Este suficient un simplu certificat (cheie) tip <code>RSA</code> generat intern si distribuit utilizatorilor autorizati sa emita documentele respective. O copie a certificatului (sau a certificatelor daca se vor emite mai multe) ce atesta validitatea unui document va sta pe server in locatii ce sunt conforme cu RSEC-01</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-privind-bazele-de-date-proprii-sistemelor","title":"Considerente generale privind bazele de date proprii sistemelor","text":"<ul> <li> <p>(DBS-01) bazele de date vor contine o cheie primara \"real primara\" (adica avind toate caracteristicile tehnice pentru <code>PK</code> in sensul uzual cunoscut din teoria bazalor de date). Aceasta cheie va fi de tip <code>Char(32)</code> reprezentind tipul <code>uuid4</code> (cunoscut si ca <code>guid</code>) convertit la sir de caractere <code>UTF-8</code> si reversibil ca transformare din <code>string</code> in <code>uuid4</code>. Aceasta cheie va fi generata automat si intretinuta de sistem deservind scopuri pur tehnice de referentiere si relationare a datelor. Modificarea manuala nu este permisa putind genera situatii de hazard.</p> </li> <li> <p>(DBS-02) bazele de date vor contine si o alta \"cheie primara uman recongnoscibila\" (<code>AK</code> in teoria bazelor de date) utilizata in scop de recunoastere si regasire a informatiei de catre utilizatori. Aceasta cheie va avea urmatoarele catacterisrici:</p> <ul> <li>va fi unica, tip <code>Char(10)</code> (limitarea lungimii se va aplica la introducerea datelo si nu in baza de date)</li> <li>agnostic case, nu se va face diferenta intre litere mari sau mici (pentru a evita confuziile)</li> <li>obligatorie iar daca utilizatorul \"nu o doreste\" se va default-a la <code>PK-ul</code> anterior</li> </ul> </li> <li> <p>(DBS-03) bazele de date vor fi intr-unul din formatele: (a) relational sau (b) JSON standard. Pentru bazele de date in format relational va fi preferata o solutie de SGBD tip open source matura,   intretinuta in urmatoarea ordine de aplicare:</p> <ul> <li><code>1.</code> SQLite pentru baze de date ce nu vor depasi 10,000 de inregistrari</li> <li><code>2.</code> PostgreSQL pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li> <li><code>3.</code> MariaDB pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li> <li>prima varianta va fi preferata datoritra \"portabilitatii datelor\"</li> <li>a treia varianta este enumerata ca optiune preferata a utilizatorului la varianta <code>2.</code></li> </ul> </li> <li> <p>(DBS-04) bazele de date vor folosi numai cimpuri formate standard, clasice si elemetare:</p> <ul> <li>sir de carectere (<code>CHAR</code> sau <code>VARCHAR</code>)</li> <li>numere intregi cu semn (<code>INTEGER</code>)</li> <li>numere reale cu semn (<code>FLOAT</code>)</li> <li>numere combinate a caror valoare poate fi intreg sau real (<code>NUMBER</code>)</li> <li>valori logice sub forma intreg cu semn astfel: <code>1</code> pentru TRUE si <code>0</code> sau <code>NULL</code> pentru FALSE</li> <li>valori logice sub forma de caracter astfel: prima litera din lista <code>[Y, y, D, d, T, t]</code> pentru TRUE si orice altceva inclusiv <code>NULL</code> pentru FALSE</li> </ul> </li> <li> <p>(DBS-05) in cazul bazelor de date relationale, integritatile referentiale vor fi evitate la maximum prin intretinerea datelor numai cu ajutorul aplicatiei sau in cazull necesitatii modificarii manuale a datelor, aceasta modfica re sa fie efectuata numai de personal calificat</p> </li> <li> <p>(DBS-06) informatiile de tip data-timp (data, ora, etc...) vor fi stocate de preferinta sub forma de <code>String</code> in formatul ISO: <code>YYYY-MM-DD HH:MM:SS.nnnnn</code>.</p> </li> <li> <p>(DBS-07) informatii de data-timp vor fi stocate avind valori agnostice de \"Time Zone\" adica vor fi considerate <code>UTC</code> lucru care va permite comparabilitatea acestora indiferent de locatia /zpna de timp de unde au fost generate.</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-general_requirements.html#considerente-generale-privind-auditarea-informatiilor","title":"Considerente generale privind auditarea informatiilor","text":"<ul> <li> <p>Cimpurile de audit ce indica utilizatori:</p> <ul> <li>(AUD-01) pentru informatiile CONSTIENT GENERATE DE UTILIZATORI (adica generate prin activarea unor controale vizuale, prin lansarea manuala a unei aplicatii, etc), aceste cimpuri vor contine numele tip <code>username</code> al utilizatorului folosit pentru autentificarea in sistem</li> <li>(AUD-02) pentru informatiile GENERATE DE SISTEM la rulari automate, periodice, de verificare, de validare, etc, aceste cimpuri vor contine textul <code>system</code> (pentru a evita confuzii cu utilizatori reali la nivel de sistem de operare)</li> </ul> </li> <li> <p>(AUD-03) Cimpurile de audit ce indica date calendaristice vor respecta standardul ISO fiind in formatul maximal <code>YYYY-MM-DD hh:mm:ss</code></p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html","title":"110 SRE payments validation board req.uirements","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#propunere-tehnica-sistem-payvalidaboa","title":"Propunere tehnica sistem PayValidaBoa","text":"<p>Cuprins:</p> <ul> <li>Propunere tehnica sistem PayValidaBoa<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Cerinte functionale generale</li> <li>Componenta xxx</li> </ul> </li> </ul> <ul> <li>p/n: <code>0000-0094</code></li> <li>code-name: <code>payments_validation_board</code></li> <li>commercial name: PayValidaBoa</li> <li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html</code></li> <li>git: <code>n/a</code></li> </ul> <p>Cuprins:</p> <ul> <li>Propunere tehnica sistem PayValidaBoa<ul> <li>Obiective</li> <li>Vedere de ansamblu a solutiei</li> <li>Cerinte functionale generale</li> <li>Componenta xxx</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#obiective","title":"Obiective","text":"<p>Acest sistem asigura prezentarea unui \"dashboard\" cu lista facturilor primite si starea lor de verificare si aprobare interna in vederea ordonantarii lor la plata.</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#vedere-de-ansamblu-a-solutiei","title":"Vedere de ansamblu a solutiei","text":"<p>Sistemul <code>payments_validation_board</code> consta din urmatoarele componente:</p> <ul> <li> <p><code>INV_TOPMNG_BOARD</code> - aceasta componenta prezinta pentru MANAGEMNTul tip CFO lista facturilor primite si starea lor referitor la validarea si aprobarea lor finala si un control pentru APROBARE FINALA sau BUN DE PATA. </p> </li> <li> <p><code>INV_CHK_BOARD</code> - aceasta componenta prezinta pentru VERIFICATORI si APROBABTORI lista fa/turilor primite si diverse controale pentru aprobarea si scrierea de diverse note si observatii. </p> </li> <li> <p><code>INV_NOTIF_BOARD</code> aceasta componenta prezinta notificari referitoare la diversele OBSERVATII si NOTE facture asupra facturilor primite in diverse stadii de aprobare de catre persoanele care efectueaza verificari asupra lor (prin componenta <code>INV_CHK</code>). Notificarile sunt disponibile atit in interfata aplicatiei iar unele din ele pot fi transmise prin mail. </p> </li> <li> <p><code>INV_LD_FOR_APPRV</code> - aceasta componenta permite incarcarea facturilor in fluxul de aprobare. Optiuni de incarcare:</p> <ul> <li>manuala (dintr-un board al aplicatiei)</li> <li>automata dintr-un director</li> <li>dintr-o baza de date externa sistemului (cu \"marcarea\" facturilor ce vor trebui incarcate)</li> <li>la incarcare (indiferent de metoda) vor trebui specificati (sau dedusi din alte informatii) DESTINATARII ce primesc documentul</li> </ul> </li> <li> <p><code>ADMIN_CFG</code> aceasta componenta permite pentru ADMINISTRATORI diverse OPTIUNI DE CONFIGURARE:</p> <ul> <li>lista utilizatorilor ce fac parte dinfluxul de aprobare</li> <li>adresele e-mail ale utilizatorilor</li> <li>rolul utilizatorilor in accea ce priveste fluxul de aprobare facturile primite</li> <li>certificate si semnaturile de certificare a \"semnaturilor\" de aprobare</li> <li>... </li> </ul> </li> </ul> <p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>payments_validation_board</code>.</p> <p>...IN PROGRESS...  </p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#cerinte-functionale-generale","title":"Cerinte functionale generale","text":"<p>...INCOMING...  </p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html#componenta-xxx","title":"Componenta xxx","text":"<p>...INCOMING...  </p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/231109_meeting.html","title":"Meeting minute","text":"<ul> <li>Data: 2023-11-09</li> <li>Participants:<ul> <li>Costel Lungu, Kraftanlagen</li> <li>Alexandru Alexandru, Kraftanlagen</li> <li>Catalin Ristea, Kraftanlagen</li> <li>Margareta Stefanescu, Kraftanlagen</li> <li>Liviu Neacsu, Kraftanlagen</li> <li>Petre Iordanescu, RENware Software Solution</li> </ul> </li> <li>Organizare:<ul> <li>link conectare</li> <li>Meeting ID: 381 897 114 828</li> <li>Passcode: eeBDEH</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/231109_meeting.html#discussions","title":"Discussions","text":""},{"location":"src/xl2roefact/doc_src/commercial_agreement/231109_meeting.html#general-aspects","title":"General aspects","text":"<ul> <li>companii CUI distinct si fac diferentiere maxima (exceptie ca sunt operate de acelasi personal):<ul> <li>IPIP preluat</li> <li>Kraftlangen main / base</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/231109_meeting.html#discutii-si-factori-decizionali","title":"Discutii si factori decizionali","text":"<ul> <li> <p>3 elemente:</p> <ul> <li>comunicarea cu SPV (cca 40 buc/luna, servicii, mayteriale)</li> <li>facturile vor ramine in Excel</li> <li>facturi Kraflangen merg si la 700/luna</li> </ul> </li> <li> <p>tipuri fact (emise?)</p> <ul> <li>facturi materiale</li> <li>facturi lucrari de la furnizori</li> <li>alte facturi (telefoane, etc)</li> </ul> </li> <li> <p>sist tb sa permita pe viitor math fact din SPV (primita mai ales) cu documentele primare din sistemul propriu (NIR, doc justificative, PVuri, ...) acest match ar trebui sa fie un flow (pentru ca sunt mai multe persoane)</p> </li> <li> <p>idem pentru aprobare (cred ca PayValidaBoa ar trebui deja sa faca)</p> </li> <li> <p>din 1 Iulie 2024 toate fact XML din SPV vor fi \"cu sigiliu\"</p> </li> <li> <p>facturile vor trebui sa ajunga in SAP - acum se trimit prin intermediul unei arhive (speciala...) pentru a fi incarcate automatizat de Germania in SAP solutia tb sa fie suficient de versatila astfel incit daca se schimba SAP sa ramina valida informatia trimisa ASTFEL un format intermediar (dedicat Romania) ar fi de dorit</p> </li> <li> <p>...</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html","title":"Agreed options","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html#optiuni-tehnice","title":"Optiuni tehnice","text":"<p>Cuprins:</p> <ul> <li>Optiuni tehnice<ul> <li>Optiuni sistem INVOICEtoROefact<ul> <li>Recomandari sistem INVOICEtoROefact</li> </ul> </li> <li>Optiuni sistem PayValidaBoa</li> <li>Optiuni generale de implementare</li> </ul> </li> </ul> <p>Acest document prezinta posibilele optiuni tehnice la cele doua sisteme, optiuni care vor trebui agreate si (preferabil) planificate cel putin din punct de vedere al prioritatii.</p>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html#optiuni-sistem-invoicetoroefact","title":"Optiuni sistem INVOICEtoROefact","text":"<p>Forma de utilizare si interactionare</p> <ul> <li>\u2610 (INVOICEtoROefact-RQ-01) - varianta CLI (command line) cu utilizare \"individuala\"</li> <li>\u2610 (INVOICEtoROefact-RQ-02) - varianta WEB cu utilizare centralizata</li> </ul> <p>Configurabilitate</p> <ul> <li>\u2610 (INVOICEtoROefact-RQ-03) - varianta in care se prelucreaza un model de fisier <code>Excel</code> in care sunt \"fixate si blocate\" locatiile celulelor ce contin date relevante</li> <li>\u2610 (INVOICEtoROefact-RQ-04) - varianta in care structura si formatul fisierului <code>Excel</code> contin \"cuvinte cheie\" ce determina regasirea date relevante (de exemplu textul \"Client:\" intr-o celula semnifica inceperea unei zone cu datele clientului de la acea celula in jos si pina prima celula necompletata ce va fi gasita)</li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html#recomandari-sistem-invoicetoroefact","title":"Recomandari sistem INVOICEtoROefact","text":"<ul> <li> <p>varianta (INVOICEtoROefact-RQ-01) este recomandata ca fiind \"aproape obligatorie\" deoarece chiar si in varianta WEB ea va trebui scrisa intr-o forma neutilizabila direct (sub forma de functie a sistemlui). Transformarea acestei functii in varianta CLI va permite o executie portabila (\"la purtator\") si offline (in situatii extreme se poate folosi doar fisierul <code>XML</code> generat si acesta va putea fi manual incarcat in ANAF-SPV). Informatia privind \"starea de incarcare a facturii\" va fi oricum salvata si in fisierul Excel aferent facturii si va putea fi preluata de catre varianta WEB pentru centralizarea informatiilor- a se vedea si modulul <code>LDXML</code> si notele de subsol aferente</p> </li> <li> <p>optiunea (INVOICEtoROefact-RQ-03) este recomandata ca varianta de start deoarece va permite realizarea unei variante OPERATIONALE (de lucru curent si testare) intr-un termen mai scurt, urmind ca aceasta optiune sa fie gradat extinsa si cu optiunea (INVOICEtoROefact-RQ-04). Aceasta \"linie de lucru\" nu va induce probleme, avind in vedere ca orice optiune / varianta aleasa ca varianta de start si planificata a fi extinsa va implica si MIGRAREA datelor deja produse la momentul extinderii ei</p> </li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html#optiuni-sistem-payvalidaboa","title":"Optiuni sistem PayValidaBoa","text":"<p>Framework standardizat de orchestrare</p> <ul> <li>\u2610 (PayValidaBoa-RQ-01) - utilizarea unui framework specializat de orchestrare si integrare cu alte sisteme \"externe\"<ul> <li>Implicatii: poate mari durata de implementare</li> <li>Avantaje: utilizarea ulterioara pentru integrare intre sisteme ce prezita interfata standardizata (REST, SOA, NTFS, EXT4, OAuth, ...)</li> </ul> </li> </ul> <p>Semnare electronica a facturilor verificate</p> <ul> <li>\u2610 (PayValidaBoa-RQ-02) - utilizarea de certificat tip \"semnatura electronica\" pentru autentificarea verificarii facturilor EMBEDDED IN FACTURA</li> <li>\u2610 (PayValidaBoa-RQ-03) - utilizarea de certificat tip \"semnatura electronica\" pentru autentificarea verificarii facturilor adiacet facturii - disponibil pentru consultare numai in sistemul PayValidaBoa</li> <li>\u2610 (PayValidaBoa-RQ-04) - verificarea facturilor nu necesita certificat tip \"semnatura electronica\" ci simpla informatie existenta in sistemul PayValidaBoa este suficienta</li> </ul> <p>Baza de date 'interna / specifica' sistemului PayValidaBoa</p> <ul> <li>a se vedea documentul \"Considerente tehnice generale\", sectiunea \"Considerente generale privind bazele de date proprii sistemelor\", item \"(DBS-03)\" pentru opptiuni privind baza de date ce va fi utilizata \"pentru operatiuni interne si specifice\" de catre sistemul PayValidaBoa</li> </ul>"},{"location":"src/xl2roefact/doc_src/commercial_agreement/agreed_options.html#optiuni-generale-de-implementare","title":"Optiuni generale de implementare","text":"<p>Sistemele tip infrastructura ce vor fi utilizate</p> <ul> <li>\u2610 (general-RQ-01) - server web-HTTP pentru aplicatiile de tip WEB (ATENTIE: sistemele WEB ce vor fi implementate necesita interfata / mod de operare standard <code>WSGI</code>)</li> <li>\u2610 (general-RQ-02) - sistem de autentificare utilizat (intern aplicatie, Google, Identity Management propriu, ...)</li> <li>\u2610 (general-RQ-03) - sistemele vor rula pe infrastructura proprie sau aceastea vor rula in infrastructuri gazduite</li> </ul> <p>Alte optiuni 'ad-hoc' (in sedinta)</p> <ul> <li>...</li> <li>...</li> <li>...</li> <li>...</li> <li>...</li> <li>...</li> </ul>"},{"location":"src/xl2roefact/doc_src/help/880.30-ADMA_catalog.html","title":"880.30 ADMA catalog","text":"<p> INVOICEtoROefact System (c) 2023, 2024 RENware Software Systems </p>"},{"location":"src/xl2roefact/doc_src/help/880.30-ADMA_catalog.html#catalogul-manualelor-de-configurare-si-administrare","title":"Catalogul manualelor de configurare si administrare","text":"<p>Cuprins:</p> <ul> <li>Catalogul manualelor de configurare si administrare</li> </ul> <ul> <li>...</li> </ul>"},{"location":"src/xl2roefact/doc_src/help/880.30-EUMA_catalog.html","title":"880.30 EUMA catalog","text":"<p> INVOICEtoROefact System (c) 2023 RENware Software Systems </p>"},{"location":"src/xl2roefact/doc_src/help/880.30-EUMA_catalog.html#catalogul-manualelor-de-utilizare","title":"Catalogul manualelor de utilizare","text":"<p>Cuprins:</p> <ul> <li>Catalogul manualelor de utilizare</li> </ul> <ul> <li>...</li> </ul>"},{"location":"src/xl2roefact/excel_invoice_template/index.html","title":"Index","text":"<p>Copyright (C) RENware Software Systems</p>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#invoice-template","title":"invoice template","text":"<ul> <li>invoice template<ul> <li>Instalarea sablonului de factura emisa</li> <li>Recomandari in utilizarea sablonului</li> <li>Descarcare (download) sablon factura<ul> <li>Arhiva versiuni publicate disponibile</li> </ul> </li> <li>License</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#instalarea-sablonului-de-factura-emisa","title":"Instalarea sablonului de factura emisa","text":"<p>Aceasta componenta consta dintr-un director (ce nu necesita instalare speciala ci simpla copiere locala acolo unde va fi utilizat). Acest director contine:</p> <ul> <li> <p>fisierul pentru factura <code>invoice_template_CU_tva.xlsx</code> ce este disponibil pentru descarcare aici</p> </li> <li> <p>directorul <code>released_packages/</code> ce contine versiuni anterioare de sablon ce sunt inca suportate</p> </li> <li> <p>prezentul document</p> </li> </ul>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#recomandari-in-utilizarea-sablonului","title":"Recomandari in utilizarea sablonului","text":"<p>Aceasta sectiune se refera la modul in care ar trebui \"tratat\" continutul fisierului Excel cu factura in conditiile in care se intentioneaza ca aceasta sa fi procesata ulterior cu sistemul <code>INVOICEtoROeFact</code>. Acest sablon este general valabil (este un fisier Excel ca oricare altul) deci in acest caz este important a \"constientiza\" faptul ca informatia aferenta facturii din Excel va fi cautata, identificata si gasita in scopul de a fi salvata in formatele de factura electronica (utilizarea acestui sablon de factura Excel impreuna cu sistemul <code>INVOICEtoROeFact</code> ESTE O VARIANTA DE LUCRU RECOMANDATA, dar nu obligatorie).</p> <p>Astfel se recomanda ca acest sablon sa fie utilizat asa cum este livrat, fara a efectua modificari majore in structura sa cum ar fi:</p> <ul> <li> <p>modificarea formatelor (de tip de date) celulelor in scopul unei afisari \"mai frumoase\"</p> </li> <li> <p>adaugarea de informatii prin concatenare de siruri de caractere sau orice alte metode de a altera continutul vizibil al celulelor in scopul unei afisari \"mai frumoase\"</p> </li> <li> <p>modificarea locatiilor celulelor prin inserarea sau stergerea de linii, coloane sau celule noi</p> </li> </ul> <p>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</p> <p> <p>DETALII TEHNICE:</p> <p>Continutul informational al facturii nu trebuie nici confundat si nici mixat cu formatul de afisare al acesteia (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere regulile de formatare din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p> <ul> <li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li> <li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li> </ul> <p></p>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#descarcare-download-sablon-factura","title":"Descarcare (download) sablon factura","text":"<ul> <li>office Excel XLSX 0.1.20</li> </ul>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#arhiva-versiuni-publicate-disponibile","title":"Arhiva versiuni publicate disponibile","text":"<p>NOTA: versiunile \"lipsa\" din lista de mai jos nu mai sunt disponibile sau sunt versiuni interne nepublicate.</p> <ul> <li>arhiva ZIP 0.1.20</li> <li>arhiva ZIP 0.1.11</li> </ul>"},{"location":"src/xl2roefact/excel_invoice_template/index.html#license","title":"License","text":""},{"location":"src/xl2roefact/setup_web_sys/INSTALL-CHROME-On_WSL.html","title":"Install Google Chrome on WSL","text":""},{"location":"src/xl2roefact/setup_web_sys/INSTALL-CHROME-On_WSL.html#download-and-install-chrome","title":"Download and install Chrome:","text":"<pre><code>wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb\nsudo apt -y install ./google-chrome-stable_current_amd64.deb\n\nrm ./google-chrome-stable_current_amd64.deb\n</code></pre>"},{"location":"src/xl2roefact/setup_web_sys/INSTALL-CHROME-On_WSL.html#check-that-its-installed-ok","title":"Check that it\u2019s installed ok:","text":"<pre><code>google-chrome --version\n</code></pre> <p>Running is done with <code>google-chrome</code> command. All X-Windows graphical elements should be installed (normally if WSL is up to date, these are already installed)</p>"},{"location":"src/xl2roefact/setup_web_sys/INSTALL_chrome_driver.html","title":"Setup Chrome Driver on WSL","text":""},{"location":"src/xl2roefact/setup_web_sys/INSTALL_chrome_driver.html#installing-chromedriver","title":"Installing ChromeDriver","text":"<p>Find the URL of the ChromeDriver version that matches your Chrome version on the ChromeDriver website. It should be a zip file; in my case it\u2019s</p> <p><code>wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/linux64/chrome-linux64.zip</code></p> <p>Download, unzip, and put it in your bin directory:</p> <pre><code>wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/linux64/chrome-linux64.zip\nunzip chrome-linux64.zip\ncd  chrome-linux64/\nsudo cp chrome /usr/bin/chromedriver\nsudo chown root:root /usr/bin/chromedriver\nsudo chmod +x /usr/bin/chromedriver\n</code></pre> <p>Double check it worked:</p> <p><code>chromedriver --version</code></p> <p>If was previously installed drivers, check version</p> <p><code>which chromedriver</code></p>"},{"location":"src/xl2roefact/web_dashb_app/README_web_dashb.html","title":"README web dashb","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/web_dashb_app/README_web_dashb.html#web_dashb-component","title":"WEB_DASHB component","text":"<p>Cuprins:</p> <ul> <li>WEB_DASHB component</li> </ul> <p>This component is presented in document `.../doc_src/...110-SRE-api_to_roefact_requirements.md``</p>"},{"location":"src/xl2roefact/xl2roefact/index.html","title":"Index","text":"<p>RENware Software Systems</p>"},{"location":"src/xl2roefact/xl2roefact/index.html#xl2roefact","title":"xl2roefact","text":"<p>Cuprins:</p> <ul> <li>xl2roefact<ul> <li>Facilitati</li> <li>Instalarea<ul> <li>Instalarea aplicatiei xl2roefact</li> </ul> </li> <li>Configurarea aplicatiei xl2roefact</li> <li>Comenzile aplicatiei<ul> <li>Lista comenzi principale</li> <li>Referinta deliata comenzi  <ul> <li>run<ul> <li>about</li> <li>settings</li> <li>xl2json</li> </ul> </li> </ul> </li> </ul> </li> <li>Practici si regului referitoare la continutul facturilor din Excel</li> <li>Tutorial utilizare aplicatie<ul> <li>Organizarea informatiei</li> <li>Exemplu de procesare a unei facturi</li> </ul> </li> <li>Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</li> <li>Descarcare (download) aplicatie xl2roefact CLI<ul> <li>Arhiva versiuni publicate disponibile</li> </ul> </li> <li>Date identificare</li> <li>License</li> <li>Note</li> </ul> </li> </ul> <p> </p>"},{"location":"src/xl2roefact/xl2roefact/index.html#facilitati","title":"Facilitati","text":"<p>Aceasta componenta este \"totul despre crearea de facturi electronice\" din formatul Excel office (xlsx). Aplicatia poate genera factura in format JSON, XML, PDF si o poate incarca in sistemul RO E-Fact1.</p> <p>Aceasta componenta ofera urmatoarele facilitati (acestea fiind obiectivele fundamentale ale componentei):</p> <ul> <li> <p>transformarea facturilor din Excel in formatul <code>XML</code> cerut de catre sistemul ANAF RO E-Fact pentru incarcare</p> </li> <li> <p>incarcarea acestora in sistemul ANAF RO E-Fact1</p> </li> <li> <p>transformarea facturilor din Excel intr-un format <code>JSON</code>  intermediar, independent de platforma si care permite integrarea acestora cu alte sisteme (standard REST)</p> </li> <li> <p>generarea facturii in format PDF pentru transmiterea acesteia catre client, semnarea electronica, tiparirea si arhivarea acesteia in format fizic (in general manipularea facturii in format \"human readable\")</p> </li> </ul> <p>Componenta ofera doua instrumente pentru realizarea si indeplinirea acestor obiective:</p> <ul> <li> <p><code>xl2roefact</code> o aplicatie de tip linie de comanda (disponibila pentru sistemele de operare Windows, Linux si MacOS)</p> </li> <li> <p><code>xl2roefact PyPi</code> o blioteca standard Python utilizabila pentru dezvoltari proprii in scopul extinderii altor sisteme existente (custom development)</p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#instalarea","title":"Instalarea","text":"<p>Instalarea este diferita pentru cele doua  componente:</p> <ul> <li>aplicatia de tip linie de comanda / consola (descrisa in continuare)</li> <li>biblioteca \u201cstandard Python package wheel\" (descrisa in al document, pe linkul afisat)</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#instalarea-aplicatiei-xl2roefact","title":"Instalarea aplicatiei xl2roefact","text":"<p>Pachetele de instalare se gasesc in directorul <code>dist/</code> ca arhive <code>ZIP</code>. Pachetele disponibile contin in numele lor versiunea de aplicatie utilizata si sistemul de operare pentru care sunt disponibile:</p> <ul> <li><code>MSI</code> pachet instalare pentru *Windows</li> <li><code>DEB</code> pachet instalare pentru Linux Debian (verificati disponibilitatea pentru varianta sistemuluu de operare folosit de dvs)</li> <li><code>EXE</code> executabil Windows in format \"portabil\" (un singur fisier)</li> <li>NOTA: pentru echivalent utilizare  portabila pentru Linux se va instala biblioteca Python (vezi sectiunea urmatoare) duoa care devine utilizabil scriptul Python \"ca orice alta comanda Linux\"</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#configurarea-aplicatiei-xl2roefact","title":"Configurarea aplicatiei xl2roefact","text":"<p>Parametrii de configurare a plicatiei se gasesc in fisierul <code>config_settings.py</code>. Acestia sunt sub elaborati in limbaj Python prin utilizarea conventiilor de constante conform recomandarilor PEP (numele capitatlizat) si sunt acompaniti de linii de explicatii privind aplicabilitatea lor.</p> <p>Configurare aplicatiei se poate face interactiv si din aplicatie. Pentru a obtine help referitor la detaliile comenzi se va folosi <pre><code>xl2roefact settings --help\n</code></pre></p>"},{"location":"src/xl2roefact/xl2roefact/index.html#comenzile-aplicatiei","title":"Comenzile aplicatiei","text":"<p>Interfata aplicatie este realizata utilizind conventiile si practicile uzuale pentru aplicatii tip linie de comanda consola. Pentru informatii privind comenzile se poate folosi optiunea de help, dispobilia atit la nivelul general: <pre><code>xl2roefact --help\n</code></pre> cit si la nivel detaliat pentru fiecare comanda <pre><code>xl2roefact [COMMAND] --help\n</code></pre></p>"},{"location":"src/xl2roefact/xl2roefact/index.html#lista-comenzi-principale","title":"Lista comenzi principale","text":"<ul> <li> <p>about - Afiseaza informatii despre aceatsa aplicatie (copyright, scop, etc)</p> </li> <li> <p>settings _ Afiseaza parametrii de configurare a aplicatiei. Vezi sectiunea de configurare a aplicatiei</p> </li> <li> <p>xl2json - Transforma fisierul (fisierele) Excel in forma JSON pentru utilizare ulterioara ca forma de date standardizat pentru schimbul de informatii cu alte sisteme electronice</p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#referinta-deliata-comenzi","title":"Referinta deliata comenzi","text":""},{"location":"src/xl2roefact/xl2roefact/index.html#run","title":"run","text":"<p>function called when no command is invoked and to provide only application version (for external users to test it!).</p> <p>Usage:</p> <pre><code>xl2roefact [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --version             show application version\n  --install-completion  Install completion for the current shell.\n  --show-completion     Show completion for the current shell, to copy it or\n                        customize the installation.\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/index.html#about","title":"about","text":"<p>provide a short application description.</p> <p>Usage:</p> <pre><code>xl2roefact about [OPTIONS]\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/index.html#settings","title":"settings","text":"<p>display application configuration parameters and settings that are subject to be changed by user.</p> <p>Args:     <code>rules</code>: show recommended rules to follow when change application configurable settings (available in both RO &amp; EN languages). Defaults to <code>False</code>.</p> <p>Usage:</p> <pre><code>xl2roefact settings [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -r, --rules  show settings recommended update rules\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/index.html#xl2json","title":"xl2json","text":"<p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p> <p>Args:     <code>file_name</code>: files to process (wildcards allowed).     <code>files_directory</code>: directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead     <code>verbose</code>: show detailed processing messages\". Defaults to <code>False</code>.</p> <p>Usage:</p> <pre><code>xl2roefact xl2json [OPTIONS] [FILE_NAME]\n</code></pre> <p>Options:</p> <pre><code>  [FILE_NAME]                     files to process (wildcards allowed)\n                                  [default: *.xlsx]\n  -d, --files-directory DIRECTORY\n                                  directory to be used to look for Excel files\n                                  (if default directory does not exists will\n                                  consider current directory instead).\n                                  [default: invoice_files/]\n  -v, --verbose                   show detailed processing messages\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/index.html#practici-si-regului-referitoare-la-continutul-facturilor-din-excel","title":"Practici si regului referitoare la continutul facturilor din Excel","text":"<p>Acest capitol se refera la modul in care este \"tratat\" continutul fisierului Excel cu factura, mai exact la modalitatea in care informatia facturii este cautata, identificata si gasita in scopul de a fi salvata in oricare din formatele de \"factura electronica / E-Fact\".</p> <p>Utilizarea sablonului de factura Excel ce este livrat impreuna cu aplicatia ESTE O VARIANTA DE LUCRU RECOMANDATA, dar nu obligatorie. Chiar si in cazul utilizarii acestuia, prin modificarea \"structurii\" acestuia, informatia poate ajunge nerecognoscibila / neidentificabila total sau partial daca nu sunt urmate regulile expuse.</p> <p>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</p> <p>Mai exact continutul informational al facturii nu trebuie nici confundat si nici mixat cu formatul de afisare al acesteia (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere regulile de formatare din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p> <ul> <li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li> <li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#tutorial-utilizare-aplicatie","title":"Tutorial utilizare aplicatie","text":""},{"location":"src/xl2roefact/xl2roefact/index.html#organizarea-informatiei","title":"Organizarea informatiei","text":"<p>Aplicatia xl2roefact \"promoveaza\" structurarea informatiei procesate astfel incit sa fie evitata situatia \"de aglomerare\" a directorului curent cu fisiere ce trebuiesc identificate si izolate in situatia in care se fac procesari in masa (pe mai multe fisiere / facturi sursa).</p> <p>Astfel, aplicatia se asteapa ca fisierele Excel sursa (adica facturile de procesat) sa fie copiate in directorul <code>invoice_files/</code> de unde vor fi citite si tot aici vor fi create fisierele rezultate (JSON, XML, etc). Acest director este relativ la directorul curent de unde este lansata aplicatia si considerat \"implicit\" cu acest nume dar daca se doreste un alt director acest lucru poate fi facut folosind parametrul <code>--files-directory</code> (sau prescurtat <code>-d</code>) la lansarea aplicatiei astfel: <pre><code>xl2roefact -d \"calea si numele directorului dorit\"\n</code></pre></p> <p>Nota</p> <p>Ghilimelele sunt necesare numai daca numele si calea (<code>path</code>) contin caracterul spatiu.</p> <p>Exemple:</p> <ul> <li> <p>pentru stabilirea directorului curent ca sursa pentru fisierele factura Excel: <code>xl2roefact -d ./</code></p> </li> <li> <p>procesarea tuturor facturilor facturilor din luna iunie, copiate intr-un director dedicat sub directorul curent: <code>xl2roefact -d ./facturi_iunie/</code></p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#exemplu-de-procesare-a-unei-facturi","title":"Exemplu de procesare a unei facturi","text":"<ul> <li>se creaza directorul <code>invoice_files</code></li> <li>se copiaza factura <code>factura_A.xlsx</code> in acest director apoi se revine in directorul anterior daca acesta a fost schimbat pentru efectuarea copierii</li> <li>se lanseaza aplicatia: <code>xl2roefact xl2json</code></li> </ul> <p>In urma acestor operatii, in directorul <code>invoice_files</code> vor rezulta:</p> <pre><code>\ud83d\udcc1 invoice_files/\n\u251c\u2500\u2500 \ud83d\udcc4 factura_A.xlsx  # fisierul Excel original\n\u2514\u2500\u2500 \ud83d\udcc4 factura_A.json  # fisierul JSON rezultat in urma procesarii\n</code></pre> <ul> <li><code>factura_A.xlsx</code> ca fiind fisierul Excel original cu factura</li> <li><code>factura_A.json</code> acesta fiind fisierul format JSON rezultat in urma procesarii si ce poate fi folosit pentru interschimbarea electronica a informatiei intre sisteme</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii","title":"Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii","text":"<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Formatul JSON utilizat contine:</p> <ul> <li>informatiile aferente facturii (cheie: <code>Invoice</code>)</li> <li>o harta de ajutor in conversia formatului JSON in formatul XML acceptat de sistemul RO E-Fact (cheie <code>meta_info.map_JSONkeys_XMLtags</code>) si definititiile XML aferente (cheie <code>meta_info.invoice_XML_schemes</code>)</li> <li>alte informatii despre fisierul Excel prelucrat (alte chei din <code>meta_info</code>)</li> <li>datele preluate din formatul original Excel (cheie <code>excel_original_data</code>) - acestea sunt utile pentru depanare in caz ca aceasta este necesara in cazul specific al fisierului Excel folosit de dvs</li> </ul> <p>Structura de baza a acestui fisier este:</p> <pre><code>{\n    \"Invoice\": {...},\n    \"meta_info\": {...},\n    \"excel_original_data\": {...}\n}\n</code></pre> <p>Cheile de la primul nivel contin:</p> <ul> <li><code>Invoice</code> - datele efective ale facturii</li> <li><code>meta_info</code> - informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul RO E-Fact</li> <li><code>excel_original_data</code> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru \"a intelege\" de unde si cum arata informatiile originale din fisierul Excel</li> </ul> <p>Pentru detalii suplimentare despre formatul JSON trebyie consultata componenta referitaoer la biblioteca <code>xl2roefact</code> destinata dezvoltarii software.</p>"},{"location":"src/xl2roefact/xl2roefact/index.html#descarcare-download-aplicatie-xl2roefact-cli","title":"Descarcare (download) aplicatie xl2roefact CLI","text":"<ul> <li>0.1.20.dev invoice customer address MSI installer win64</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#arhiva-versiuni-publicate-disponibile","title":"Arhiva versiuni publicate disponibile","text":"<ul> <li> <p>0.1.19.dev invoice customer and partial invoice total values calculations MSI installer win64</p> </li> <li> <p>0.1.18.dev invoice customer CUI partial invoice total values calculations MSI installer win64</p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#date-identificare","title":"Date identificare","text":"<ul> <li>part number (p/n): <code>0000-0095-xl2roefact</code></li> <li>producator si copyright: RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/index.html#license","title":"License","text":""},{"location":"src/xl2roefact/xl2roefact/index.html#note","title":"Note","text":"<ol> <li> <p>Toate interactiunile cu sistemul ANAF RO E-Fact necesita o conexiune la internet si un set de credentiale ANAF RO E-Fact ale companiei pentru care se incarca factura. In lipsa acestora, fisierul <code>XML</code> generat de aplicatie poate fi incarcat ulterior (de ex de catre departmentul contabilitate)\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"src/xl2roefact/xl2roefact/TODO_packaging.html","title":"TODOs to make <code>xl2roefact</code> package","text":"<ul> <li>TBD... mk dir ./xl2roefact/` as library shell ...<ul> <li>OBIECTIV to mk <code>xl2roefact</code> package - KEEP IN MIND that CLI app MUST be deployed separatelyy anyway (pentru PFA-uri, sigur instaleaza MSI-ul si trebuie sa aiba toate directoarele acolo, dar trebuie sa fie si separat, deci MSIul si dist/ ramin)</li> <li> DONE@231214piu_a MOVE_in: <code>./invoice_files/.gitkeep</code>, './excel_invoice_template/*<code>,</code>./doc/MANPAGE_xl2roefact.txt<code>--&gt; FROM NOW, library is 99% active (not published @ 231214) and can be used as part of whole</code>xl2roefact` system including CLI app</li> <li> pay attn main <code>README...</code></li> <li> write \"invoice filling rules\" (these are in <code>config_settings.py</code>) ==&gt; make a dedicated section in <code>./docs/</code></li> </ul> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/_curs_share_experience.html","title":"Clubul CALCULATOARUL UN PRIETEN LA JOB","text":"<p>Acest club se adreseaza celor interesati de domeniul IT si \"lumea calculatoarelor\" din diverse motive si ratiuni ce nu se exclud;</p> <ul> <li>face parte din viata lor profesionala, \"jobul\" lor este strins legat de asta</li> <li>este un hobby, o pasiune</li> <li>din curiozitate si vor sa afle mai multe despre 'dedesubturile\" acestora dar si despre activitatile conexe lor, cum ar fi project managementul in lumea IT, proiectarea arhitecturilor, ingineria sistemelor software</li> <li>inteleg / stiu / au auzit ca aceasta \"lume\" a calculatoarelor este un amalgam de \"hardware, software, networking, security\" si vir sa Inteleaga mai practic si concret ce inseamna acestea</li> <li>vor sa Inteleaga lucrurile fara a fi tratate cu formalism excesiv, cu multa teorie \"seaca\" ce uneori pare inutila si de neinteles la ce va folosi - vor sa Inteleaga aceasta lume in mod intuitiv adica \"stiu ca stiu\" si \"inteleg pentru ca inteleg\" chiar daca poate \"nu stiu sa iti demonstrez matematic si fizic\" ;) == ACEASTA INSEAMNA CUNOASTERE INTUITIVA</li> <li>... #TODO more ?</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/_curs_share_experience.html#de-ce-acest-eveniment","title":"De ce acest eveniment","text":"<p>In primul rind vreau sa mentionez ca acesta nu este un curs. Nu in acceptiunea clasic incetatenita a ceea ce numim curs.</p> <p>El nu isi propune sa va invete ceva in modul formal clasic de tip teorie predata combinata cu practica. Va luati notite, va pregatiti de un examen. Il sustineti, il luati si aveti o diploma.</p> <p>Nu. Nu asa, dar tot asa :) Numai ca nu luati o diploma ci invatati sa va extindeti mintea, sa o folositi constient si nu mecanic. Iar in ceea ce priveste examinarea, aceasta o veti sustine singuri, in viata de zi cu zi. La acel auto-examen pe care il dam in fiecare clipa si tot noi ne evaluam prin ceea ce credem despre noi. Iar viata ne da feedback-ul final despre ceea ce facem, spunem si gindim...</p> <p>Pe parcursul carierei mele profesionale am impartasi experienta acumulata cu foarte multi oameni, atit subalterni cit si sefi. Am impartasit-o din punctul de vedere (de referinta !) pentru ca fiecare a luat-o (primit-o !) asa cum a crezut de cuviinta si a considerat+o in consecinta.</p> <p>Ea ramine exact si nimic altceva decit ce a fost, indiferent de ce crede fiecare, o experienta impartasita si atit. O informatie care a existat si continua sa existe in mintea mea si a altor oameni ca parte a universului in care existam.</p>"},{"location":"src/xl2roefact/xl2roefact/_curs_share_experience.html#ce-teme-isi-propune-acest-curs","title":"Ce teme isi propune acest curs","text":"<p>Subiectele de baza ale acestui curs sunt \"din lumea computerelor si a informaticii\" asa cum este ea cunoscuta acum. ...</p>"},{"location":"src/xl2roefact/xl2roefact/_curs_share_experience.html#cine-sunt-eu","title":"Cine sunt eu","text":"<p>...</p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html","title":"Table of Contents","text":"<ul> <li>app_cli</li> <li>about</li> <li>settings</li> <li>xl2json</li> <li>called_when_no_command</li> <li>chkisld</li> <li>chkxml</li> <li>config_settings</li> <li>DEFAULT_SUPPLIER_COUNTRY</li> <li>ldxml</li> <li>libutils</li> <li>isnumber</li> <li>find_str_in_list</li> <li>rdinv</li> <li>rdinv</li> <li>get_excel_data_at_label</li> <li>mk_kv_invoice_items_area</li> <li>get_invoice_items_area</li> <li>wrxml</li> <li>__init__</li> <li>__main__</li> <li>__version__</li> <li>__version__</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#app_cli","title":"app_cli","text":"<p>app_cli: the command line application for all xl2roefact functionalities.</p> <p>Identification: * code-name: <code>xl2roefact</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Deployments: * Windows:  MSI installer with EXE application. * Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</p> <p>Specifications: * command general format: <code>xl2roefact [file(s)-to-convert] COMMAND [OPTIONS]</code>. * help: <code>xl2roefact [COMMAND] --help</code>.</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#about","title":"about","text":"<pre><code>@app_cli.command()\ndef about()\n</code></pre> <p>provide a short application description.</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#settings","title":"settings","text":"<pre><code>@app_cli.command()\ndef settings()\n</code></pre> <p>display application configuration parameters and settings that are subject to be changed by user.</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#xl2json","title":"xl2json","text":"<pre><code>@app_cli.command()\ndef xl2json(\n    file_name: Annotated[\n        str, typer.Argument(\n            help=\"files to process (wildcards allowed)\")] = \"*.xlsx\",\n    files_directory: Annotated[\n        Path,\n        typer.Option(\n            \"--files-directory\",\n            \"-d\",\n            exists=False,\n            file_okay=False,\n            dir_okay=True,\n            writable=True,\n            readable=True,\n            resolve_path=True,\n            help=\n            \"directory to be used to look for Excel files (if default directory does not exists will consider current directory instead).\"\n        ),\n    ] = \"invoice_files/\",\n    verbose: Annotated[\n        bool,\n        typer.\n        Option(\"--verbose\", \"-v\", help=\"show detailed processing messages\"),\n    ] = False)\n</code></pre> <p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p> <p>Arguments:</p> <ul> <li><code>file_name</code> - files to process (wildcards allowed).</li> <li><code>files_directory</code> - directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead</li> <li><code>verbose</code> - show detailed processing messages\" Defaults to <code>False</code>.</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#called_when_no_command","title":"called_when_no_command","text":"<pre><code>@app_cli.callback(invoke_without_command=True)\ndef called_when_no_command(\n    ctx: typer.Context,\n    version: Annotated[\n        bool,\n        typer.Option(\"--version\", help=\"show application version\"),\n    ] = False)\n</code></pre> <p>function called when no command is invoked and to provide only application version (for external users to test it!).</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#chkisld","title":"chkisld","text":"<p>chkisld: modul de verificare a starii de incarcare a unei facturi emise</p> <p>Identification: * code-name: <code>chkisld</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Specifications: * document: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code> * INTRARI: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii * IESIRI: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#chkxml","title":"chkxml","text":"<p>chkxml: modul de validare a facturii in sistemul ANAF E-Factura</p> <p>Identification: * code-name: <code>chkxml</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Specifications: * document: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code> * INTRARI: fisier <code>f-XML</code> * IESIRI: raport cu eventualele erori de validare</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#config_settings","title":"config_settings","text":"<p>Application configuration and setting parameters.  <code>TODO</code> all of these are subject to documentation update (sectiune \"RULES FOR INVOICE data in Excel\")</p> <p>NOTE english \"README_me\" before making changes: * each parameter has a short help (lines starting with <code>#</code> character) - read it before changing that parameter * do not change parametrs name as specified before equal (<code>=</code>) sign * lists are enclosed in sqaured brackets (<code>[...]</code>) and items are separated by comma character (<code>,</code>) * strings are enclosed in <code>\"</code> characters * if you want to clear a list (for example you do not wants any options inside) just let it as <code>&lt;PARAMETR NAME&gt; = []</code> - do not drop that parameter * do not add supplementary parameters, they will not be used without software changes (also risk to induce potential errors) * for calendaristic dates Excel cells use <code>date</code> format and change it as display option to show wanted format</p> <p>NOTE romana \"README_me\" inainte de a face modificari:  <code>TODO</code> all of these are subject to documentation update (sectiune \"RULES FOR INVOICE data in Excel\") * fiecare parametru are un hep scurt (liniile ce incep cu caracterul <code>#</code>) - citi-l inainte de a modofica uun parametru * nu schimbati numele parametrilor asa cum este el specificat inainte de semnul egal (<code>=</code>) * listele sunt incluse intre paranteze drepte (<code>[...]</code>) si elementele lor sunt separate prin caracterul virgula (<code>,</code>) * sirurile de caractere sunt incluse intre ghilimele (caracterul <code>\"</code>) * daca doriti stergerea unei listei (de ex daca nu doriti nici o optiune pentru acea lista) doar lasati acel parametru cu valoarea <code>[]</code> - nu stergeti in nici un caz acel parametru * nu adaugati parametrii suplimentari (altii decit cei specificati aici), acestia nu vor fi utilizati fara a modifica aplicatia (de asemenea riscati sa induceti erori in cod) * pentru datele calendaristice in celulul Excel a se utiliza formatul standard de data (<code>date</code>) si modificati formatul de afisare in formatul dorit pe factura tiparibila</p> <p>Identification: * code-name: <code>config_settings</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#default_supplier_country","title":"DEFAULT_SUPPLIER_COUNTRY","text":"<p>NOTE: \"pattern-uri\" (sabloane) de identificare si regasire a datelor folositi de</p> <p>__  comanda <code>xl2json</code> reprezentind functionalitatea de extragere a datelor din Excel si exportul lor in formatul JSON (modulul `rdinv)__</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#ldxml","title":"ldxml","text":"<p>ldxml: modul de incarcare a facturii in sistemul ANAF E-Factura</p> <p>Identification: * code-name: <code>ldxml</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Specifications: * document: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code> * INTRARI: fisier <code>f-XML</code> * IESIRI: raport cu validarea si identificatorul incarcarii</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#libutils","title":"libutils","text":"<p>libutils: general utilities library.</p> <p>Identification: * code-name: <code>libutils</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Components: * <code>isnumber(a_string: str) -&gt; bool</code>     Test a string if it could be used as number (int or float) * <code>find_str_in_list(list_of_str_to_find: list, list_to_search: list) -&gt; int</code>     Search more strings (ie, a list) in list of strings</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#isnumber","title":"isnumber","text":"<pre><code>def isnumber(a_string: str) -&gt; bool\n</code></pre> <p>test if a string is valid as any kind of number.</p> <p>Arguments:</p> <ul> <li><code>a_string</code> - input string.</li> </ul> <p>Returns:</p> <ul> <li><code>True</code> - if input string is valid as any kind of number, orherwise <code>False</code>.</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#find_str_in_list","title":"find_str_in_list","text":"<pre><code>def find_str_in_list(list_of_str_to_find: list, list_to_search: list) -&gt; int\n</code></pre> <p>find a substring from <code>list_of_str_to_find</code> in elements of <code>list_to_search</code>.</p> <p>Arguments:</p> <ul> <li><code>list_of_str_to_find</code> - list of strings to search for.</li> <li><code>list_to_search</code> - liste where to search for substrings.</li> </ul> <p>Returns:</p> <ul> <li><code>index</code> - the index of list item which contains <code>str_to_find</code> (first found) or <code>None</code> if not found.</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#rdinv","title":"rdinv","text":"<p>rdinv: modul de procesare a fisierului Excel ce contine factura si colectare a datelor aferente.</p> <p>Formatul acceptat fisier Excel este <code>XLSX</code>.</p> <p>Identification: * code-name: <code>rdinv</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Specifications: * document: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code> * INTRARI: fisier format XLSX ce contine factura emisa (cod: <code>f-XLSX</code>) * IESIRI: fisier format JSON imagine a datelor facturii (cod: <code>f-JSON</code>)</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#rdinv_1","title":"rdinv","text":"<pre><code>def rdinv(file_to_process: str,\n          invoice_worksheet_name: str = None,\n          *,\n          debug_info: bool = False) -&gt; dict\n</code></pre> <p>read Excel file for invoice data.</p> <p>Produce a dictionary structure + JSON file with all data regarding read invoice: canonical KV data, meta data, map to convert to XML and original Excel data.</p> <p>Arguments:</p> <ul> <li><code>file_to_process</code> - the invoice file (exact file with path).</li> <li><code>invoice_worksheet_name</code> - the worksheet containing invoice, optional, defaults to first found worksheet.</li> <li><code>debug_info</code> - key only, show debugging information, default <code>False</code>.</li> </ul> <p>Returns:</p> <ul> <li><code>dict</code> - the invoice extracted information from Excel file as <code>dict(Invoice: dict, meta_info: dict, excel_original_data: dict)</code> <code>TODO</code> subject of documentation update.</li> </ul> <p>NOTE ref important variables:   * <code>db: pylightxl object</code>: EXCEL object with invoice (as a whole)   * <code>ws: pylightxl object</code>: WORKSHEET object with invoice</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#get_excel_data_at_label","title":"get_excel_data_at_label","text":"<pre><code>def get_excel_data_at_label(pattern_to_search_for: list[str],\n                            worksheet: xl.Database.ws,\n                            area_to_scan: list[list[int]] = None,\n                            targeted_type: Callable = str,\n                            down_search_try: bool = True) -&gt; dict\n</code></pre> <p>get \"one key Excel values\", like invoice number or invoice issue date.</p> <p>Arguments:</p> <ul> <li><code>pattern_to_search_for</code> - for example for inv number, will pass the <code>PATTERN_FOR_INVOICE_NUMBER_LABEL</code>.</li> <li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li> <li><code>area_to_scan</code> - area of cells to be searched, default whole worksheet.</li> <li><code>targeted_type</code> - what type expect (will try to convert to, if cannot will return str), default <code>str</code>.</li> <li><code>down_search_try</code> - establish if DOWN search method is tried, default <code>True</code>.</li> </ul> <p>Returns:</p> <p><code>None</code> if not found OR <code>dictionary</code> containing:   * <code>\"value\": int | float | str</code> - the value found covenrted to requested <code>targeted_type</code> if possible or <code>str</code> otherwise; if \"out of space\" then returns <code>None</code>   * <code>\"location\": (row, col)</code> - adrees of cell where found value</p> <p>Notes:</p> <ul> <li>normal scan order is 1.RIGHT, 2.DOWN (if allowed), 3.IN-LABEL only in given area and pattern.</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#mk_kv_invoice_items_area","title":"mk_kv_invoice_items_area","text":"<pre><code>def mk_kv_invoice_items_area(invoice_items_area_xl_format)\n</code></pre> <p>transform <code>invoice_items_area</code> in \"canonical JSON format\" (as kv pairs).</p> <p>Arguments:</p> <ul> <li><code>invoice_items_area_xl_format</code> - invoice items area in Excel format (ie, DataFrame with row, col, data).</li> </ul> <p>Returns:</p> <ul> <li><code>invoice_items_area_xl_format</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li> </ul> <p>Notes:</p> <ul> <li>for ROefact XML model (&amp; plan) see <code>invoice_files/__model_test_factura_generat_anaf.xml</code>.</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#get_invoice_items_area","title":"get_invoice_items_area","text":"<pre><code>def get_invoice_items_area(worksheet, invoice_items_area_marker, wks_name)\n</code></pre> <p>get invoice for <code>invoice_items_area</code>, process it and return its Excel format.</p> <p>Process steps &amp; notes: * find invoice items subtable. * clean invoice items subtable. * extract relevenat data. * NOTE: all Excel cell addresses are in <code>(row, col)</code> format (ie, Not Excel format like \"A:26, C:42, ...\")</p> <p>Arguments:</p> <ul> <li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li> <li><code>invoice_items_area_marker</code> - string with exact marker of invoice items table.</li> <li><code>NOTE</code> - this is the UPPER-LEFT corner and is determined before calling this procedure.</li> <li><code>wks_name</code> - the wroksheet name (string) of the <code>worksheet</code> object.</li> </ul> <p>Returns:</p> <ul> <li><code>invoice_items_area</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li> </ul> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#wrxml","title":"wrxml","text":"<p>wrxml: modul de generare a fisierului format XML</p> <p>Identification: * code-name: <code>wrxml</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Specifications: * document: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code> * INTRARI: fisier <code>f-JSON</code> * IESIRI: fisier format XML conform cerintelor si sistemului ANAF E-Factura (cod: <code>f-XML</code>)</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__init__","title":"__init__","text":""},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__main__","title":"__main__","text":"<p>xl2roefact.main: Python package standard file to assure run as <code>python -m xl2roefact</code>.</p> <p>Identification: * code-name: <code>__main__</code> * copyright: (c) 2023 RENWare Software Systems * author: Petre Iordanescu (petre.iordanescu@gmail.com)</p> <p>Deployments: * Windows:  MSI installer with EXE application. * Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</p> <p>Specifications: * command general format: <code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code>. * help: <code>python -m xl2roefact --help</code>.</p> <p></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__version__","title":"__version__","text":""},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_1","title":"## ####              ########","text":"<p>__ ##  # #  #              #      # ##    #<code>__</code></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_2","title":"## #  #              ###  ### #  ##","text":"<p>##  ##  #  #                #  #   #  ##  #</p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_3","title":"## #  #                #  #   #  ##","text":"<p>__ ##  # #  #####            #  #   #  ##  <code>__</code></p> <p>__ ##  # #      #            #  #   ##    #<code>__</code></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_4","title":"## ########            ####","text":"<pre><code>                       ######## ########  ######   ######  ########\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_5","title":"#   ######           #      # #     #  ##    ## ##    ## #","text":"<p>__    ## ##    ## #######  #  ##### #  ####  #  ##  # #  ##  # ###  ##<code>__</code></p> <p>__ ##  # #  ##  # #     #  #    #   #    #   #      # #  #####   #  <code>__</code></p> <p>__ ##### #  ##  # #######  #  ###   #  ###   #  ##  # #  #####   #  <code>__</code></p> <p>__ # #   #  ##  #          #  ##### #  #     #  ##  # #  ##  #   #  <code>__</code></p> <p>__ #  #  ##    ##          #      # #  #     #  ##  # ##    ##   #  <code>__</code></p>"},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#_6","title":"#  ######           ######## ####     ########  ######","text":""},{"location":"src/xl2roefact/xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__version___1","title":"__version__","text":"<p>xl2roefact package version</p>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html","title":"README xl2roefact library","text":""},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#xl2roefact-pypi-library","title":"xl2roefact PyPi Library","text":"<ul> <li>xl2roefact PyPi Library<ul> <li>System modules<ul> <li>rdinv module logic</li> </ul> </li> <li>Install library<ul> <li>Install from PyPi</li> <li>Install from distribution packages</li> </ul> </li> <li>Working directories</li> <li>Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</li> <li>Detailed design technical documentation</li> <li>Download xl2roefact library<ul> <li>Arhiva versiuni publicate disponibile</li> </ul> </li> </ul> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#system-modules","title":"System modules","text":"<p><code>xl2roefact</code> main and basic modules are:</p> <ul> <li><code>rdinv</code> read an Excel file and extract invoice data to a JSON file format</li> <li><code>wrxml</code>  write, convert the JSON invoice file to a XML file format, respecting schemes required by RO EFact standard</li> <li><code>chkxml</code> check generated XML file</li> <li><code>ldxml</code> load an invoice (ie, its XML associated file) to ANAF SPV system</li> <li><code>chkisld</code> check if an invoice is already loaded in ANAF SPV system</li> <li><code>config_settings</code> define system settings &amp; parameters mainly used in invoice info / data detection and extract from invoice Excel format file</li> <li><code>app_cli</code> contains the code for <code>xl2roefact</code> application command line (CLI) format</li> </ul> <p>Below is presented the skeleton logic of those modules which and where is relevant ie meaning where is not enough obvious from code or code complexity exceed usual limits (for example nore than 100 lines of code per function). For more technical details and specification regarding modules see 810.05a-xl2roefact_DLD_specs.md file</p>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#rdinv-module-logic","title":"rdinv module logic","text":"<p>Main function of <code>rdinv</code> module is <code>rdinv(...)</code> which has the following logic sections which are in strict sequence in presented order:</p> <ul> <li> <p>search of <code>invoice_items_area</code> sub-table. This area is expected to contain invoice lines and is \"processed\" first because it is more structured and easier to identify; after its identification the header area is considered upper of it and footer area below it</p> </li> <li> <p>solve <code>invoice_items_area</code> in 2 step.... In this step the code-data-variables of items area will be initialized in order to hold information that will be found</p> </li> <li> <p>localize and mark areas for... section that follows natural the previous one by initializing code-data-variables forcheader and footer areas to hold their corresponding information</p> </li> <li> <p>solve <code>invoice_header_area</code> detailed initialize of header area code-data-variables</p> </li> <li> <p><code>ReNaSt</code>-RegNameStrategy section that identify and extract the legal registered name of invoice customer</p> </li> <li> <p>section to ( Excel data )---&gt;( JSON ) format preparation and finishing section which prepare Excel original data found to be be saved as JSON as a more \"electronic interchangeable\" structure</p> </li> <li> <p>for more details about code logic description and presentation, please contact RENware Software Systems</p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#install-library","title":"Install library","text":"<p>Library can be installed using 2 methods:</p> <ul> <li>install from PyPi</li> <li>install from distribution packages</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#install-from-pypi","title":"Install from PyPi","text":"<p>The library installation should be done using standard Python instruments:</p> <pre><code>pip install xl2roefact\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#install-from-distribution-packages","title":"Install from distribution packages","text":"<p>To install from distribution packages first download the package version intended to install (see download section), choose the package type (if you have no special option, then choose <code>WHEEL</code> format) and install it using <code>pip</code> as any other Python library installation (detailed in Python official documentation).</p>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#working-directories","title":"Working directories","text":"<p>Below is a short description of most important directories that will (can !) be found on local development environment.</p> <ul> <li> <p><code>invoice_files/</code> default directory for Excel files which is intended to be processed</p> </li> <li> <p><code>build/</code> this directory which will contain intermediary files resulted from building CLI application, library distribution parts, etc. Directory is subject of <code>.gitignore</code></p> </li> <li> <p><code>dist/</code> package files (wheels, dist), Windows executables, etc, generally all files subject of \"public\" distribution and download</p> </li> <li> <p><code>test_*/</code> contains test invoice samples (from client, a RENware one, a 3rd party one) and some useful specs in dev &amp; test process</p> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii","title":"Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii","text":"<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Structura de baza a acestui fisier este:</p> <pre><code>{\n    \"Invoice\": {...},\n    \"meta_info\": {...},\n    \"excel_original_data\": {...}\n}\n</code></pre> <p>Cheile de la primul nivel contin:</p> <ul> <li><code>Invoice</code> - datele efective ale facturii</li> <li><code>meta_info</code> - informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul RO E-Fact</li> <li><code>excel_original_data</code> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru \"a intelege\" de unde si cum arata informatiile originale din fisierul Excel</li> </ul> <p>An example of JSON generated file is available here</p>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#detailed-design-technical-documentation","title":"Detailed design technical documentation","text":""},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#download-xl2roefact-library","title":"Download xl2roefact library","text":"<ul> <li>0.1.20.dev invoice customer address WHEEL</li> <li>0.1.20.dev invoice customer address DIST</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/README_xl2roefact_library.html#arhiva-versiuni-publicate-disponibile","title":"Arhiva versiuni publicate disponibile","text":"<ul> <li>0.1.19.dev invoice customer and partial invoice total values calculations WHEEL</li> <li> <p>0.1.19.dev invoice customer and partial invoice total values calculations DIST</p> </li> <li> <p>0.1.18.dev invoice customer CUI partial invoice total values calculations WHEEL</p> </li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations DIST</li> </ul>"},{"location":"src/xl2roefact/xl2roefact/doc/invoice_json_model_.html","title":"Generated invoice JSON model","text":"<p>NOTE: The following model should be considered ONLY for JSON keys. All data is just sample / not real just for a better understanding of its format (or \"how it looks like\").</p> <pre><code>{\n    \"Invoice\": {\n        \"cbc_ID\": \"INV-001\",\n        \"cbc_DocumentCurrencyCode\": \"RON\",\n        \"cbc_IssueDate\": \"2023-08-28\",\n        \"cac_AccountingCustomerParty\": {\n            \"cac:Party\": {\n                \"cac_PartyLegalEntity\": {\n                    \"cbc_CompanyID\": \"17753763\",\n                    \"cbc_RegistrationName\": \"SOME COMPANY SRL\"\n                },\n                \"cac_PostalAddress\": {\n                    \"cbc_StreetName\": \"\",\n                    \"cbc_CityName\": \"Bucure\u015fti Sectorul 1, Strada: Rozelor, Nr. 21, Etaj parter, tara: Romania\",\n                    \"cbc_PostalZone\": \"5555544\",\n                    \"cac_Country\": {\n                        \"cbc_IdentificationCode\": \"RO\"\n                    }\n                }\n            }\n        },\n        \"cac_InvoiceLine\": [\n            {\n                \"cbc_ID\": \"1\",\n                \"cbc_InvoicedQuantity\": 3.5,\n                \"cbc_unitCode\": \"buc\",\n                \"cac_Item\": {\n                    \"cbc_Name\": \"Product x name here\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": 0.19,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": \"VAT\"\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": 11111.5,\n                    \"cbc_currencyID\": \"RON\"\n                },\n                \"cbc_LineExtensionAmount\": 38890.25,\n                \"LineVatAmount\": 7389.1475\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-a\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"just some supplementary explanations ref first product...\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-b\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"another explanations line...\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-c\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"'*** a comment ref price xchg rate 3000EUR ref BNR\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"2\",\n                \"cbc_InvoicedQuantity\": 1,\n                \"cbc_unitCode\": \"\",\n                \"cac_Item\": {\n                    \"cbc_Name\": \"Acciza 1%\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": 111.115,\n                    \"cbc_currencyID\": \"RON\"\n                },\n                \"cbc_LineExtensionAmount\": 111.11,\n                \"LineVatAmount\": 0.0\n            }\n        ]\n    },\n    \"meta_info\": {\n        \"file\": \"invoice_json_model_.xlsx\",\n        \"file_CRC\": \"...file CRC (uniquely identify the invoice file used)\",\n        \"last_processing_time\": \"2021-01-23T07:39:30.115329+00:00\",\n        \"invoice_worksheet\": \"FACTURA\",\n        \"invoice_max_rows\": 31,\n        \"invoice_max_cols\": 9,\n        \"items_table_start_marker\": \"#\",\n        \"items_table_start_cell\": [\n            20,\n            1\n        ],\n        \"invoice_XML_schemes\": {\n            \"xmlns\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2\",\n            \"xmlns:cbc\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2\",\n            \"xmlns:cac\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2\",\n            \"xmlns:ns4\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2\",\n            \"xmlns:xsi\": \"http://www.w3.org/2001/XMLSchema-instance\",\n            \"xsi:schemaLocation\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd\"\n        },\n        \"map_JSONkeys_XMLtags\": [\n            [\n                \"cac_InvoiceLine\",\n                \"cac:InvoiceLine\"\n            ],\n            [\n                \"cac_Item\",\n                \"cac:Item\"\n            ],\n            [\n                \"cac_ClassifiedTaxCategory\",\n                \"cac:ClassifiedTaxCategory\"\n            ],\n            [\n                \"cac_TaxScheme\",\n                \"cac:TaxScheme\"\n            ],\n            [\n                \"cac_Price\",\n                \"cac:Price\"\n            ],\n            [\n                \"cbc_ID\",\n                \"cbc:ID\"\n            ],\n            [\n                \"cbc_InvoicedQuantity\",\n                \"cbc:InvoicedQuantity\"\n            ],\n            [\n                \"cbc_unitCode\",\n                \"cbc:unitCode\"\n            ],\n            [\n                \"cbc_Name\",\n                \"cbc:Name\"\n            ],\n            [\n                \"cbc_Percent\",\n                \"cbc:Percent\"\n            ],\n            [\n                \"cbc_PriceAmount\",\n                \"cbc:PriceAmount\"\n            ],\n            [\n                \"cbc_currencyID\",\n                \"cbc:currencyID\"\n            ],\n            [\n                \"cbc_LineExtensionAmount\",\n                \"cbc:LineExtensionAmount\"\n            ],\n            [\n                \"cbc_ID\",\n                \"cbc:ID\"\n            ],\n            [\n                \"cbc_DocumentCurrencyCode\",\n                \"cbc:DocumentCurrencyCode\"\n            ],\n            [\n                \"cbc_IssueDate\",\n                \"cbc:IssueDate\"\n            ],\n            [\n                \"cac_AccountingCustomerParty\",\n                \"cac:AccountingCustomerParty\"\n            ],\n            [\n                \"cac_Party\",\n                \"cac:Party\"\n            ],\n            [\n                \"cac_PartyLegalEntity\",\n                \"cac:PartyLegalEntity\"\n            ],\n            [\n                \"cbc_CompanyID\",\n                \"cbc:CompanyID\"\n            ],\n            [\n                \"cbc_RegistrationName\",\n                \"cbc:RegistrationName\"\n            ],\n            [\n                \"cac_PostalAddress\",\n                \"cac:PostalAddress\"\n            ],\n            [\n                \"cbc_StreetName\",\n                \"cbc:StreetName\"\n            ],\n            [\n                \"cbc_CityName\",\n                \"cbc:CityName\"\n            ],\n            [\n                \"cbc_PostalZone\",\n                \"cbc:PostalZone\"\n            ],\n            [\n                \"cac_Country\",\n                \"cac:Country\"\n            ],\n            [\n                \"cbc_IdentificationCode\",\n                \"cbc:IdentificationCode\"\n            ]\n        ]\n    },\n    \"excel_original_data\": {\n        \"invoice_items_area\": {\n            \"keyrows\": [\n                1,\n                \"1.NOTE-a\",\n                \"1.NOTE-b\",\n                \"1.NOTE-c\",\n                2\n            ],\n            \"keycols\": [\n                \"Denumire produse sau servicii\",\n                \"UM\",\n                \"Cant\",\n                \"Pret unitar\",\n                \"Valoare fara TVA\",\n                \"Cota TVA\",\n                \"Valoare TVA\"\n            ],\n            \"data\": [\n                [\n                    \"...excel data...\",\n                    \"buc\",\n                    3.5,\n                    11111.5,\n                    38890.25,\n                    0.19,\n                    7389.15\n                ],\n                [\n                    \"...excel data...\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    ...excel data...\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    \"'*** a comment ref price xchg rate 3000EUR ref BNR\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    \"Acciza 1%\",\n                    \"\",\n                    1,\n                    111.115,\n                    111.12,\n                    \"\",\n                    0\n                ]\n            ]\n        },\n        \"invoice_header_area\": {\n            \"start_cell\": [\n                1,\n                1\n            ],\n            \"end_cell\": [\n                19,\n                9\n            ],\n            \"invoice_number\": {\n                \"value\": \"INV-001\",\n                \"location\": [\n                    5,\n                    3\n                ],\n                \"label_value\": \"Numar factura:\",\n                \"label_location\": [\n                    5,\n                    2\n                ]\n            },\n            \"issued_date\": {\n                \"value\": \"2021-08-28\",\n                \"location\": [\n                    6,\n                    3\n                ],\n                \"label_value\": \"Data:\",\n                \"label_location\": [\n                    6,\n                    2\n                ]\n            },\n            \"currency\": {\n                \"value\": \"RON\",\n                \"location\": [\n                    6,\n                    9\n                ],\n                \"label_value\": \"Moneda:\",\n                \"label_location\": [\n                    6,\n                    8\n                ]\n            },\n            \"customer_area\": {\n                \"area_info\": {\n                    \"value\": \"Client\",\n                    \"location\": [\n                        [\n                            8,\n                            5\n                        ],\n                        [\n                            17,\n                            6\n                        ]\n                    ]\n                },\n                \"CUI\": {\n                    \"value\": \"...exceel data...\",\n                    \"location\": [\n                        11,\n                        6\n                    ],\n                    \"label_value\": \"CIF:\",\n                    \"label_location\": [\n                        11,\n                        5\n                    ]\n                },\n                \"RegistrationName\": {\n                    \"value\": \"SOME COMPANY SRL\",\n                    \"location\": [\n                        9,\n                        5\n                    ],\n                    \"label_value\": \"n/a\",\n                    \"label_location\": \"n/a\"\n                },\n                \"PostalAddress\": {\n                    \"cbc_StreetName\": \"\",\n                    \"cbc_CityName\": \"...excel data...\",\n                    \"cbc_PostalZone\": \"\",\n                    \"cac_Country\": {\n                        \"cbc_IdentificationCode\": \"RO\"\n                    }\n                }\n            },\n            \"supplier_area\": \"...future...\"\n        },\n        \"invoice_footer_area\": {\n            \"start_cell\": [\n                26,\n                1\n            ],\n            \"end_cell\": [\n                31,\n                9\n            ]\n        }\n    }\n}\n</code></pre>"},{"location":"src/xl2roefact/xl2roefact/tests/test_data_and_specs_originals/specs/_my_notes.html","title":"Note si observatii la diversele documente din <code>specs/</code>","text":"<ul> <li>Note si observatii la diversele documente din specs/<ul> <li>Specificatiile facturii electronice format XML</li> </ul> </li> </ul>"},{"location":"src/xl2roefact/xl2roefact/tests/test_data_and_specs_originals/specs/_my_notes.html#specificatiile-facturii-electronice-format-xml","title":"Specificatiile facturii electronice format <code>XML</code>","text":"<ul> <li> (piu 231106) in doc <code>SR-EN-16931-12017.pdf</code> pagina 32 contine modelul de date facturii (downloaded as <code>ModelFactura_pg32.pdf</code>)</li> <li>...</li> </ul>"},{"location":"web_dashb_app/README_web_dashb.html","title":"README web dashb","text":"<p>RENware Software Systems</p>"},{"location":"web_dashb_app/README_web_dashb.html#web_dashb-component","title":"WEB_DASHB component","text":"<p>Cuprins:</p> <ul> <li>WEB_DASHB component</li> </ul> <p>This component is presented in document `.../doc_src/...110-SRE-api_to_roefact_requirements.md``</p>"},{"location":"xl2roefact/index.html","title":"Descriere","text":"<p>RENware Software Systems</p>"},{"location":"xl2roefact/index.html#xl2roefact","title":"xl2roefact","text":"<p>Cuprins:</p> <ul> <li>xl2roefact<ul> <li>Facilitati</li> <li>Instalarea aplicatiei xl2roefact</li> <li>Configurarea aplicatiei xl2roefact</li> <li>Comenzile aplicatiei<ul> <li>xl2roefact<ul> <li>about</li> <li>settings</li> <li>xl2json</li> </ul> </li> </ul> </li> <li>Practici si regului referitoare la continutul facturilor din Excel</li> <li>Tutorial utilizare aplicatie<ul> <li>Organizarea informatiei</li> <li>Exemplu de procesare a unei facturi</li> </ul> </li> <li>Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</li> <li>Descarcare (download) aplicatie xl2roefact CLI</li> <li>Date identificare</li> <li>License</li> <li>Note</li> </ul> </li> </ul>"},{"location":"xl2roefact/index.html#facilitati","title":"Facilitati","text":"<p>Aceasta componenta este \"totul despre crearea de facturi electronice\" din formatul Excel office (xlsx). Aplicatia poate genera factura in format JSON, XML, PDF si o poate incarca in sistemul RO E-Fact1.</p> <p>Aceasta componenta ofera urmatoarele facilitati (acestea fiind obiectivele fundamentale ale componentei):</p> <ul> <li> <p>transformarea facturilor din Excel in formatul <code>XML</code> cerut de catre sistemul ANAF RO E-Fact pentru incarcare</p> </li> <li> <p>incarcarea acestora in sistemul ANAF RO E-Fact1</p> </li> <li> <p>transformarea facturilor din Excel intr-un format <code>JSON</code>  intermediar, independent de platforma si care permite integrarea acestora cu alte sisteme (standard REST)</p> </li> <li> <p>generarea facturii in format PDF pentru transmiterea acesteia catre client, semnarea electronica, tiparirea si arhivarea acesteia in format fizic (in general manipularea facturii in format \"human readable\")</p> </li> </ul> <p>Componenta ofera doua instrumente pentru realizarea si indeplinirea acestor obiective:</p> <ul> <li> <p><code>xl2roefact</code> o aplicatie de tip linie de comanda (disponibila pentru sistemele de operare Windows, Linux si MacOS)</p> </li> <li> <p><code>xl2roefact PyPi</code> o blioteca standard Python utilizabila pentru dezvoltari proprii in scopul extinderii altor sisteme existente (custom development)</p> </li> </ul>"},{"location":"xl2roefact/index.html#instalarea-aplicatiei-xl2roefact","title":"Instalarea aplicatiei xl2roefact","text":"<p>Pachetele de instalare sunt disponibile aici. Pachetele disponibile contin in numele lor versiunea de aplicatie utilizata si sistemul de operare pentru care sunt disponibile:</p> <ul> <li><code>MSI</code> pachet instalare pentru Windows</li> <li><code>DEB</code> pachet instalare pentru Linux Debian (verificati disponibilitatea pentru varianta sistemuluu de operare folosit de dvs)</li> <li><code>EXE</code> executabil Windows in format \"portabil\" (un singur fisier)</li> </ul> <p>NOTA 1: pentru echivalent utilizare  portabila pentru Linux se va instala biblioteca Python (vezi sectiunea <code>xl2roefact PyPi library</code>) dupa care devine utilizabil scriptul Python \"ca orice alta comanda Linux\"</p> <p>NOTA 2: pachetul <code>MSI</code> pentru Windows este disponibil in orice variante / versiuni al sistemului. Optiunile pentru Linux sunt mult mai flexibile si astfel celelalte pot lipsi insa pot fi disponibile graruit, la cerere.</p>"},{"location":"xl2roefact/index.html#configurarea-aplicatiei-xl2roefact","title":"Configurarea aplicatiei xl2roefact","text":"<p>Parametrii de configurare a plicatiei se gasesc in fisierul <code>config_settings.py</code>. Acestia sunt sub elaborati in limbaj Python prin utilizarea conventiilor de constante conform recomandarilor PEP (numele capitatlizat) si sunt acompaniti de linii de explicatii privind aplicabilitatea lor.</p> <p>Configurare aplicatiei se poate face interactiv si din aplicatie. Pentru a obtine help referitor la detaliile comenzi se va folosi <pre><code>xl2roefact settings --help\n</code></pre></p>"},{"location":"xl2roefact/index.html#comenzile-aplicatiei","title":"Comenzile aplicatiei","text":"<p>Interfata aplicatie este realizata utilizind conventiile si practicile uzuale pentru aplicatii tip linie de comanda consola. Pentru informatii privind comenzile se poate folosi optiunea de help, dispobilia atit la nivelul general: <pre><code>xl2roefact --help\n</code></pre> cit si la nivel detaliat pentru fiecare comanda <pre><code>xl2roefact [COMMAND] --help\n</code></pre></p> <p>Lista comenzilor:</p> <ul> <li> <p>about - Afiseaza informatii despre aceatsa aplicatie (copyright, scop, etc)</p> </li> <li> <p>settings _ Afiseaza parametrii de configurare a aplicatiei. Vezi sectiunea de configurare a aplicatiei</p> </li> <li> <p>xl2json - Transforma fisierul (fisierele) Excel in forma JSON pentru utilizare ulterioara ca forma de date standardizat pentru schimbul de informatii cu alte sisteme electronice</p> </li> </ul> <p>Detalii comenzi:</p> <p> </p>"},{"location":"xl2roefact/index.html#xl2roefact_1","title":"xl2roefact","text":"<p>function called when no command is invoked and to provide only application version (for external users to test it!).</p> <p>Usage:</p> <pre><code>xl2roefact [OPTIONS] COMMAND [ARGS]...\n</code></pre> <p>Options:</p> <pre><code>  --version             show application version\n  --install-completion  Install completion for the current shell.\n  --show-completion     Show completion for the current shell, to copy it or\n                        customize the installation.\n</code></pre>"},{"location":"xl2roefact/index.html#about","title":"about","text":"<p>provide a short application description.</p> <p>Usage:</p> <pre><code>xl2roefact about [OPTIONS]\n</code></pre>"},{"location":"xl2roefact/index.html#settings","title":"settings","text":"<p>display application configuration parameters and settings that are subject to be changed by user.</p> <p>Args:     <code>rules</code>: show recommended rules to follow when change application configurable settings (available in both RO &amp; EN languages). Defaults to <code>False</code>.</p> <p>Usage:</p> <pre><code>xl2roefact settings [OPTIONS]\n</code></pre> <p>Options:</p> <pre><code>  -r, --rules  show settings recommended update rules\n</code></pre>"},{"location":"xl2roefact/index.html#xl2json","title":"xl2json","text":"<p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p> <p>Args:     <code>file_name</code>: files to process (wildcards allowed).     <code>files_directory</code>: directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead     <code>verbose</code>: show detailed processing messages\". Defaults to <code>False</code>.</p> <p>Usage:</p> <pre><code>xl2roefact xl2json [OPTIONS] [FILE_NAME]\n</code></pre> <p>Options:</p> <pre><code>  [FILE_NAME]                     files to process (wildcards allowed)\n                                  [default: *.xlsx]\n  -d, --files-directory DIRECTORY\n                                  directory to be used to look for Excel files\n                                  (if default directory does not exists will\n                                  consider current directory instead).\n                                  [default: invoice_files/]\n  -v, --verbose                   show detailed processing messages\n</code></pre>"},{"location":"xl2roefact/index.html#practici-si-regului-referitoare-la-continutul-facturilor-din-excel","title":"Practici si regului referitoare la continutul facturilor din Excel","text":"<p>Acest capitol se refera la modul in care este \"tratat\" continutul fisierului Excel cu factura, mai exact la modalitatea in care informatia facturii este cautata, identificata si gasita in scopul de a fi salvata in oricare din formatele de \"factura electronica / E-Fact\".</p> <p>Utilizarea sablonului de factura Excel ce este livrat impreuna cu aplicatia ESTE O VARIANTA DE LUCRU RECOMANDATA, dar nu obligatorie. Chiar si in cazul utilizarii acestuia, prin modificarea \"structurii\" acestuia, informatia poate ajunge nerecognoscibila / neidentificabila total sau partial daca nu sunt urmate regulile expuse.</p> <p>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</p> <p>Mai exact continutul informational al facturii nu trebuie nici confundat si nici mixat cu formatul de afisare al acesteia (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere regulile de formatare din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p> <ul> <li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li> <li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li> </ul>"},{"location":"xl2roefact/index.html#tutorial-utilizare-aplicatie","title":"Tutorial utilizare aplicatie","text":""},{"location":"xl2roefact/index.html#organizarea-informatiei","title":"Organizarea informatiei","text":"<p>Aplicatia xl2roefact \"promoveaza\" structurarea informatiei procesate astfel incit sa fie evitata situatia \"de aglomerare\" a directorului curent cu fisiere ce trebuiesc identificate si izolate in situatia in care se fac procesari in masa (pe mai multe fisiere / facturi sursa).</p> <p>Astfel, aplicatia se asteapa ca fisierele Excel sursa (adica facturile de procesat) sa fie copiate in directorul <code>invoice_files/</code> de unde vor fi citite si tot aici vor fi create fisierele rezultate (JSON, XML, etc). Acest director este relativ la directorul curent de unde este lansata aplicatia si considerat \"implicit\" cu acest nume dar daca se doreste un alt director acest lucru poate fi facut folosind parametrul <code>--files-directory</code> (sau prescurtat <code>-d</code>) la lansarea aplicatiei astfel: <pre><code>xl2roefact -d \"calea si numele directorului dorit\"\n</code></pre></p> <p>Nota</p> <p>Ghilimelele sunt necesare numai daca numele si calea (<code>path</code>) contin caracterul spatiu.</p> <p>Exemple:</p> <ul> <li> <p>pentru stabilirea directorului curent ca sursa pentru fisierele factura Excel: <code>xl2roefact -d ./</code></p> </li> <li> <p>procesarea tuturor facturilor facturilor din luna iunie, copiate intr-un director dedicat sub directorul curent: <code>xl2roefact -d ./facturi_iunie/</code></p> </li> </ul>"},{"location":"xl2roefact/index.html#exemplu-de-procesare-a-unei-facturi","title":"Exemplu de procesare a unei facturi","text":"<ul> <li>se creaza directorul <code>invoice_files</code></li> <li>se copiaza factura <code>factura_A.xlsx</code> in acest director apoi se revine in directorul anterior daca acesta a fost schimbat pentru efectuarea copierii</li> <li>se lanseaza aplicatia: <code>xl2roefact xl2json</code></li> </ul> <p>In urma acestor operatii, in directorul <code>invoice_files</code> vor rezulta:</p> <pre><code>\ud83d\udcc1 invoice_files/\n\u251c\u2500\u2500 \ud83d\udcc4 factura_A.xlsx  # fisierul Excel original\n\u2514\u2500\u2500 \ud83d\udcc4 factura_A.json  # fisierul JSON rezultat in urma procesarii\n</code></pre> <ul> <li><code>factura_A.xlsx</code> ca fiind fisierul Excel original cu factura</li> <li><code>factura_A.json</code> acesta fiind fisierul format JSON rezultat in urma procesarii si ce poate fi folosit pentru interschimbarea electronica a informatiei intre sisteme</li> </ul>"},{"location":"xl2roefact/index.html#aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii","title":"Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii","text":"<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Formatul JSON are urmatoarra structura de baza:</p> <pre><code>{\n    \"Invoice\": {...},\n    \"meta_info\": {...},\n    \"excel_original_data\": {...}\n}\n</code></pre> <p>Cheile de la primul nivel contin:</p> <ul> <li><code>Invoice</code> - datele efective ale facturii</li> <li><code>meta_info</code><ul> <li>informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul RO E-Fact</li> <li>harta de ajutor in conversia formatului JSON in formatul XML acceptat de sistemul RO E-Fact (cheie <code>meta_info.map_JSONkeys_XMLtags</code>) si definititiile XML aferente (cheie <code>meta_info.invoice_XML_schemes</code>)</li> <li>alte informatii despre fisierul Excel prelucrat (numele, worksheet cu factura, data si ora procesarii, CRC pentru verificare, etc)</li> </ul> </li> <li><code>excel_original_data</code> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru \"a intelege\" de unde si cum arata informatiile originale din fisierul Excel</li> </ul> <p>Pentru detalii suplimentare despre formatul JSON trebyie consultata componenta referitoare la biblioteca <code>xl2roefact</code> destinata dezvoltarii software.</p>"},{"location":"xl2roefact/index.html#descarcare-download-aplicatie-xl2roefact-cli","title":"Descarcare (download) aplicatie xl2roefact CLI","text":""},{"location":"xl2roefact/index.html#date-identificare","title":"Date identificare","text":"<ul> <li>part number (p/n): <code>0000-0095-xl2roefact</code></li> <li>producator si copyright: RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul>"},{"location":"xl2roefact/index.html#license","title":"License","text":""},{"location":"xl2roefact/index.html#note","title":"Note","text":"<ol> <li> <p>Toate interactiunile cu sistemul ANAF RO E-Fact necesita o conexiune la internet si un set de credentiale ANAF RO E-Fact ale companiei pentru care se incarca factura. In lipsa acestora, fisierul <code>XML</code> generat de aplicatie poate fi incarcat ulterior (de ex de catre departmentul contabilitate)\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html","title":"Table of Contents","text":"<ul> <li>app_cli</li> <li>about</li> <li>settings</li> <li>xl2json</li> <li>called_when_no_command</li> <li>chkisld</li> <li>chkxml</li> <li>config_settings</li> <li>DEFAULT_SUPPLIER_COUNTRY</li> <li>ldxml</li> <li>libutils</li> <li>isnumber</li> <li>find_str_in_list</li> <li>rdinv</li> <li>rdinv</li> <li>get_excel_data_at_label</li> <li>mk_kv_invoice_items_area</li> <li>get_invoice_items_area</li> <li>wrxml</li> <li>__init__</li> <li>__main__</li> <li>__version__</li> </ul>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#app_cli","title":"app_cli","text":"<p>app_cli: the command line application for all xl2roefact functionalities.</p> <p>Identification:</p> <ul> <li>code-name: <code>xl2roefact</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Deployments:</p> <ul> <li>Windows:  MSI installer with EXE application.</li> <li>Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</li> </ul> <p>Specifications:</p> <ul> <li>command general format: <code>xl2roefact [file(s)-to-convert] COMMAND [OPTIONS]</code>.</li> <li>help: <code>xl2roefact [COMMAND] --help</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#about","title":"about","text":"<pre><code>@app_cli.command()\ndef about()\n</code></pre> <p>provide a short application description.</p> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#settings","title":"settings","text":"<pre><code>@app_cli.command()\ndef settings(rules: Annotated[\n    bool,\n    typer.\n    Option(\"--rules\", \"-r\", help=\"show settings recommended update rules\"),\n] = False)\n</code></pre> <p>display application configuration parameters and settings that are subject to be changed by user.</p> <p>Arguments:</p> <ul> <li><code>rules</code> - show recommended rules to follow when change application configurable settings (available in both RO &amp; EN languages). Defaults to <code>False</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#xl2json","title":"xl2json","text":"<pre><code>@app_cli.command()\ndef xl2json(\n    file_name: Annotated[\n        str, typer.Argument(\n            help=\"files to process (wildcards allowed)\")] = \"*.xlsx\",\n    files_directory: Annotated[\n        Path,\n        typer.Option(\n            \"--files-directory\",\n            \"-d\",\n            exists=False,\n            file_okay=False,\n            dir_okay=True,\n            writable=True,\n            readable=True,\n            resolve_path=True,\n            help=\n            \"directory to be used to look for Excel files (if default directory does not exists will consider current directory instead).\"\n        ),\n    ] = \"invoice_files/\",\n    verbose: Annotated[\n        bool,\n        typer.\n        Option(\"--verbose\", \"-v\", help=\"show detailed processing messages\"),\n    ] = False)\n</code></pre> <p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p> <p>Arguments:</p> <ul> <li><code>file_name</code> - files to process (wildcards allowed).</li> <li><code>files_directory</code> - directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead</li> <li><code>verbose</code> - show detailed processing messages\". Defaults to <code>False</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#called_when_no_command","title":"called_when_no_command","text":"<pre><code>@app_cli.callback(invoke_without_command=True)\ndef called_when_no_command(\n    ctx: typer.Context,\n    version: Annotated[\n        bool,\n        typer.Option(\"--version\", help=\"show application version\"),\n    ] = False)\n</code></pre> <p>function called when no command is invoked and to provide only application version (for external users to test it!).</p> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#chkisld","title":"chkisld","text":"<p>chkisld: modul de verificare a starii de incarcare a unei facturi emise</p> <p>Identification:</p> <ul> <li>code-name: <code>chkisld</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Specifications:</p> <ul> <li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li> <li>INTRARI: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii</li> <li>IESIRI: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#chkxml","title":"chkxml","text":"<p>chkxml: modul de validare a facturii in sistemul ANAF E-Factura</p> <p>Identification:</p> <ul> <li>code-name: <code>chkxml</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Specifications:</p> <ul> <li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu eventualele erori de validare</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#config_settings","title":"config_settings","text":"<p>Configuration and setting parameters.  </p> <p>(en-us) README before making changes:</p> <ul> <li>each parameter has a short help (lines starting with <code>#</code> character) - read it before changing that parameter</li> <li>do not change parametrs name as specified before equal (<code>=</code>) sign</li> <li>lists are enclosed in sqaured brackets (<code>[...]</code>) and items are separated by comma character (<code>,</code>)</li> <li>strings are enclosed in <code>\"</code> characters</li> <li>if you want to clear a list (for example you do not wants any options inside) just let it as <code>&lt;PARAMETR NAME&gt; = []</code> - do not drop that parameter</li> <li>do not add supplementary parameters, they will not be used without software changes (also risk to induce potential errors)</li> <li>for calendaristic dates Excel cells use <code>date</code> format and change it as display option to show wanted format</li> </ul> <p>(ro) README inainte de a face modificari:</p> <ul> <li>fiecare parametru are un hep scurt (liniile ce incep cu caracterul <code>#</code>) - citi-l inainte de a modifica uun parametru</li> <li>nu schimbati numele parametrilor asa cum este el specificat inainte de semnul egal (<code>=</code>)</li> <li>listele sunt incluse intre paranteze drepte (<code>[...]</code>) si elementele lor sunt separate prin caracterul virgula (<code>,</code>)</li> <li>sirurile de caractere sunt incluse intre ghilimele (caracterul <code>\"</code>)</li> <li>daca doriti stergerea unei listei (de ex daca nu doriti nici o optiune pentru acea lista) doar lasati acel parametru cu valoarea <code>[]</code> - nu stergeti in nici un caz acel parametru</li> <li>nu adaugati parametrii suplimentari (altii decit cei specificati aici), acestia nu vor fi utilizati fara a modifica aplicatia (de asemenea riscati sa induceti erori in cod)</li> <li>pentru datele calendaristice in celulul Excel a se utiliza formatul standard de data (<code>date</code>) si modificati formatul de afisare in formatul dorit pe factura tiparibila</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#default_supplier_country","title":"DEFAULT_SUPPLIER_COUNTRY","text":"<p>NOTE: \"pattern-uri\" (sabloane) de identificare si regasire a datelor folositi de</p> <p>__  comanda <code>xl2json</code> reprezentind functionalitatea de extragere a datelor din Excel si exportul lor in formatul JSON (modulul `rdinv)__</p> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#ldxml","title":"ldxml","text":"<p>ldxml: modul de incarcare a facturii in sistemul ANAF E-Factura</p> <p>Identification:</p> <ul> <li>code-name: <code>ldxml</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Specifications:</p> <ul> <li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li> <li>INTRARI: fisier <code>f-XML</code></li> <li>IESIRI: raport cu validarea si identificatorul incarcarii</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#libutils","title":"libutils","text":"<p>general utilities library for all <code>xl2roefact</code> components and modules.</p> <p>Identification:</p> <ul> <li>code-name: <code>libutils</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Components:</p> <ul> <li><code>isnumber(a_string: str) -&gt; bool</code>     Test a string if it could be used as number (int or float)</li> <li><code>find_str_in_list(list_of_str_to_find: list, list_to_search: list) -&gt; int</code>     Search more strings (ie, a list) in list of strings</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#isnumber","title":"isnumber","text":"<pre><code>def isnumber(a_string: str) -&gt; bool\n</code></pre> <p>test if a string is valid as any kind of number.</p> <p>Arguments:</p> <ul> <li><code>a_string</code> - input string.</li> </ul> <p>Returns:</p> <ul> <li><code>True</code> - if input string is valid as any kind of number, orherwise <code>False</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#find_str_in_list","title":"find_str_in_list","text":"<pre><code>def find_str_in_list(list_of_str_to_find: list, list_to_search: list) -&gt; int\n</code></pre> <p>find a substring from <code>list_of_str_to_find</code> in elements of <code>list_to_search</code>.</p> <p>Arguments:</p> <ul> <li><code>list_of_str_to_find</code> - list of strings to search for.</li> <li><code>list_to_search</code> - liste where to search for substrings.</li> </ul> <p>Returns:</p> <ul> <li><code>index</code> - the index of list item which contains <code>str_to_find</code> (first found) or <code>None</code> if not found.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#rdinv","title":"rdinv","text":"<p>rdinv: modul de procesare a fisierului Excel ce contine factura si colectare a datelor aferente.</p> <p>Formatul acceptat fisier Excel este <code>XLSX</code>.</p> <p>Identification:</p> <ul> <li>code-name: <code>rdinv</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Specifications:</p> <ul> <li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li> <li>INTRARI: fisier format XLSX ce contine factura emisa (cod: <code>f-XLSX</code>)</li> <li>IESIRI: fisier format JSON imagine a datelor facturii (cod: <code>f-JSON</code>)</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#rdinv_1","title":"rdinv","text":"<pre><code>def rdinv(file_to_process: str,\n          invoice_worksheet_name: str = None,\n          *,\n          debug_info: bool = False) -&gt; dict\n</code></pre> <p>read Excel file for invoice data.</p> <p>Produce a dictionary structure + JSON file with all data regarding read invoice: canonical KV data, meta data, map to convert to XML and original Excel data.</p> <p>Arguments:</p> <ul> <li><code>file_to_process</code> - the invoice file (exact file with path).</li> <li><code>invoice_worksheet_name</code> - the worksheet containing invoice, optional, defaults to first found worksheet.</li> <li><code>debug_info</code> - key only, show debugging information, default <code>False</code>.</li> </ul> <p>Returns:</p> <ul> <li><code>dict</code> - the invoice extracted information from Excel file as <code>dict(Invoice: dict, meta_info: dict, excel_original_data: dict)</code> <code>TODO</code> subject of documentation update.</li> </ul> <p>NOTE ref important variables:   * <code>db: pylightxl object</code>: EXCEL object with invoice (as a whole)   * <code>ws: pylightxl object</code>: WORKSHEET object with invoice</p> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#get_excel_data_at_label","title":"get_excel_data_at_label","text":"<pre><code>def get_excel_data_at_label(pattern_to_search_for: list[str],\n                            worksheet: xl.Database.ws,\n                            area_to_scan: list[list[int]] = None,\n                            targeted_type: Callable = str,\n                            down_search_try: bool = True) -&gt; dict\n</code></pre> <p>get \"one key Excel values\", like invoice number or invoice issue date.</p> <p>Arguments:</p> <ul> <li><code>pattern_to_search_for</code> - for example for inv number, will pass the <code>PATTERN_FOR_INVOICE_NUMBER_LABEL</code>.</li> <li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li> <li><code>area_to_scan</code> - area of cells to be searched, default whole worksheet.</li> <li><code>targeted_type</code> - what type expect (will try to convert to, if cannot will return str), default <code>str</code>.</li> <li><code>down_search_try</code> - establish if DOWN search method is tried, default <code>True</code>.</li> </ul> <p>Returns:</p> <p><code>None</code> if not found OR <code>dictionary</code> containing:   * <code>\"value\": int | float | str</code> - the value found covenrted to requested <code>targeted_type</code> if possible or <code>str</code> otherwise; if \"out of space\" then returns <code>None</code>   * <code>\"location\": (row, col)</code> - adrees of cell where found value</p> <p>Notes:</p> <ul> <li>normal scan order is 1.RIGHT, 2.DOWN (if allowed), 3.IN-LABEL only in given area and pattern.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#mk_kv_invoice_items_area","title":"mk_kv_invoice_items_area","text":"<pre><code>def mk_kv_invoice_items_area(invoice_items_area_xl_format)\n</code></pre> <p>transform <code>invoice_items_area</code> in \"canonical JSON format\" (as kv pairs).</p> <p>Arguments:</p> <ul> <li><code>invoice_items_area_xl_format</code> - invoice items area in Excel format (ie, DataFrame with row, col, data).</li> </ul> <p>Returns:</p> <ul> <li><code>invoice_items_area_xl_format</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li> </ul> <p>Notes:</p> <ul> <li>for ROefact XML model (&amp; plan) see <code>invoice_files/__model_test_factura_generat_anaf.xml</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#get_invoice_items_area","title":"get_invoice_items_area","text":"<pre><code>def get_invoice_items_area(worksheet, invoice_items_area_marker, wks_name)\n</code></pre> <p>get invoice for <code>invoice_items_area</code>, process it and return its Excel format.</p> <p>Process steps &amp; notes: * find invoice items subtable. * clean invoice items subtable. * extract relevenat data. * NOTE: all Excel cell addresses are in <code>(row, col)</code> format (ie, Not Excel format like \"A:26, C:42, ...\")</p> <p>Arguments:</p> <ul> <li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li> <li><code>invoice_items_area_marker</code> - string with exact marker of invoice items table.</li> <li><code>NOTE</code> - this is the UPPER-LEFT corner and is determined before calling this procedure.</li> <li><code>wks_name</code> - the wroksheet name (string) of the <code>worksheet</code> object.</li> </ul> <p>Returns:</p> <ul> <li><code>invoice_items_area</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#wrxml","title":"wrxml","text":"<p>wrxml: modul de generare a fisierului format XML</p> <p>Identification:</p> <ul> <li>code-name: <code>wrxml</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Specifications:</p> <ul> <li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li> <li>INTRARI: fisier <code>f-JSON</code></li> <li>IESIRI: fisier format XML conform cerintelor si sistemului ANAF E-Factura (cod: <code>f-XML</code>)</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__init__","title":"__init__","text":""},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__main__","title":"__main__","text":"<p>xl2roefact.main: Python package standard file to assure run as <code>python -m xl2roefact</code>.</p> <p>Identification:</p> <ul> <li>code-name: <code>__main__</code></li> <li>copyright: (c) 2023 RENWare Software Systems</li> <li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li> </ul> <p>Deployments:</p> <ul> <li>Windows:  MSI installer with EXE application.</li> <li>Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</li> </ul> <p>Specifications:</p> <ul> <li>command general format: <code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code>.</li> <li>help: <code>python -m xl2roefact --help</code>.</li> </ul> <p></p>"},{"location":"xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html#__version__","title":"__version__","text":"<p>xl2roefact version info. <pre><code> ######## ####              ########  ######\n #  ##  # #  #              #      # ##    ##\n ##    ## #  #              ###  ### #  ##  #\n  ##  ##  #  #                #  #   #  ##  #\n ##    ## #  #                #  #   #  ##  #\n #  ##  # #  #####            #  #   #  ##  #\n #  ##  # #      #            #  #   ##    ##\n ######## ########            ####    ######\n\n                            ######## ########  ######   ######  ########\n #######   ######           #      # #     #  ##    ## ##    ## #      #\n #     ## ##    ## #######  #  ##### #  ####  #  ##  # #  ##  # ###  ###\n #  ##  # #  ##  # #     #  #    #   #    #   #      # #  #####   #  #\n #  ##### #  ##  # #######  #  ###   #  ###   #  ##  # #  #####   #  #\n #  # #   #  ##  #          #  ##### #  #     #  ##  # #  ##  #   #  #\n #  #  #  ##    ##          #      # #  #     #  ##  # ##    ##   #  #\n ####   #  ######           ######## ####     ########  ######    ####\n</code></pre></p>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html","title":"Descriere","text":""},{"location":"xl2roefact/doc/README_xl2roefact_library.html#xl2roefact-pypi-library","title":"xl2roefact PyPi library","text":"<ul> <li>xl2roefact PyPi library<ul> <li>System modules<ul> <li>rdinv module logic</li> </ul> </li> <li>Install library<ul> <li>Install from PyPi</li> <li>Install from distribution packages</li> </ul> </li> <li>Working directories</li> <li>Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</li> <li>API Reference</li> <li>Download xl2roefact library<ul> <li>Arhiva versiuni publicate disponibile</li> </ul> </li> </ul> </li> </ul>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#system-modules","title":"System modules","text":"<p><code>xl2roefact</code> main and basic modules are:</p> <ul> <li><code>rdinv</code> read an Excel file and extract invoice data to a JSON file format</li> <li><code>wrxml</code>  write, convert the JSON invoice file to a XML file format, respecting schemes required by RO EFact standard</li> <li><code>chkxml</code> check generated XML file</li> <li><code>ldxml</code> load an invoice (ie, its XML associated file) to ANAF SPV system</li> <li><code>chkisld</code> check if an invoice is already loaded in ANAF SPV system</li> <li><code>config_settings</code> define system settings &amp; parameters mainly used in invoice info / data detection and extract from invoice Excel format file</li> <li><code>app_cli</code> contains the code for <code>xl2roefact</code> application command line (CLI) format</li> </ul> <p>Below is presented the skeleton logic of those modules which and where is relevant ie meaning where is not enough obvious from code or code complexity exceed usual limits (for example nore than 100 lines of code per function). For more technical details and specification regarding modules see API Reference</p>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#rdinv-module-logic","title":"rdinv module logic","text":"<p>Main function of <code>rdinv</code> module is <code>rdinv(...)</code> which has the following logic sections which are in strict sequence in presented order:</p> <ul> <li> <p>search of <code>invoice_items_area</code> sub-table. This area is expected to contain invoice lines and is \"processed\" first because it is more structured and easier to identify; after its identification the header area is considered upper of it and footer area below it</p> </li> <li> <p>solve <code>invoice_items_area</code> in 2 step.... In this step the code-data-variables of items area will be initialized in order to hold information that will be found</p> </li> <li> <p>localize and mark areas for... section that follows natural the previous one by initializing code-data-variables forcheader and footer areas to hold their corresponding information</p> </li> <li> <p>solve <code>invoice_header_area</code> detailed initialize of header area code-data-variables</p> </li> <li> <p><code>ReNaSt</code>-RegNameStrategy section that identify and extract the legal registered name of invoice customer</p> </li> <li> <p>section to ( Excel data )---&gt;( JSON ) format preparation and finishing section which prepare Excel original data found to be be saved as JSON as a more \"electronic interchangeable\" structure</p> </li> <li> <p>for more details about code logic description and presentation, please contact RENware Software Systems</p> </li> </ul>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#install-library","title":"Install library","text":"<p>Library can be installed using 2 methods:</p> <ul> <li>install from PyPi</li> <li>install from distribution packages</li> </ul>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#install-from-pypi","title":"Install from PyPi","text":"<p>The library installation should be done using standard Python instruments:</p> <pre><code>pip install xl2roefact\n</code></pre>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#install-from-distribution-packages","title":"Install from distribution packages","text":"<p>To install from distribution packages first download the package version intended to install (see download section), choose the package type (if you have no special option, then choose <code>WHEEL</code> format) and install it using <code>pip</code> as any other Python library installation (detailed in Python official documentation).</p>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#working-directories","title":"Working directories","text":"<p>Below is a short description of most important directories that will (can !) be found on local development environment.</p> <ul> <li> <p><code>invoice_files/</code> default directory for Excel files which is intended to be processed</p> </li> <li> <p><code>build/</code> this directory which will contain intermediary files resulted from building CLI application, library distribution parts, etc. Directory is subject of <code>.gitignore</code></p> </li> <li> <p><code>dist/</code> package files (wheels, dist), Windows executables, etc, generally all files subject of \"public\" distribution and download</p> </li> <li> <p><code>test_*/</code> contains test invoice samples (from client, a RENware one, a 3rd party one) and some useful specs in dev &amp; test process</p> </li> </ul>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii","title":"Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii","text":"<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Structura de baza a acestui fisier este:</p> <pre><code>{\n    \"Invoice\": {...},\n    \"meta_info\": {...},\n    \"excel_original_data\": {...}\n}\n</code></pre> <p>Cheile de la primul nivel contin:</p> <ul> <li><code>Invoice</code> - datele efective ale facturii</li> <li><code>meta_info</code><ul> <li>informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul RO E-Fact</li> <li>harta de ajutor in conversia formatului JSON in formatul XML acceptat de sistemul RO E-Fact (cheie <code>meta_info.map_JSONkeys_XMLtags</code>) si definititiile XML aferente (cheie <code>meta_info.invoice_XML_schemes</code>)</li> <li>alte informatii despre fisierul Excel prelucrat (numele, worksheet cu factura, data si ora procesarii, CRC pentru verificare, etc)</li> </ul> </li> <li><code>excel_original_data</code> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru \"a intelege\" de unde si cum arata informatiile originale din fisierul Excel</li> </ul> <p>An example of JSON generated file is available here</p>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#api-reference","title":"API Reference","text":""},{"location":"xl2roefact/doc/README_xl2roefact_library.html#download-xl2roefact-library","title":"Download xl2roefact library","text":"<ul> <li>0.1.20.dev invoice customer address WHEEL</li> <li>0.1.20.dev invoice customer address DIST</li> </ul>"},{"location":"xl2roefact/doc/README_xl2roefact_library.html#arhiva-versiuni-publicate-disponibile","title":"Arhiva versiuni publicate disponibile","text":"<ul> <li>0.1.19.dev invoice customer and partial invoice total values calculations WHEEL</li> <li> <p>0.1.19.dev invoice customer and partial invoice total values calculations DIST</p> </li> <li> <p>0.1.18.dev invoice customer CUI partial invoice total values calculations WHEEL</p> </li> <li>0.1.18.dev invoice customer CUI partial invoice total values calculations DIST</li> </ul>"},{"location":"xl2roefact/doc/invoice_json_model_.html","title":"Generated invoice JSON model","text":"<p>NOTE: The following model should be considered ONLY for JSON keys. All data is just sample / not real just for a better understanding of its format (or \"how it looks like\").</p> <pre><code>{\n    \"Invoice\": {\n        \"cbc_ID\": \"INV-001\",\n        \"cbc_DocumentCurrencyCode\": \"RON\",\n        \"cbc_IssueDate\": \"2023-08-28\",\n        \"cac_AccountingCustomerParty\": {\n            \"cac:Party\": {\n                \"cac_PartyLegalEntity\": {\n                    \"cbc_CompanyID\": \"17753763\",\n                    \"cbc_RegistrationName\": \"SOME COMPANY SRL\"\n                },\n                \"cac_PostalAddress\": {\n                    \"cbc_StreetName\": \"\",\n                    \"cbc_CityName\": \"Bucure\u015fti Sectorul 1, Strada: Rozelor, Nr. 21, Etaj parter, tara: Romania\",\n                    \"cbc_PostalZone\": \"5555544\",\n                    \"cac_Country\": {\n                        \"cbc_IdentificationCode\": \"RO\"\n                    }\n                }\n            }\n        },\n        \"cac_InvoiceLine\": [\n            {\n                \"cbc_ID\": \"1\",\n                \"cbc_InvoicedQuantity\": 3.5,\n                \"cbc_unitCode\": \"buc\",\n                \"cac_Item\": {\n                    \"cbc_Name\": \"Product x name here\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": 0.19,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": \"VAT\"\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": 11111.5,\n                    \"cbc_currencyID\": \"RON\"\n                },\n                \"cbc_LineExtensionAmount\": 38890.25,\n                \"LineVatAmount\": 7389.1475\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-a\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"just some supplementary explanations ref first product...\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-b\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"another explanations line...\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"1.NOTE-c\",\n                \"cbc_InvoicedQuantity\": null,\n                \"cbc_unitCode\": null,\n                \"cac_Item\": {\n                    \"cbc_Name\": \"'*** a comment ref price xchg rate 3000EUR ref BNR\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": null,\n                    \"cbc_currencyID\": null\n                },\n                \"cbc_LineExtensionAmount\": null,\n                \"LineVatAmount\": null\n            },\n            {\n                \"cbc_ID\": \"2\",\n                \"cbc_InvoicedQuantity\": 1,\n                \"cbc_unitCode\": \"\",\n                \"cac_Item\": {\n                    \"cbc_Name\": \"Acciza 1%\",\n                    \"cac_ClassifiedTaxCategory\": {\n                        \"cbc_Percent\": null,\n                        \"cac_TaxScheme\": {\n                            \"cbc_ID\": null\n                        }\n                    }\n                },\n                \"cac_Price\": {\n                    \"cbc_PriceAmount\": 111.115,\n                    \"cbc_currencyID\": \"RON\"\n                },\n                \"cbc_LineExtensionAmount\": 111.11,\n                \"LineVatAmount\": 0.0\n            }\n        ]\n    },\n    \"meta_info\": {\n        \"file\": \"invoice_json_model_.xlsx\",\n        \"file_CRC\": \"...file CRC (uniquely identify the invoice file used)\",\n        \"last_processing_time\": \"2021-01-23T07:39:30.115329+00:00\",\n        \"invoice_worksheet\": \"FACTURA\",\n        \"invoice_max_rows\": 31,\n        \"invoice_max_cols\": 9,\n        \"items_table_start_marker\": \"#\",\n        \"items_table_start_cell\": [\n            20,\n            1\n        ],\n        \"invoice_XML_schemes\": {\n            \"xmlns\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2\",\n            \"xmlns:cbc\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2\",\n            \"xmlns:cac\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2\",\n            \"xmlns:ns4\": \"urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2\",\n            \"xmlns:xsi\": \"http://www.w3.org/2001/XMLSchema-instance\",\n            \"xsi:schemaLocation\": \"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd\"\n        },\n        \"map_JSONkeys_XMLtags\": [\n            [\n                \"cac_InvoiceLine\",\n                \"cac:InvoiceLine\"\n            ],\n            [\n                \"cac_Item\",\n                \"cac:Item\"\n            ],\n            [\n                \"cac_ClassifiedTaxCategory\",\n                \"cac:ClassifiedTaxCategory\"\n            ],\n            [\n                \"cac_TaxScheme\",\n                \"cac:TaxScheme\"\n            ],\n            [\n                \"cac_Price\",\n                \"cac:Price\"\n            ],\n            [\n                \"cbc_ID\",\n                \"cbc:ID\"\n            ],\n            [\n                \"cbc_InvoicedQuantity\",\n                \"cbc:InvoicedQuantity\"\n            ],\n            [\n                \"cbc_unitCode\",\n                \"cbc:unitCode\"\n            ],\n            [\n                \"cbc_Name\",\n                \"cbc:Name\"\n            ],\n            [\n                \"cbc_Percent\",\n                \"cbc:Percent\"\n            ],\n            [\n                \"cbc_PriceAmount\",\n                \"cbc:PriceAmount\"\n            ],\n            [\n                \"cbc_currencyID\",\n                \"cbc:currencyID\"\n            ],\n            [\n                \"cbc_LineExtensionAmount\",\n                \"cbc:LineExtensionAmount\"\n            ],\n            [\n                \"cbc_ID\",\n                \"cbc:ID\"\n            ],\n            [\n                \"cbc_DocumentCurrencyCode\",\n                \"cbc:DocumentCurrencyCode\"\n            ],\n            [\n                \"cbc_IssueDate\",\n                \"cbc:IssueDate\"\n            ],\n            [\n                \"cac_AccountingCustomerParty\",\n                \"cac:AccountingCustomerParty\"\n            ],\n            [\n                \"cac_Party\",\n                \"cac:Party\"\n            ],\n            [\n                \"cac_PartyLegalEntity\",\n                \"cac:PartyLegalEntity\"\n            ],\n            [\n                \"cbc_CompanyID\",\n                \"cbc:CompanyID\"\n            ],\n            [\n                \"cbc_RegistrationName\",\n                \"cbc:RegistrationName\"\n            ],\n            [\n                \"cac_PostalAddress\",\n                \"cac:PostalAddress\"\n            ],\n            [\n                \"cbc_StreetName\",\n                \"cbc:StreetName\"\n            ],\n            [\n                \"cbc_CityName\",\n                \"cbc:CityName\"\n            ],\n            [\n                \"cbc_PostalZone\",\n                \"cbc:PostalZone\"\n            ],\n            [\n                \"cac_Country\",\n                \"cac:Country\"\n            ],\n            [\n                \"cbc_IdentificationCode\",\n                \"cbc:IdentificationCode\"\n            ]\n        ]\n    },\n    \"excel_original_data\": {\n        \"invoice_items_area\": {\n            \"keyrows\": [\n                1,\n                \"1.NOTE-a\",\n                \"1.NOTE-b\",\n                \"1.NOTE-c\",\n                2\n            ],\n            \"keycols\": [\n                \"Denumire produse sau servicii\",\n                \"UM\",\n                \"Cant\",\n                \"Pret unitar\",\n                \"Valoare fara TVA\",\n                \"Cota TVA\",\n                \"Valoare TVA\"\n            ],\n            \"data\": [\n                [\n                    \"...excel data...\",\n                    \"buc\",\n                    3.5,\n                    11111.5,\n                    38890.25,\n                    0.19,\n                    7389.15\n                ],\n                [\n                    \"...excel data...\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    ...excel data...\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    \"'*** a comment ref price xchg rate 3000EUR ref BNR\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\",\n                    \"\"\n                ],\n                [\n                    \"Acciza 1%\",\n                    \"\",\n                    1,\n                    111.115,\n                    111.12,\n                    \"\",\n                    0\n                ]\n            ]\n        },\n        \"invoice_header_area\": {\n            \"start_cell\": [\n                1,\n                1\n            ],\n            \"end_cell\": [\n                19,\n                9\n            ],\n            \"invoice_number\": {\n                \"value\": \"INV-001\",\n                \"location\": [\n                    5,\n                    3\n                ],\n                \"label_value\": \"Numar factura:\",\n                \"label_location\": [\n                    5,\n                    2\n                ]\n            },\n            \"issued_date\": {\n                \"value\": \"2021-08-28\",\n                \"location\": [\n                    6,\n                    3\n                ],\n                \"label_value\": \"Data:\",\n                \"label_location\": [\n                    6,\n                    2\n                ]\n            },\n            \"currency\": {\n                \"value\": \"RON\",\n                \"location\": [\n                    6,\n                    9\n                ],\n                \"label_value\": \"Moneda:\",\n                \"label_location\": [\n                    6,\n                    8\n                ]\n            },\n            \"customer_area\": {\n                \"area_info\": {\n                    \"value\": \"Client\",\n                    \"location\": [\n                        [\n                            8,\n                            5\n                        ],\n                        [\n                            17,\n                            6\n                        ]\n                    ]\n                },\n                \"CUI\": {\n                    \"value\": \"...exceel data...\",\n                    \"location\": [\n                        11,\n                        6\n                    ],\n                    \"label_value\": \"CIF:\",\n                    \"label_location\": [\n                        11,\n                        5\n                    ]\n                },\n                \"RegistrationName\": {\n                    \"value\": \"SOME COMPANY SRL\",\n                    \"location\": [\n                        9,\n                        5\n                    ],\n                    \"label_value\": \"n/a\",\n                    \"label_location\": \"n/a\"\n                },\n                \"PostalAddress\": {\n                    \"cbc_StreetName\": \"\",\n                    \"cbc_CityName\": \"...excel data...\",\n                    \"cbc_PostalZone\": \"\",\n                    \"cac_Country\": {\n                        \"cbc_IdentificationCode\": \"RO\"\n                    }\n                }\n            },\n            \"supplier_area\": \"...future...\"\n        },\n        \"invoice_footer_area\": {\n            \"start_cell\": [\n                26,\n                1\n            ],\n            \"end_cell\": [\n                31,\n                9\n            ]\n        }\n    }\n}\n</code></pre>"},{"location":"xl2roefact/tests/test_data_and_specs_originals/specs/_my_notes.html","title":"Note si observatii la diversele documente din <code>specs/</code>","text":"<ul> <li>Note si observatii la diversele documente din specs/<ul> <li>Specificatiile facturii electronice format XML</li> </ul> </li> </ul>"},{"location":"xl2roefact/tests/test_data_and_specs_originals/specs/_my_notes.html#specificatiile-facturii-electronice-format-xml","title":"Specificatiile facturii electronice format <code>XML</code>","text":"<ul> <li> (piu 231106) in doc <code>SR-EN-16931-12017.pdf</code> pagina 32 contine modelul de date facturii (downloaded as <code>ModelFactura_pg32.pdf</code>)</li> <li>...</li> </ul>"}]}