
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Petre Iordanescu, RENware Software Systems, petre.iordanescu@gmail.com">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Print Site - INVOICEtoROefact</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ecc896b0.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64H64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64 32-32z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zm-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.4c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4V32zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zm-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4l-45.6-16.8zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16h-8z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1zM96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0h-32zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>');}</style>


    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-invoicetoroefact" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="INVOICEtoROefact" class="md-header__button md-logo" aria-label="INVOICEtoROefact" data-md-component="logo">
      
  <img src="doc_src/pictures/api_to_roefact_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            INVOICEtoROefact
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        INVOICEtoROefact
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="xl2roefact/index.html" class="md-tabs__link">
        xl2roefact
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="doc_src/wip.html" class="md-tabs__link">
        web2roefact
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="xl2roefact/doc/README_xl2roefact_library.html" class="md-tabs__link">
        xl2roefact PyPi library
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="excel_invoice_template/index.html" class="md-tabs__link">
        invoice template
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="doc_src/help/880.30-EUMA_catalog.html" class="md-tabs__link">
        Help
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="doc_src/wip.html" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="INVOICEtoROefact" class="md-nav__button md-logo" aria-label="INVOICEtoROefact" data-md-component="logo">
      
  <img src="doc_src/pictures/api_to_roefact_logo.png" alt="logo">

    </a>
    INVOICEtoROefact
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          INVOICEtoROefact
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          INVOICEtoROefact
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Acasa
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/810-DSGN/810.05a-system_components.html" class="md-nav__link">
        Componentele sistemului
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/index.html" class="md-nav__link">
        xl2roefact
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/wip.html" class="md-nav__link">
        web2roefact
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/doc/README_xl2roefact_library.html" class="md-nav__link">
        xl2roefact PyPi library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="excel_invoice_template/index.html" class="md-nav__link">
        invoice template
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          xl2roefact
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          xl2roefact
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/index.html" class="md-nav__link">
        Descriere
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/index.html#comenzile-aplicatiei" class="md-nav__link">
        Referinta CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/LICENSE" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          web2roefact
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          web2roefact
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/wip.html" class="md-nav__link">
        Descriere
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          xl2roefact PyPi library
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          xl2roefact PyPi library
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/doc/README_xl2roefact_library.html" class="md-nav__link">
        Descriere
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/doc/810.05a-xl2roefact_DLD_specs.html" class="md-nav__link">
        Referinta API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="xl2roefact/LICENSE" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          invoice template
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          invoice template
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="excel_invoice_template/index.html" class="md-nav__link">
        Descriere
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="excel_invoice_template/LICENSE" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Help
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Help
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          Manuale web2roefact
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Manuale web2roefact
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/help/880.30-EUMA_catalog.html" class="md-nav__link">
        Index manuale End User (EUMA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/help/880.30-ADMA_catalog.html" class="md-nav__link">
        Index manuale Administrare (ADMA)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
          Cerintele sistemului
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Cerintele sistemului
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/commercial_agreement/110-SRE-general_requirements.html" class="md-nav__link">
        Considerente tehnice generale
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/commercial_agreement/110-SRE-api_to_roefact_requirements.html" class="md-nav__link">
        Sistem INVOICEtoROefact
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html" class="md-nav__link">
        Sistem PayValidaBoa
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/commercial_agreement/agreed_options.html" class="md-nav__link">
        Specificatii si optiuni tehnice
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pdfs/print_page.html/print_page.pdf" class="md-nav__link">
        Manual INVOICEtoROefact (PDF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/downloads.html" class="md-nav__link">
        Descarcare resurse (Downloads)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="doc_src/wip.html" class="md-nav__link">
        Despre INVOICEtoROefact
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.renware.eu/support.html" class="md-nav__link">
        Suport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.renware.eu/contact.html" class="md-nav__link">
        Contact
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.renware.eu/resources.html#how-to-buy-from-renware" class="md-nav__link">
        Cum cumpar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="LICENSE" class="md-nav__link">
        Licenta generala sistem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CHANGELOG.html" class="md-nav__link">
        CHANGELOG sistem
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#section-invoicetoroefact" class="md-nav__link">
    I. INVOICEtoROefact
  </a>
  
    <nav class="md-nav" aria-label="I. INVOICEtoROefact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    1. Acasa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doc_src-810-dsgn-810.05a-system_components" class="md-nav__link">
    2. Componentele sistemului
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xl2roefact-index" class="md-nav__link">
    3. xl2roefact
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doc_src-wip" class="md-nav__link">
    4. web2roefact
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xl2roefact-doc-readme_xl2roefact_library" class="md-nav__link">
    5. xl2roefact PyPi library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excel_invoice_template-index" class="md-nav__link">
    6. invoice template
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-xl2roefact" class="md-nav__link">
    II. xl2roefact
  </a>
  
    <nav class="md-nav" aria-label="II. xl2roefact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xl2roefact-index" class="md-nav__link">
    7. Descriere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xl2roefact-license" class="md-nav__link">
    8. License
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-web2roefact" class="md-nav__link">
    III. web2roefact
  </a>
  
    <nav class="md-nav" aria-label="III. web2roefact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#doc_src-wip" class="md-nav__link">
    9. Descriere
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-xl2roefact-pypi-library" class="md-nav__link">
    IV. xl2roefact PyPi library
  </a>
  
    <nav class="md-nav" aria-label="IV. xl2roefact PyPi library">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xl2roefact-doc-readme_xl2roefact_library" class="md-nav__link">
    10. Descriere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs" class="md-nav__link">
    11. Referinta API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xl2roefact-license" class="md-nav__link">
    12. License
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-invoice-template" class="md-nav__link">
    V. invoice template
  </a>
  
    <nav class="md-nav" aria-label="V. invoice template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#excel_invoice_template-index" class="md-nav__link">
    13. Descriere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excel_invoice_template-license" class="md-nav__link">
    14. License
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-help" class="md-nav__link">
    VI. Help
  </a>
  
    <nav class="md-nav" aria-label="VI. Help">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#doc_src-downloads" class="md-nav__link">
    15. Descarcare resurse (Downloads)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-about" class="md-nav__link">
    VII. About
  </a>
  
    <nav class="md-nav" aria-label="VII. About">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#doc_src-wip" class="md-nav__link">
    16. Despre INVOICEtoROefact
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    17. CHANGELOG sistem
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-add-full-url print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        
                        <h1 class='nav-section-title' id='section-invoicetoroefact'>
                            INVOICEtoROefact <a class='headerlink' href='#section-invoicetoroefact' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="index"><p><img alt="api_to_roefact_logo" src="doc_src/pictures/api_to_roefact_logo.png" width="300" /></p>
<p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="index-invoicetoroefact">INVOICEtoROefact</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#index-invoicetoroefact">INVOICEtoROefact</a><ul>
<li><a href="#index-componentele-si-facilitatile-sistemului">Componentele si facilitatile sistemului</a></li>
<li><a href="#index-date-identificare">Date identificare</a></li>
</ul>
</li>
</ul>
</div>
<p>Acest sistem va asigura incarcarea facturilor emise in sistemul <a href="https://www.anaf.ro/anaf/internet/ANAF/despre_anaf/strategii_anaf/proiecte_digitalizare/e.factura">ANAF E-Factura</a>.</p>
<h2 id="index-componentele-si-facilitatile-sistemului">Componentele si facilitatile sistemului</h2>
<p>Sistemul ofera urmatoarele componente:</p>
<ul>
<li>
<p><strong><a href="#xl2roefact-index">xl2roefact</a></strong> - procesarea facturilor in mod linie de comanda</p>
</li>
<li>
<p><strong>web2roefact</strong> - procesarea facturilor din interfara web  <!--#TODO link tbd --></p>
</li>
<li>
<p><strong><a href="#xl2roefact-doc-readme_xl2roefact_library">xl2roefact PyPi library</a></strong> - procesarea facturilor prin cod / program (development propriu)</p>
</li>
<li>
<p><strong><a href="#excel_invoice_template-index">invoice template</a></strong> - model / sablon factura in Excel</p>
</li>
</ul>
<p><a href="#doc_src-810-dsgn-810.05a-system_components">Descrierea tuturor acestora poate fi accessata aici</a>.</p>
<h2 id="index-date-identificare">Date identificare</h2>
<ul>
<li>p/n: <code>0000-0095</code></li>
<li>code-name: <code>api_to_roefact</code></li>
<li>commercial name: <strong>INVOICEtoROefact</strong></li>
<li><a href="https://invoicetoroefact.renware.eu/">site web</a></li>
<li><a href="https://github.com/petre-renware/api_to_roefact">git repository</a></li>
<li>copyright: RENware Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
<li><a href="#license" title="download">general system license</a></li>
</ul></section><section class="print-page" id="doc_src-810-dsgn-810.05a-system_components"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="doc_src-810-dsgn-810.05a-system_components-componentele-sistemului">Componentele sistemului</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-componentele-sistemului">Componentele sistemului</a><ul>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-componente">Componente</a><ul>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-xl2roefact">xl2roefact</a></li>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-web2roefact">web2roefact</a></li>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-xl2roefact-pypi-library">xl2roefact PyPi library</a></li>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-invoice-template">invoice template</a></li>
</ul>
</li>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">Criterii de clasificare</a></li>
<li><a href="#doc_src-810-dsgn-810.05a-system_components-note">Note</a></li>
</ul>
</li>
</ul>
</div>
<p>Sistemul consta din mai multe componente toate avind acelasi obiectiv central: <strong>emiterea de facturi si procesarea facturilor emise existente deja</strong>. Faptul ca sunt mai multe componente asigura <em>mai multe cai alternative</em> de a atinge obiectivul central, cai ce pot fi utilizate in paralel (concurent, in acelasi timp) in functie de "dotarea tehnica" a fiecaruia, de afinitatea fiecaruia la un "gen" de sisteme sau pur si simplu de preferinta de moment a fiecaruia.</p>
<h2 id="doc_src-810-dsgn-810.05a-system_components-componente">Componente</h2>
<p>Sistemul ofera urmatoarele componente:</p>
<ul>
<li>
<p><strong><a href="#doc_src-810-dsgn-810.05a-system_components-xl2roefact">xl2roefact</a></strong> - procesarea facturilor in mod linie de comanda</p>
</li>
<li>
<p><strong><a href="#doc_src-810-dsgn-810.05a-system_components-web2roefact">web2roefact</a></strong> - procesarea facturilor din interfara web</p>
</li>
<li>
<p><strong><a href="#doc_src-810-dsgn-810.05a-system_components-xl2roefact-pypi-library">xl2roefact PyPi library</a></strong> - procesarea facturilor prin cod / program (development propriu)</p>
</li>
<li>
<p><strong><a href="#doc_src-810-dsgn-810.05a-system_components-invoice-template">invoice template</a></strong> - model / sablon factura in Excel</p>
</li>
</ul>
<p>Facilitatile generale ale fiecareia din acestea sunt prezentate in continuare.</p>
<h3 id="doc_src-810-dsgn-810.05a-system_components-xl2roefact">xl2roefact</h3>
<p>Aplicatie <em>linie de comanda</em> pentru procesarea facturilor. Facilitati (<em><a href="#doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">vezi "Criterii de clasificare"</a></em>):  <!-- (stat: WIP) --></p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> OpM CLI</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM WEB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp XLSX</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> INp FORM</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp XML</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp EXCEL</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp PDF</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> R2R</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> ROeF</li>
</ul>
<p><a class="md-button" href="#xl2roefact-index">Descriere detaliata aici</a></p>
<h3 id="doc_src-810-dsgn-810.05a-system_components-web2roefact">web2roefact</h3>
<p>Aplicatie <em>web</em> pentru procesarea facturilor. Facilitati (<em><a href="#doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">vezi "Criterii de clasificare"</a></em>):  <!-- (stat: TBD) --></p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM CLI</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> OpM WEB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp XLSX</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp FORM</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp XML</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp EXCEL</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp PDF</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> R2R</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> ROeF</li>
</ul>
<!--#TODO_tbd... [Descriere detaliata aici](../../xxx/README.md){ .md-button } -->

<h3 id="doc_src-810-dsgn-810.05a-system_components-xl2roefact-pypi-library">xl2roefact PyPi library</h3>
<p>Pachet (biblioteca) public <em>Python</em> utilizabil pentru dezvoltare / extindere aplicatii proprii. Facilitati (<em><a href="#doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">vezi "Criterii de clasificare"</a></em>):  <!-- (stat: WIP) --></p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM CLI</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM WEB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp XLSX</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> INp FORM</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp XML</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp EXCEL</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp PDF</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> R2R</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> ROeF</li>
</ul>
<!-- README: activated on 240202 h04;30  #FIXME drop after publish -->
<p><a class="md-button" href="#xl2roefact-doc-readme_xl2roefact_library">Descriere detaliata aici</a></p>
<h3 id="doc_src-810-dsgn-810.05a-system_components-invoice-template">invoice template</h3>
<p>Sablon factura in format <em>Office Excel</em>. Facilitati (<em><a href="#doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">vezi "Criterii de clasificare"</a></em>):  <!-- status: DONE --></p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM CLI</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> OpM WEB</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> INp XLSX</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> INp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> INp FORM</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> EXp JSON</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> EXp XML</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> EXp EXCEL</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> EXp PDF</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> R2R</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> ROeF</li>
</ul>
<p><a class="md-button" href="#excel_invoice_template-index">Descriere detaliata aici</a></p>
<h2 id="doc_src-810-dsgn-810.05a-system_components-criterii-de-clasificare">Criterii de clasificare</h2>
<p>In scopul identificarii mai usoare a componentelor necesare acestea sunt clasificate dupa urmatoarele criterii:</p>
<ul>
<li>
<p><strong>OpM</strong> modul de operare al componentei:</p>
<ul>
<li><strong>CLI</strong> specifica o componenta ce va fi executata in mod linie de comanda (Windows din <code>Command</code>, Linux din <code>Terminal</code>)</li>
<li><strong>WEB</strong> specifica o componenta ce va fi accesata dintr-un browser</li>
</ul>
</li>
<li>
<p><strong>INp</strong>  modul de introducere si import a facturii:</p>
<ul>
<li><strong>XLSX</strong> import dintr-un document <code>Office Excel</code> unde a fost deja introdusa anterior preluarii. Ca si instrument de introducere poate fi folosit oricare din cele ce permit salvarea / exportul in format <code>XLSX</code> (alte formate, in special cel anterior - <code>XLS</code> nu sunt importabile - ci trebuiesc "convertite" la formatul <code>xlsx</code>)</li>
<li><strong>JSON</strong> import din format <code>JSON</code></li>
<li><strong>FORM</strong> factura se poate introduce manual direct in sistem, acesta punind la dispozitie un formular dedicat acestei operatii</li>
</ul>
</li>
<li>
<p><strong>EXp</strong> formatul de exportare a facturilor<sup id="fnref:out_fmt"><a class="footnote-ref" href="#doc_src-810-dsgn-810.05a-system_components-fn:out_fmt">1</a></sup>:</p>
</li>
<li><strong>JSON</strong> format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>REST</code> (de exemplu <em>Oracle EBS</em>)</li>
<li><strong>XML</strong> format folosit pentru interschimbarea, interfatarea datelor cu sisteme standard <code>SOAP</code><sup id="fnref:xml_schemas"><a class="footnote-ref" href="#doc_src-810-dsgn-810.05a-system_components-fn:xml_schemas">2</a></sup> (de exemplu <em>RO eFact</em>, <em>SAP</em>)</li>
<li><strong>EXCEL</strong> format Office Excel <code>xlsx</code></li>
<li>
<p><strong>PDF</strong> format Adobe PDF tiparibil</p>
</li>
<li>
<p><strong>R2R</strong> specifica faptul ca acea componenta poate fi folosita ca atare, fara o instalare prealabila ("ready to run") altfel aceasta trebuie instalata inainte de utilizare</p>
</li>
<li>
<p><strong>ROeF</strong> specifica faptul ca acea componenta permite incarcarea automata<sup id="fnref:load_spv"><a class="footnote-ref" href="#doc_src-810-dsgn-810.05a-system_components-fn:load_spv">3</a></sup> a facturii in sistemul <em>ANAF SPV RO eFact</em></p>
</li>
</ul>
<h2 id="doc_src-810-dsgn-810.05a-system_components-note">Note</h2>
<div class="footnote">
<hr />
<ol>
<li id="doc_src-810-dsgn-810.05a-system_components-fn:out_fmt">
<p>Exportul facturilor in formatele <code>EXCEL</code> si respectiv <code>PDF</code> se face utilizind <em>formatul vizual al documentului din componenta <code>invoice template</code></em>&#160;<a class="footnote-backref" href="#doc_src-810-dsgn-810.05a-system_components-fnref:out_fmt" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="doc_src-810-dsgn-810.05a-system_components-fn:xml_schemas">
<p>schemele <code>XML</code> respectate sunt: <code>"xmlns": "urn:oasis:names:specification:ubl:schema:xsd:Invoice-2"</code>, <code>"xmlns:cbc": "urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2"</code>, <code>"xmlns:cac": "urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2"</code>, <code>"xmlns:ns4": "urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2"</code>, <code>"xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance"</code>, <code>"xsi:schemaLocation": "urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 http://docs.oasis-open.org/ubl/os-UBL-2.1/xsd/maindoc/UBL-Invoice-2.1.xsd"</code>&#160;<a class="footnote-backref" href="#doc_src-810-dsgn-810.05a-system_components-fnref:xml_schemas" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="doc_src-810-dsgn-810.05a-system_components-fn:load_spv">
<p>incarcarea automata a facturii in sistemul <code>ANAF RO eFact</code> este conditionata de configurarea respectivei componente cu credentialele necesare autentificarii in acest sistem (altfel acesta informatie va fi ceruta utilizatorui pentru introducere manuala)&#160;<a class="footnote-backref" href="#doc_src-810-dsgn-810.05a-system_components-fnref:load_spv" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><h1 class='nav-section-title-end'>Ended: INVOICEtoROefact</h1>
                        <h1 class='nav-section-title' id='section-xl2roefact'>
                            xl2roefact <a class='headerlink' href='#section-xl2roefact' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="xl2roefact-index"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="xl2roefact-index-xl2roefact">xl2roefact</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#xl2roefact-index-xl2roefact">xl2roefact</a><ul>
<li><a href="#xl2roefact-index-facilitati">Facilitati</a></li>
<li><a href="#xl2roefact-index-instalarea-aplicatiei-xl2roefact">Instalarea aplicatiei xl2roefact</a></li>
<li><a href="#xl2roefact-index-configurarea-aplicatiei-xl2roefact">Configurarea aplicatiei xl2roefact</a></li>
<li><a href="#xl2roefact-index-comenzile-aplicatiei">Comenzile aplicatiei</a><ul>
<li><a href="#xl2roefact-index-xl2roefact_1">xl2roefact</a><ul>
<li><a href="#xl2roefact-index-about">about</a></li>
<li><a href="#xl2roefact-index-settings">settings</a></li>
<li><a href="#xl2roefact-index-xl2json">xl2json</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#xl2roefact-index-practici-si-regului-referitoare-la-continutul-facturilor-din-excel">Practici si regului referitoare la continutul facturilor din Excel</a></li>
<li><a href="#xl2roefact-index-tutorial-utilizare-aplicatie">Tutorial utilizare aplicatie</a><ul>
<li><a href="#xl2roefact-index-organizarea-informatiei">Organizarea informatiei</a></li>
<li><a href="#xl2roefact-index-exemplu-de-procesare-a-unei-facturi">Exemplu de procesare a unei facturi</a></li>
</ul>
</li>
<li><a href="#xl2roefact-index-aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii">Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</a></li>
<li><a href="#xl2roefact-index-descarcare-download-aplicatie-xl2roefact-cli">Descarcare (download) aplicatie xl2roefact CLI</a><ul>
<li><a href="#xl2roefact-index-arhiva-versiuni-publicate-disponibile">Arhiva versiuni publicate disponibile</a></li>
</ul>
</li>
<li><a href="#xl2roefact-index-date-identificare">Date identificare</a></li>
<li><a href="#xl2roefact-index-license">License</a></li>
<li><a href="#xl2roefact-index-note">Note</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="xl2roefact-index-facilitati">Facilitati</h2>
<p><img alt="Static Badge" src="https://img.shields.io/badge/MSI_installer-YES-blue" />
<img alt="Static Badge" src="https://img.shields.io/badge/format_JSON-YES-orange" />
<img alt="Static Badge" src="https://img.shields.io/badge/format_XML-YES-orange" />
<img alt="Static Badge" src="https://img.shields.io/badge/format_PDF-YES-orange" />
<img alt="Static Badge" src="https://img.shields.io/badge/format_RO_eFact-YES-blue" /></p>
<p>Aceasta componenta este "totul despre crearea de facturi electronice" din formatul Excel office (xlsx). Aplicatia poate genera factura in format JSON, XML, PDF si o poate incarca in sistemul <em>RO E-Fact</em><sup id="fnref:ld_roefact"><a class="footnote-ref" href="#xl2roefact-index-fn:ld_roefact">1</a></sup>.</p>
<p>Aceasta componenta ofera urmatoarele facilitati (acestea fiind obiectivele fundamentale ale componentei):</p>
<ul>
<li>
<p><strong>transformarea facturilor din Excel in formatul <code>XML</code></strong> cerut de catre sistemul ANAF RO E-Fact pentru incarcare</p>
</li>
<li>
<p><strong>incarcarea acestora</strong> in sistemul ANAF RO E-Fact<sup id="fnref2:ld_roefact"><a class="footnote-ref" href="#xl2roefact-index-fn:ld_roefact">1</a></sup></p>
</li>
<li>
<p><strong>transformarea facturilor din Excel intr-un format <code>JSON</code></strong>  intermediar, independent de platforma si care permite integrarea acestora cu alte sisteme (standard <em>REST</em>)</p>
</li>
<li>
<p><strong>generarea facturii in format PDF</strong> pentru transmiterea acesteia catre client, semnarea electronica, tiparirea si arhivarea acesteia in format fizic (in general manipularea facturii in format <em>"human readable"</em>)</p>
</li>
</ul>
<p>Componenta ofera doua instrumente pentru realizarea si indeplinirea acestor obiective:</p>
<ul>
<li>
<p><code>xl2roefact</code> o <strong>aplicatie de tip linie de comanda</strong> (disponibila pentru sistemele de operare Windows, Linux si MacOS)</p>
</li>
<li>
<p><code>xl2roefact PyPi</code> o <strong>blioteca standard Python</strong> utilizabila pentru dezvoltari proprii in scopul extinderii altor sisteme existente (<em>custom development</em>)</p>
</li>
</ul>
<h2 id="xl2roefact-index-instalarea-aplicatiei-xl2roefact">Instalarea aplicatiei xl2roefact</h2>
<p>Pachetele de instalare se gasesc in directorul <code>dist/</code> ca arhive <code>ZIP</code>. Pachetele disponibile contin in numele lor versiunea de aplicatie utilizata si sistemul de operare pentru care sunt disponibile:</p>
<ul>
<li><strong><code>MSI</code></strong> pachet instalare pentru <em>Windows</em></li>
<li><code>DEB</code> pachet instalare pentru <em>Linux Debian</em> (verificati disponibilitatea pentru varianta sistemuluu de operare folosit de dvs)</li>
<li><code>EXE</code> executabil <em>Windows in format "portabil" (un singur fisier)</em></li>
</ul>
<blockquote>
<p><em>NOTA 1:</em> pentru echivalent utilizare  <em>portabila pentru Linux</em> se va instala biblioteca Python (<a href="#xl2roefact-doc-readme_xl2roefact_library">vezi sectiunea <code>xl2roefact PyPi library</code></a>) dupa care devine utilizabil scriptul Python "ca orice alta comanda Linux"</p>
<p><em>NOTA 2:</em> pachetul <code>MSI</code> pentru <em>Windows</em> este disponibil in orice variante / versiuni al sistemului. Optiunile pentru <em>Linux</em> sunt mult mai flexibile si astfel celelalte pot lipsi insa pot fi disponibile graruit, la cerere.</p>
</blockquote>
<h2 id="xl2roefact-index-configurarea-aplicatiei-xl2roefact">Configurarea aplicatiei xl2roefact</h2>
<p>Parametrii de configurare a plicatiei se gasesc in fisierul <strong><code>config_settings.py</code></strong>. Acestia sunt sub elaborati in limbaj Python prin utilizarea conventiilor de constante conform recomandarilor PEP (numele capitatlizat) si sunt acompaniti de linii de explicatii privind aplicabilitatea lor.</p>
<p>Configurare aplicatiei se poate face interactiv si din aplicatie. Pentru a obtine help referitor la detaliile comenzi se va folosi
<div class="highlight"><pre><span></span><code>xl2roefact<span class="w"> </span>settings<span class="w"> </span>--help
</code></pre></div></p>
<h2 id="xl2roefact-index-comenzile-aplicatiei">Comenzile aplicatiei</h2>
<p>Interfata aplicatie este realizata utilizind conventiile si practicile uzuale pentru aplicatii tip linie de comanda consola. Pentru informatii privind comenzile se poate folosi optiunea de <strong>help</strong>, dispobilia atit la nivelul general:
<div class="highlight"><pre><span></span><code>xl2roefact<span class="w"> </span>--help
</code></pre></div>
cit si la nivel detaliat pentru fiecare comanda
<div class="highlight"><pre><span></span><code>xl2roefact<span class="w"> </span><span class="o">[</span>COMMAND<span class="o">]</span><span class="w"> </span>--help
</code></pre></div></p>
<p><strong>Lista comenzilor:</strong></p>
<ul>
<li>
<p><strong>about</strong> - Afiseaza informatii despre aceatsa aplicatie (copyright, scop, etc)</p>
</li>
<li>
<p><strong>settings</strong> _ Afiseaza parametrii de configurare a aplicatiei. <a href="#xl2roefact-index-configurarea-aplicatiei-xl2roefact">Vezi sectiunea de configurare a aplicatiei</a></p>
</li>
<li>
<p><strong>xl2json</strong> - Transforma fisierul (fisierele) Excel in forma JSON pentru utilizare ulterioara ca forma de date standardizat pentru schimbul de informatii cu alte sisteme electronice</p>
</li>
</ul>
<p><strong>Detalii comenzi:</strong></p>
<p><a id="comenzile-aplicatiei"></a>  <!-- #NOTE ATTN do not drop this anchor tag because is referred in <code>mkdocs.yml</code> navigation section --></p>
<!--#NOTE: next section will generate application commands in style as obtained using `--help` CLI options -->
<h3 id="xl2roefact-index-xl2roefact_1">xl2roefact</h3>
<p>function called when no command is invoked and to provide only application version (for external users to test it!).</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><code>xl2roefact [OPTIONS] COMMAND [ARGS]...
</code></pre></div>
<p>Options:</p>
<div class="highlight"><pre><span></span><code>  --version             show application version
  --install-completion  Install completion for the current shell.
  --show-completion     Show completion for the current shell, to copy it or
                        customize the installation.
</code></pre></div>
<h4 id="xl2roefact-index-about">about</h4>
<p>provide a short application description.</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><code>xl2roefact about [OPTIONS]
</code></pre></div>
<h4 id="xl2roefact-index-settings">settings</h4>
<p>display application configuration parameters and settings that are subject to be changed by user.</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><code>xl2roefact settings [OPTIONS]
</code></pre></div>
<h4 id="xl2roefact-index-xl2json">xl2json</h4>
<p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p>
<p>Args:
    <code>file_name</code>: files to process (wildcards allowed).
    <code>files_directory</code>: directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead
    <code>verbose</code>: show detailed processing messages" Defaults to <code>False</code>.</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><code>xl2roefact xl2json [OPTIONS] [FILE_NAME]
</code></pre></div>
<p>Options:</p>
<div class="highlight"><pre><span></span><code>  [FILE_NAME]                     files to process (wildcards allowed)
                                  [default: *.xlsx]
  -d, --files-directory DIRECTORY
                                  directory to be used to look for Excel files
                                  (if default directory does not exists will
                                  consider current directory instead).
                                  [default: invoice_files/]
  -v, --verbose                   show detailed processing messages
</code></pre></div>
<h2 id="xl2roefact-index-practici-si-regului-referitoare-la-continutul-facturilor-din-excel">Practici si regului referitoare la continutul facturilor din Excel</h2>
<p>Acest capitol se refera la modul in care este "tratat" continutul fisierului Excel cu factura, mai exact la modalitatea in care informatia facturii este cautata, identificata si gasita in scopul de a fi salvata in oricare din formatele de "factura electronica / E-Fact".</p>
<p>Utilizarea sablonului de factura Excel ce este livrat impreuna cu aplicatia <strong>ESTE O VARIANTA DE LUCRU RECOMANDATA</strong>, dar nu obligatorie. Chiar si in cazul utilizarii acestuia, prin modificarea "structurii" acestuia, informatia poate ajunge <em>nerecognoscibila / neidentificabila</em> total sau partial daca nu sunt urmate regulile expuse.</p>
<blockquote>
<p>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</p>
<p>Mai exact <strong>continutul informational</strong> al facturii nu trebuie nici confundat si nici mixat cu <strong>formatul de afisare al acesteia</strong> (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere <em>regulile de formatare</em> din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p>
<ul>
<li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li>
<li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li>
</ul>
</blockquote>
<h2 id="xl2roefact-index-tutorial-utilizare-aplicatie">Tutorial utilizare aplicatie</h2>
<h3 id="xl2roefact-index-organizarea-informatiei">Organizarea informatiei</h3>
<p>Aplicatia <em>xl2roefact</em> "promoveaza" structurarea informatiei procesate astfel incit sa fie evitata situatia <em>"de aglomerare" a directorului curent cu fisiere</em> ce trebuiesc identificate si izolate in situatia in care se fac <em>procesari in masa</em> (pe mai multe fisiere / facturi sursa).</p>
<p>Astfel, aplicatia se asteapa ca fisierele Excel sursa (<em>adica facturile de procesat</em>) sa fie copiate in directorul <strong><code>invoice_files/</code></strong> de unde vor fi citite si tot aici vor fi create fisierele rezultate (JSON, XML, etc). Acest director este relativ la directorul curent de unde este lansata aplicatia si considerat <em>"implicit"</em> cu acest nume dar daca se doreste un alt director acest lucru poate fi facut folosind parametrul <em><code>--files-directory</code></em> (sau prescurtat <em><code>-d</code></em>) la lansarea aplicatiei astfel:
<div class="highlight"><pre><span></span><code>xl2roefact -d &quot;calea si numele directorului dorit&quot;
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><small markdown="1">Ghilimelele sunt necesare numai daca numele si calea (<code>path</code>) contin caracterul spatiu.</small></p>
</div>
<p><strong>Exemple:</strong></p>
<ul>
<li>
<p>pentru stabilirea directorului curent ca sursa pentru fisierele factura Excel: <strong><code>xl2roefact -d ./</code></strong></p>
</li>
<li>
<p>procesarea tuturor facturilor facturilor din luna <em>iunie</em>, copiate intr-un director dedicat sub directorul curent: <strong><code>xl2roefact -d ./facturi_iunie/</code></strong></p>
</li>
</ul>
<h3 id="xl2roefact-index-exemplu-de-procesare-a-unei-facturi">Exemplu de procesare a unei facturi</h3>
<ul>
<li>se creaza directorul <code>invoice_files</code></li>
<li>se copiaza factura <code>factura_A.xlsx</code> in acest director apoi se revine in directorul anterior daca acesta a fost schimbat pentru efectuarea copierii</li>
<li>se lanseaza aplicatia: <code>xl2roefact xl2json</code></li>
</ul>
<p>In urma acestor operatii, in directorul <code>invoice_files</code> vor rezulta:</p>
<div class="highlight"><pre><span></span><code>ðŸ“<span class="w"> </span>invoice_files/
â”œâ”€â”€<span class="w"> </span>ðŸ“„<span class="w"> </span>factura_A.xlsx<span class="w">  </span><span class="c1"># fisierul Excel original</span>
â””â”€â”€<span class="w"> </span>ðŸ“„<span class="w"> </span>factura_A.json<span class="w">  </span><span class="c1"># fisierul JSON rezultat in urma procesarii</span>
</code></pre></div>
<ul>
<li><code>factura_A.xlsx</code> ca fiind fisierul Excel original cu factura</li>
<li><code>factura_A.json</code> acesta fiind fisierul format JSON rezultat in urma procesarii si ce poate fi folosit pentru interschimbarea electronica a informatiei intre sisteme</li>
</ul>
<h2 id="xl2roefact-index-aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii">Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</h2>
<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Formatul JSON are urmatoarra structura de baza:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;Invoice&quot;: {...},
    &quot;meta_info&quot;: {...},
    &quot;excel_original_data&quot;: {...}
}
</code></pre></div>
<p>Cheile de la primul nivel contin:</p>
<ul>
<li><strong><code>Invoice</code></strong> - datele efective ale facturii</li>
<li><strong><code>meta_info</code></strong><ul>
<li>informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul <em>RO E-Fact</em></li>
<li>harta de ajutor in conversia formatului JSON in formatul XML acceptat de sistemul RO E-Fact (cheie <code>meta_info.map_JSONkeys_XMLtags</code>) si definititiile XML aferente (cheie <code>meta_info.invoice_XML_schemes</code>)</li>
<li>alte informatii despre fisierul Excel prelucrat (numele, worksheet cu factura, data si ora procesarii, CRC pentru verificare, etc)</li>
</ul>
</li>
<li><strong><code>excel_original_data</code></strong> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru "a intelege" de unde si cum arata informatiile originale din fisierul Excel</li>
</ul>
<p><small markdown="1">Pentru detalii suplimentare despre formatul JSON trebyie consultata componenta referitoare la <strong><em><a href="#xl2roefact-doc-readme_xl2roefact_library">biblioteca <code>xl2roefact</code> destinata dezvoltarii software</a></em></strong>.</small></p>
<h2 id="xl2roefact-index-descarcare-download-aplicatie-xl2roefact-cli">Descarcare (download) aplicatie xl2roefact CLI</h2>
<ul>
<li>0.1.20.dev invoice customer address <a href="xl2roefact/dist/xl2roefact-0.1.20-win64.msi" title="download">MSI installer win64</a></li>
</ul>
<h3 id="xl2roefact-index-arhiva-versiuni-publicate-disponibile">Arhiva versiuni publicate disponibile</h3>
<ul>
<li>
<p>0.1.19.dev invoice customer and partial invoice total values calculations <a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19-win64.msi" title="download">MSI installer win64</a></p>
</li>
<li>
<p>0.1.18.dev invoice customer CUI partial invoice total values calculations <a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18-win64.msi" title="download">MSI installer win64</a></p>
</li>
</ul>
<h2 id="xl2roefact-index-date-identificare">Date identificare</h2>
<ul>
<li>part number (p/n): <code>0000-0095-xl2roefact</code></li>
<li>producator si copyright: RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<h2 id="xl2roefact-index-license"><a href="#xl2roefact-license" title="download">License</a></h2>
<h2 id="xl2roefact-index-note">Note</h2>
<div class="footnote">
<hr />
<ol>
<li id="xl2roefact-index-fn:ld_roefact">
<p>Toate interactiunile cu sistemul <em>ANAF RO E-Fact</em> necesita o <em>conexiune la internet</em> si un set de <em>credentiale ANAF RO E-Fact ale companiei</em> pentru care se incarca factura. In lipsa acestora, fisierul <code>XML</code> generat de aplicatie poate fi incarcat ulterior (de ex de catre departmentul contabilitate)&#160;<a class="footnote-backref" href="#xl2roefact-index-fnref:ld_roefact" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#xl2roefact-index-fnref2:ld_roefact" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><h1 class='nav-section-title-end'>Ended: xl2roefact</h1>
                        <h1 class='nav-section-title' id='section-web2roefact'>
                            web2roefact <a class='headerlink' href='#section-web2roefact' title='Permanent link'>â†µ</a>
                        </h1>
                        <h1 class='nav-section-title-end'>Ended: web2roefact</h1>
                        <h1 class='nav-section-title' id='section-xl2roefact-pypi-library'>
                            xl2roefact PyPi library <a class='headerlink' href='#section-xl2roefact-pypi-library' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="xl2roefact-doc-readme_xl2roefact_library"><!-- NOTE:
- This is the general technical design for `xl2roefactPyPi` component
- The DLD doc is a tech desc of every module, functions
-->

<h1 id="xl2roefact-doc-readme_xl2roefact_library-xl2roefact-pypi-library">xl2roefact PyPi library</h1>
<div class="toc">
<ul>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-xl2roefact-pypi-library">xl2roefact PyPi library</a><ul>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-system-modules">System modules</a><ul>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-rdinv-module-logic">rdinv module logic</a></li>
</ul>
</li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-install-library">Install library</a><ul>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-install-from-pypi">Install from PyPi</a></li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-install-from-distribution-packages">Install from distribution packages</a></li>
</ul>
</li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-working-directories">Working directories</a></li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii">Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</a></li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-api-reference">API Reference</a></li>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-download-xl2roefact-library">Download xl2roefact library</a><ul>
<li><a href="#xl2roefact-doc-readme_xl2roefact_library-arhiva-versiuni-publicate-disponibile">Arhiva versiuni publicate disponibile</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-system-modules">System modules</h2>
<p><code>xl2roefact</code> main and basic modules are:</p>
<ul>
<li><code>rdinv</code> read an Excel file and extract invoice data to a JSON file format</li>
<li><code>wrxml</code>  write, convert the JSON invoice file to a XML file format, respecting schemes required by <em>RO EFact</em> standard</li>
<li><code>chkxml</code> check generated XML file</li>
<li><code>ldxml</code> load an invoice (ie, its XML associated file) to <em>ANAF SPV system</em></li>
<li><code>chkisld</code> check if an invoice is already loaded in <em>ANAF SPV system</em></li>
<li><code>config_settings</code> define system settings &amp; parameters mainly used in invoice info / data detection and extract from invoice Excel format file</li>
<li><code>app_cli</code> contains the code for <code>xl2roefact</code> application command line (CLI) format</li>
</ul>
<p>Below is presented the <strong><em>skeleton logic</em></strong> of those modules which and where is relevant <small markdown="1">ie meaning where is not enough obvious from code or code complexity exceed usual limits (<em>for example nore than 100 lines of code per function</em>)</small>. For more technical details and specification regarding modules <a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs">see API Reference</a></p>
<h3 id="xl2roefact-doc-readme_xl2roefact_library-rdinv-module-logic">rdinv module logic</h3>
<p>Main function of <code>rdinv</code> module is <code>rdinv(...)</code> which has the following logic sections which are in <strong><em>strict sequence in presented order</em></strong>:</p>
<ul>
<li>
<p><em>search of <code>invoice_items_area</code> sub-table</em>. This area is expected to contain invoice lines and is "processed" first because it is more structured and easier to identify; after its identification the header area is considered upper of it and footer area below it</p>
</li>
<li>
<p><em>solve <code>invoice_items_area</code> in 2 step...</em>. In this step the code-data-variables of items area will be initialized in order to hold information that will be found</p>
</li>
<li>
<p><em>localize and mark areas for...</em> section that follows natural the previous one by initializing code-data-variables forcheader and footer areas to hold their corresponding information</p>
</li>
<li>
<p><em>solve <code>invoice_header_area</code></em> detailed initialize of header area code-data-variables</p>
</li>
<li>
<p><em><code>ReNaSt</code>-RegNameStrategy</em> section that identify and extract the legal registered name of invoice customer</p>
</li>
<li>
<p><em>section to ( Excel data )---&gt;( JSON ) format preparation and finishing</em> section which prepare Excel original data found to be be saved as JSON as a more "electronic interchangeable" structure</p>
</li>
<li>
<p>for more details about code logic description and presentation, please contact <a href="http://www.renware.eu">RENware Software Systems</a></p>
</li>
</ul>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-install-library">Install library</h2>
<p>Library can be installed using 2 methods:</p>
<ul>
<li>install from PyPi</li>
<li>install from distribution packages</li>
</ul>
<h3 id="xl2roefact-doc-readme_xl2roefact_library-install-from-pypi">Install from PyPi</h3>
<p>The library installation should be done using standard Python instruments:</p>
<div class="highlight"><pre><span></span><code>pip install xl2roefact
</code></pre></div>
<h3 id="xl2roefact-doc-readme_xl2roefact_library-install-from-distribution-packages">Install from distribution packages</h3>
<p>To install from distribution packages first download the package version intended to install (<a href="#xl2roefact-doc-readme_xl2roefact_library-download-xl2roefact-library">see download section</a>), choose the package type (if you have no special option, then choose <em><code>WHEEL</code></em> format) and install it using <code>pip</code> as any other Python library installation (<em>detailed in Python official documentation</em>).</p>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-working-directories">Working directories</h2>
<p>Below is a short description of most important directories that will (can !) be found on local development environment.</p>
<ul>
<li>
<p><em><code>invoice_files/</code></em> default directory for Excel files which is intended to be processed</p>
</li>
<li>
<p><em><code>build/</code></em> this directory which will contain intermediary files resulted from building CLI application, library distribution parts, etc. Directory is subject of <code>.gitignore</code></p>
</li>
<li>
<p><em><code>dist/</code></em> package files (wheels, dist), Windows executables, etc, generally all files subject of "public" distribution and download</p>
</li>
<li>
<p><em><code>test_*/</code></em> contains test invoice samples (from client, a RENware one, a 3rd party one) and some useful specs in dev &amp; test process</p>
</li>
</ul>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-aspecte-tehnice-referitoare-la-formatul-fisierului-json-aferent-facturii">Aspecte tehnice referitoare la formatul fisierului JSON aferent facturii</h2>
<p>Acest fisier este cel generat de catre aplicatie in urma executiei acesteia cu comanda <code>xl2json</code>. Structura de baza a acestui fisier este:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;Invoice&quot;: {...},
    &quot;meta_info&quot;: {...},
    &quot;excel_original_data&quot;: {...}
}
</code></pre></div>
<p>Cheile de la primul nivel contin:</p>
<ul>
<li><strong><code>Invoice</code></strong> - datele efective ale facturii</li>
<li><strong><code>meta_info</code></strong><ul>
<li>informatii referitoare la procesarea facturii si mapa de conversie a cheii <code>Invoice</code> din formatul <code>JSON</code> in formatul <code>XML</code> cerut de sistemul <em>RO E-Fact</em></li>
<li>harta de ajutor in conversia formatului JSON in formatul XML acceptat de sistemul RO E-Fact (cheie <code>meta_info.map_JSONkeys_XMLtags</code>) si definititiile XML aferente (cheie <code>meta_info.invoice_XML_schemes</code>)</li>
<li>alte informatii despre fisierul Excel prelucrat (numele, worksheet cu factura, data si ora procesarii, CRC pentru verificare, etc)</li>
</ul>
</li>
<li><strong><code>excel_original_data</code></strong> - informatiile originale din fisierul Excel, asa cum au fost ele identificate si gasite precum si locatia (adresele celulelor). Aceste informatii sunt utile in cazul in care exista neclaritati in urma procesuluicde conversie pentru "a intelege" de unde si cum arata informatiile originale din fisierul Excel</li>
</ul>
<p>An <a href="#xl2roefact-doc-invoice_json_model_">example of JSON generated file is available here</a></p>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-api-reference"><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs">API Reference</a></h2>
<h2 id="xl2roefact-doc-readme_xl2roefact_library-download-xl2roefact-library">Download xl2roefact library</h2>
<ul>
<li>0.1.20.dev invoice customer address <a href="xl2roefact/dist/xl2roefact-0.1.20-py3-none-any.whl" title="download">WHEEL</a></li>
<li>0.1.20.dev invoice customer address <a href="xl2roefact/dist/xl2roefact-0.1.20.tar.gz" title="download">DIST</a></li>
</ul>
<h3 id="xl2roefact-doc-readme_xl2roefact_library-arhiva-versiuni-publicate-disponibile">Arhiva versiuni publicate disponibile</h3>
<ul>
<li>0.1.19.dev invoice customer and partial invoice total values calculations <a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19-py3-none-any.whl" title="download">WHEEL</a></li>
<li>
<p>0.1.19.dev invoice customer and partial invoice total values calculations <a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19.tar.gz" title="download">DIST</a></p>
</li>
<li>
<p>0.1.18.dev invoice customer CUI partial invoice total values calculations <a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18-py3-none-any.whl" title="download">WHEEL</a></p>
</li>
<li>0.1.18.dev invoice customer CUI partial invoice total values calculations <a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18.tar.gz" title="download">DIST</a></li>
</ul></section><section class="print-page" id="xl2roefact-doc-810.05a-xl2roefact_dld_specs"><h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli">app_cli</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli.about">about</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli.settings">settings</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli.xl2json">xl2json</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli.called_when_no_command">called_when_no_command</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-chkisld">chkisld</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-chkxml">chkxml</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-config_settings">config_settings</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-config_settings.DEFAULT_SUPPLIER_COUNTRY">DEFAULT_SUPPLIER_COUNTRY</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-ldxml">ldxml</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-libutils">libutils</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-libutils.isnumber">isnumber</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-libutils.find_str_in_list">find_str_in_list</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv">rdinv</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv.rdinv">rdinv</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv.get_excel_data_at_label">get_excel_data_at_label</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv.mk_kv_invoice_items_area">mk_kv_invoice_items_area</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv.get_invoice_items_area">get_invoice_items_area</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-wrxml">wrxml</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-__init__">__init__</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-__main__">__main__</a></li>
<li><a href="#xl2roefact-doc-810.05a-xl2roefact_dld_specs-__version__">__version__</a></li>
</ul>
<p><a id="app_cli"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-app_cli">app_cli</h1>
<p>app_cli: the command line application for all xl2roefact functionalities.</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>xl2roefact</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Deployments:</p>
<ul>
<li>Windows:  MSI installer with EXE application.</li>
<li>Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</li>
</ul>
<p>Specifications:</p>
<ul>
<li>command general format: <code>xl2roefact [file(s)-to-convert] COMMAND [OPTIONS]</code>.</li>
<li>help: <code>xl2roefact [COMMAND] --help</code>.</li>
</ul>
<p><a id="app_cli.about"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-about">about</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app_cli</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">()</span>
</code></pre></div>
<p>provide a short application description.</p>
<p><a id="app_cli.settings"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-settings">settings</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app_cli</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="n">rules</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
    <span class="nb">bool</span><span class="p">,</span>
    <span class="n">typer</span><span class="o">.</span>
    <span class="n">Option</span><span class="p">(</span><span class="s2">&quot;--rules&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;show settings recommended update rules&quot;</span><span class="p">),</span>
<span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>display application configuration parameters and settings that are subject to be changed by user.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>rules</code> - show recommended rules to follow when change application configurable settings (available in both RO &amp; EN languages). Defaults to <code>False</code>.</li>
</ul>
<p><a id="app_cli.xl2json"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-xl2json">xl2json</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app_cli</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">xl2json</span><span class="p">(</span>
    <span class="n">file_name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Argument</span><span class="p">(</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;files to process (wildcards allowed)&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;*.xlsx&quot;</span><span class="p">,</span>
    <span class="n">files_directory</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;--files-directory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
            <span class="n">exists</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">file_okay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dir_okay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">writable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">readable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">resolve_path</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span>
            <span class="s2">&quot;directory to be used to look for Excel files (if default directory does not exists will consider current directory instead).&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;invoice_files/&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">bool</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span>
        <span class="n">Option</span><span class="p">(</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;show detailed processing messages&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>extract data from an Excel file (save data to JSON format file with the same name as original file but <code>.json</code> extension).</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>file_name</code> - files to process (wildcards allowed).</li>
<li><code>files_directory</code> - directory to be used to look for Excel files. Defaults to <code>invoice_files/</code>. NOTE: if default directory does not exists will consider current directory instead</li>
<li><code>verbose</code> - show detailed processing messages". Defaults to <code>False</code>.</li>
</ul>
<p><a id="app_cli.called_when_no_command"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-called_when_no_command">called_when_no_command</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app_cli</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">invoke_without_command</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">called_when_no_command</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">typer</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">bool</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="s2">&quot;--version&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;show application version&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>function called when no command is invoked and to provide only application version (for external users to test it!).</p>
<p><a id="chkisld"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-chkisld">chkisld</h1>
<p>chkisld: modul de verificare a starii de incarcare a unei facturi emise</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>chkisld</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Specifications:</p>
<ul>
<li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li>
<li>INTRARI: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii</li>
<li>IESIRI: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata</li>
</ul>
<p><a id="chkxml"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-chkxml">chkxml</h1>
<p>chkxml: modul de validare a facturii in sistemul ANAF E-Factura</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>chkxml</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Specifications:</p>
<ul>
<li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li>
<li>INTRARI: fisier <code>f-XML</code></li>
<li>IESIRI: raport cu eventualele erori de validare</li>
</ul>
<p><a id="config_settings"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-config_settings">config_settings</h1>
<p>Configuration and setting parameters.  <!-- <code>TODO</code> all of these are subject to documentation update (sectiune "RULES FOR INVOICE data in Excel") --></p>
<p>(en-us) README before making changes:</p>
<ul>
<li>each parameter has a short help (lines starting with <code>#</code> character) - read it before changing that parameter</li>
<li>do not change parametrs name as specified before equal (<code>=</code>) sign</li>
<li>lists are enclosed in sqaured brackets (<code>[...]</code>) and items are separated by comma character (<code>,</code>)</li>
<li>strings are enclosed in <code>"</code> characters</li>
<li>if you want to clear a list (for example you do not wants any options inside) just let it as <code>&lt;PARAMETR NAME&gt; = []</code> - do not drop that parameter</li>
<li>do not add supplementary parameters, they will not be used without software changes (also risk to induce potential errors)</li>
<li>for calendaristic dates Excel cells use <code>date</code> format and change it as display option to show wanted format</li>
</ul>
<p>(ro) README inainte de a face modificari:</p>
<ul>
<li>fiecare parametru are un hep scurt (liniile ce incep cu caracterul <code>#</code>) - citi-l inainte de a modifica uun parametru</li>
<li>nu schimbati numele parametrilor asa cum este el specificat inainte de semnul egal (<code>=</code>)</li>
<li>listele sunt incluse intre paranteze drepte (<code>[...]</code>) si elementele lor sunt separate prin caracterul virgula (<code>,</code>)</li>
<li>sirurile de caractere sunt incluse intre ghilimele (caracterul <code>"</code>)</li>
<li>daca doriti stergerea unei listei (de ex daca nu doriti nici o optiune pentru acea lista) doar lasati acel parametru cu valoarea <code>[]</code> - nu stergeti in nici un caz acel parametru</li>
<li>nu adaugati parametrii suplimentari (altii decit cei specificati aici), acestia nu vor fi utilizati fara a modifica aplicatia (de asemenea riscati sa induceti erori in cod)</li>
<li>pentru datele calendaristice in celulul Excel a se utiliza formatul standard de data (<code>date</code>) si modificati formatul de afisare in formatul dorit pe factura tiparibila</li>
</ul>
<p><a id="config_settings.DEFAULT_SUPPLIER_COUNTRY"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-default_supplier_country">DEFAULT_SUPPLIER_COUNTRY</h4>
<hr />
<p><strong>NOTE: "pattern-uri" (sabloane) de identificare si regasire a datelor folositi de</strong></p>
<p>__  comanda <code>xl2json</code> reprezentind functionalitatea de extragere a datelor din Excel si exportul lor in formatul JSON (modulul `rdinv)__</p>
<hr />
<p><a id="ldxml"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-ldxml">ldxml</h1>
<p>ldxml: modul de incarcare a facturii in sistemul ANAF E-Factura</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>ldxml</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Specifications:</p>
<ul>
<li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li>
<li>INTRARI: fisier <code>f-XML</code></li>
<li>IESIRI: raport cu validarea si identificatorul incarcarii</li>
</ul>
<p><a id="libutils"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-libutils">libutils</h1>
<p>general utilities library for all <code>xl2roefact</code> components and modules.</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>libutils</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Components:</p>
<ul>
<li><code>isnumber(a_string: str) -&gt; bool</code>
    Test a string if it could be used as number (int or float)</li>
<li><code>find_str_in_list(list_of_str_to_find: list, list_to_search: list) -&gt; int</code>
    Search more strings (ie, a list) in list of strings</li>
</ul>
<p><a id="libutils.isnumber"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-isnumber">isnumber</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">isnumber</span><span class="p">(</span><span class="n">a_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>
<p>test if a string is valid as any kind of number.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>a_string</code> - input string.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>True</code> - if input string is valid as any kind of number, orherwise <code>False</code>.</li>
</ul>
<p><a id="libutils.find_str_in_list"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-find_str_in_list">find_str_in_list</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_str_in_list</span><span class="p">(</span><span class="n">list_of_str_to_find</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">list_to_search</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>
<p>find a substring from <code>list_of_str_to_find</code> in elements of <code>list_to_search</code>.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>list_of_str_to_find</code> - list of strings to search for.</li>
<li><code>list_to_search</code> - liste where to search for substrings.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>index</code> - the index of list item which contains <code>str_to_find</code> (first found) or <code>None</code> if not found.</li>
</ul>
<p><a id="rdinv"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv">rdinv</h1>
<p>rdinv: modul de procesare a fisierului Excel ce contine factura si colectare a datelor aferente.</p>
<p>Formatul acceptat fisier Excel este <code>XLSX</code>.</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>rdinv</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Specifications:</p>
<ul>
<li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li>
<li>INTRARI: fisier format XLSX ce contine factura emisa (cod: <code>f-XLSX</code>)</li>
<li>IESIRI: fisier format JSON imagine a datelor facturii (cod: <code>f-JSON</code>)</li>
</ul>
<p><a id="rdinv.rdinv"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-rdinv_1">rdinv</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rdinv</span><span class="p">(</span><span class="n">file_to_process</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
          <span class="n">invoice_worksheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="o">*</span><span class="p">,</span>
          <span class="n">debug_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>
<p>read Excel file for invoice data.</p>
<p>Produce a dictionary structure + JSON file with all data regarding read invoice: canonical KV data, meta data, map to convert to XML and original Excel data.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>file_to_process</code> - the invoice file (exact file with path).</li>
<li><code>invoice_worksheet_name</code> - the worksheet containing invoice, optional, defaults to first found worksheet.</li>
<li><code>debug_info</code> - key only, show debugging information, default <code>False</code>.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>dict</code> - the invoice extracted information from Excel file as <code>dict(Invoice: dict, meta_info: dict, excel_original_data: dict)</code>  <code>TODO</code> subject of documentation update.</li>
</ul>
<p>NOTE ref important variables:
  * <code>db: pylightxl object</code>: EXCEL object with invoice (as a whole)
  * <code>ws: pylightxl object</code>: WORKSHEET object with invoice</p>
<p><a id="rdinv.get_excel_data_at_label"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-get_excel_data_at_label">get_excel_data_at_label</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_excel_data_at_label</span><span class="p">(</span><span class="n">pattern_to_search_for</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                            <span class="n">worksheet</span><span class="p">:</span> <span class="n">xl</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">ws</span><span class="p">,</span>
                            <span class="n">area_to_scan</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">targeted_type</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="n">down_search_try</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>
<p>get "one key Excel values", like invoice number or invoice issue date.</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>pattern_to_search_for</code> - for example for inv number, will pass the <code>PATTERN_FOR_INVOICE_NUMBER_LABEL</code>.</li>
<li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li>
<li><code>area_to_scan</code> - area of cells to be searched, default whole worksheet.</li>
<li><code>targeted_type</code> - what type expect (will try to convert to, if cannot will return str), default <code>str</code>.</li>
<li><code>down_search_try</code> - establish if DOWN search method is tried, default <code>True</code>.</li>
</ul>
<p><strong>Returns</strong>:</p>
<p><code>None</code> if not found OR <code>dictionary</code> containing:
  * <code>"value": int | float | str</code> - the value found covenrted to requested <code>targeted_type</code> if possible or <code>str</code> otherwise; if "out of space" then returns <code>None</code>
  * <code>"location": (row, col)</code> - adrees of cell where found value</p>
<p><strong>Notes</strong>:</p>
<ul>
<li>normal scan order is 1.RIGHT, 2.DOWN (if allowed), 3.IN-LABEL only in given area and pattern.</li>
</ul>
<p><a id="rdinv.mk_kv_invoice_items_area"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-mk_kv_invoice_items_area">mk_kv_invoice_items_area</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mk_kv_invoice_items_area</span><span class="p">(</span><span class="n">invoice_items_area_xl_format</span><span class="p">)</span>
</code></pre></div>
<p>transform <code>invoice_items_area</code> in "canonical JSON format" (as kv pairs).</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>invoice_items_area_xl_format</code> - invoice items area in Excel format (ie, DataFrame with row, col, data).</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>invoice_items_area_xl_format</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li>
</ul>
<p><strong>Notes</strong>:</p>
<ul>
<li>for ROefact XML model (&amp; plan) see <code>invoice_files/__model_test_factura_generat_anaf.xml</code>.</li>
</ul>
<p><a id="rdinv.get_invoice_items_area"></a></p>
<h4 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-get_invoice_items_area">get_invoice_items_area</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_invoice_items_area</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">invoice_items_area_marker</span><span class="p">,</span> <span class="n">wks_name</span><span class="p">)</span>
</code></pre></div>
<p>get invoice for <code>invoice_items_area</code>, process it and return its Excel format.</p>
<p>Process steps &amp; notes:
* find invoice items subtable.
* clean invoice items subtable.
* extract relevenat data.
* NOTE: all Excel cell addresses are in <code>(row, col)</code> format (ie, Not Excel format like "A:26, C:42, ...")</p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>worksheet</code> - the worksheet containing invoice (as object of <code>pyxllight</code> library).</li>
<li><code>invoice_items_area_marker</code> - string with exact marker of invoice items table.</li>
<li><code>NOTE</code> - this is the UPPER-LEFT corner and is determined before calling this procedure.</li>
<li><code>wks_name</code> - the wroksheet name (string) of the <code>worksheet</code> object.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>invoice_items_area</code> - dictionary with invoice items in Excel format (ie, rows, columns).</li>
</ul>
<p><a id="wrxml"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-wrxml">wrxml</h1>
<p>wrxml: modul de generare a fisierului format XML</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>wrxml</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Specifications:</p>
<ul>
<li>document cerinte initiale: <code>110-SRE-api_to_roefact_requirements.md</code> section <code>Componenta xl2roefact</code></li>
<li>INTRARI: fisier <code>f-JSON</code></li>
<li>IESIRI: fisier format XML conform cerintelor si sistemului ANAF E-Factura (cod: <code>f-XML</code>)</li>
</ul>
<p><a id="__init__"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-__init__">__init__</h1>
<p><a id="__main__"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-__main__">__main__</h1>
<p><strong>xl2roefact.<strong>main</strong></strong>: Python package standard file to assure run as <code>python -m xl2roefact</code>.</p>
<p>Identification:</p>
<ul>
<li>code-name: <code>__main__</code></li>
<li>copyright: (c) 2023 RENWare Software Systems</li>
<li>author: Petre Iordanescu (petre.iordanescu@gmail.com)</li>
</ul>
<p>Deployments:</p>
<ul>
<li>Windows:  MSI installer with EXE application.</li>
<li>Linux: <code>xl2roefact</code> executable shell as wrapper for <code>xl2roefact.py</code>.</li>
</ul>
<p>Specifications:</p>
<ul>
<li>command general format: <code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code>.</li>
<li>help: <code>python -m xl2roefact --help</code>.</li>
</ul>
<p><a id="__version__"></a></p>
<h1 id="xl2roefact-doc-810.05a-xl2roefact_dld_specs-__version__">__version__</h1>
<p>xl2roefact version info.
<div class="highlight"><pre><span></span><code> ######## ####              ########  ######
 #  ##  # #  #              #      # ##    ##
 ##    ## #  #              ###  ### #  ##  #
  ##  ##  #  #                #  #   #  ##  #
 ##    ## #  #                #  #   #  ##  #
 #  ##  # #  #####            #  #   #  ##  #
 #  ##  # #      #            #  #   ##    ##
 ######## ########            ####    ######

                            ######## ########  ######   ######  ########
 #######   ######           #      # #     #  ##    ## ##    ## #      #
 #     ## ##    ## #######  #  ##### #  ####  #  ##  # #  ##  # ###  ###
 #  ##  # #  ##  # #     #  #    #   #    #   #      # #  #####   #  #
 #  ##### #  ##  # #######  #  ###   #  ###   #  ##  # #  #####   #  #
 #  # #   #  ##  #          #  ##### #  #     #  ##  # #  ##  #   #  #
 #  #  #  ##    ##          #      # #  #     #  ##  # ##    ##   #  #
 ####   #  ######           ######## ####     ########  ######    ####
</code></pre></div></p></section><h1 class='nav-section-title-end'>Ended: xl2roefact PyPi library</h1>
                        <h1 class='nav-section-title' id='section-invoice-template'>
                            invoice template <a class='headerlink' href='#section-invoice-template' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="excel_invoice_template-index"><p><small markdown=1>Copyright (C) <strong>RENware Software Systems</strong></small></p>
<h1 id="excel_invoice_template-index-invoice-template">invoice template</h1>
<div class="toc">
<ul>
<li><a href="#excel_invoice_template-index-invoice-template">invoice template</a><ul>
<li><a href="#excel_invoice_template-index-instalarea-sablonului-de-factura-emisa">Instalarea sablonului de factura emisa</a></li>
<li><a href="#excel_invoice_template-index-recomandari-in-utilizarea-sablonului">Recomandari in utilizarea sablonului</a></li>
<li><a href="#excel_invoice_template-index-descarcare-download-sablon-factura">Descarcare (download) sablon factura</a></li>
<li><a href="#excel_invoice_template-index-license">License</a></li>
</ul>
</li>
</ul>
</div>
<p><img alt="Static Badge" src="https://img.shields.io/badge/versiune_curenta-0.1.20-blue" />
<img alt="Static Badge" src="https://img.shields.io/badge/formate_suportate-XLSX-orange" /></p>
<h2 id="excel_invoice_template-index-instalarea-sablonului-de-factura-emisa">Instalarea sablonului de factura emisa</h2>
<p>Aceasta componenta consta dintr-un director (ce nu necesita instalare speciala ci simpla copiere locala acolo unde va fi utilizat). Acest director contine:</p>
<ul>
<li>
<p>fisierul pentru factura <code>invoice_template_CU_tva.xlsx</code> ce este disponibil pentru <a href="#excel_invoice_template-index-descarcare-download-sablon-factura">descarcare aici</a></p>
</li>
<li>
<p>directorul <code>released_packages/</code> ce contine versiuni anterioare de sablon ce sunt inca suportate</p>
</li>
<li>
<p>prezentul document</p>
</li>
</ul>
<h2 id="excel_invoice_template-index-recomandari-in-utilizarea-sablonului">Recomandari in utilizarea sablonului</h2>
<p>Aceasta sectiune se refera la modul in care ar trebui "tratat" continutul fisierului Excel cu factura <strong><em>in conditiile in care se intentioneaza ca aceasta sa fi procesata ulterior cu sistemul <code>INVOICEtoROeFact</code></em></strong>. Acest sablon este general valabil (este un fisier Excel ca oricare altul) deci in acest caz este important a "constientiza" faptul ca informatia aferenta facturii din Excel va fi cautata, identificata si gasita in scopul de a fi salvata in formatele de factura electronica (utilizarea acestui sablon de factura Excel impreuna cu sistemul <code>INVOICEtoROeFact</code> <strong>ESTE O VARIANTA DE LUCRU RECOMANDATA</strong>, dar nu obligatorie).</p>
<p>Astfel <strong>se recomanda ca acest sablon sa fie utilizat asa cum este livrat</strong>, fara a efectua modificari majore in structura sa cum ar fi:</p>
<ul>
<li>
<p>modificarea formatelor (de tip de date) celulelor in scopul unei afisari "mai frumoase"</p>
</li>
<li>
<p>adaugarea de informatii prin concatenare de siruri de caractere sau orice alte metode de a altera continutul vizibil al celulelor in scopul unei afisari "mai frumoase"</p>
</li>
<li>
<p>modificarea locatiilor celulelor prin inserarea sau stergerea de linii, coloane sau celule noi</p>
</li>
</ul>
<blockquote>
<p><strong>In general trebuie facuta diferenta intre datele facturii si modul in care aceasta va fi tiparita (va aparea la tiparire / previzualizare).</strong></p>
</blockquote>
<p><small markdown="1"></p>
<p>DETALII TEHNICE:</p>
<p>Continutul informational al facturii nu trebuie nici confundat si nici mixat cu <strong>formatul de afisare al acesteia</strong> (layout). Pentru acesta din urma se recomanda a fi folosite cu precadere <em>regulile de formatare</em> din Excel si nu cele stocare a datelor. Un exemplu este un numar zecimal oarecare unde:</p>
<ul>
<li>una este valoarea introdusa intr-o celula (de ex cu 3 zecimale) si</li>
<li>alta este valoarea afisata (cu 2 zecimale) - aceasta din urma trebuie obtinuta prin formatarea celulei respective de a afisa 2 zecimale prin rotunjire insa valoarea efectiva trebuie sa fie cea originala cu 3 zecimale, lucru (diferenta) care se poate vedea la editarea continutului celulei.</li>
</ul>
<p></small></p>
<h2 id="excel_invoice_template-index-descarcare-download-sablon-factura">Descarcare (download) sablon factura</h2>
<ul>
<li>
<p><a href="excel_invoice_template/invoice_template_CU_tva.xlsx" title="download">office Excel XLSX 0.1.20</a></p>
</li>
<li>
<p><a href="excel_invoice_template/released_packages/0.1.20-excel_invoice_template.zip" title="download">arhiva ZIP 0.1.20</a></p>
</li>
<li>
<p><a href="excel_invoice_template/released_packages/0.1.11-excel_invoice_template.zip" title="download">arhiva ZIP 0.1.11</a></p>
</li>
</ul>
<h2 id="excel_invoice_template-index-license"><a href="#excel_invoice_template-license" title="download">License</a></h2></section><h1 class='nav-section-title-end'>Ended: invoice template</h1>
                        <h1 class='nav-section-title' id='section-help'>
                            Help <a class='headerlink' href='#section-help' title='Permanent link'>â†µ</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-manuale-web2roefact'>
                            Manuale web2roefact <a class='headerlink' href='#section-manuale-web2roefact' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="doc_src-help-880.30-euma_catalog"><p><img align="left" alt="api_to_roefact_logo" src="doc_src/pictures/api_to_roefact_logo.png" width="55" />
<small markdown="1"><strong>INVOICEtoROefact System</strong><br>
<em>(c) 2023 RENware Software Systems</em>
</small><br><br></p>
<h1 id="doc_src-help-880.30-euma_catalog-catalogul-manualelor-de-utilizare">Catalogul manualelor de utilizare</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-help-880.30-euma_catalog-catalogul-manualelor-de-utilizare">Catalogul manualelor de utilizare</a></li>
</ul>
</div>
<ul>
<li>...</li>
</ul></section><section class="print-page" id="doc_src-help-880.30-adma_catalog"><p><img align="left" alt="api_to_roefact_logo" src="doc_src/pictures/api_to_roefact_logo.png" width="55" />
<small markdown="1"><strong>INVOICEtoROefact System</strong><br>
<em>(c) 2023, 2024 RENware Software Systems</em>
</small><br><br></p>
<h1 id="doc_src-help-880.30-adma_catalog-catalogul-manualelor-de-configurare-si-administrare">Catalogul manualelor de configurare si administrare</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-help-880.30-adma_catalog-catalogul-manualelor-de-configurare-si-administrare">Catalogul manualelor de configurare si administrare</a></li>
</ul>
</div>
<ul>
<li>...</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Manuale web2roefact</h1>
                        <h2 class='nav-section-title' id='section-cerintele-sistemului'>
                            Cerintele sistemului <a class='headerlink' href='#section-cerintele-sistemului' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="doc_src-commercial_agreement-110-sre-general_requirements"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="doc_src-commercial_agreement-110-sre-general_requirements-propunere-tehnica">Propunere tehnica</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-propunere-tehnica">Propunere tehnica</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-aria-de-cuprindere">Aria de cuprindere</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-de-securitate">Considerente generale de securitate</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-bazele-de-date-proprii-sistemelor">Considerente generale privind bazele de date proprii sistemelor</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-auditarea-informatiilor">Considerente generale privind auditarea informatiilor</a></li>
</ul>
</li>
</ul>
</div>
<ul>
<li>Client: <!-- #NOTE hided it Kraftanlagen Romania SRL --> n/a - not public</li>
<li>Data: 2023-Noiembrie</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Codificarea documentelor</p>
<ul>
<li><small markdown="1">codificarea numelor documentelor si a proceselor este facuta in conformitate cu metodologia <em><a href="http://sdeven.renware.eu">RENware SDEVEN</a></em></small></li>
</ul>
</div>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-propunere-tehnica">Propunere tehnica</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-aria-de-cuprindere">Aria de cuprindere</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-de-securitate">Considerente generale de securitate</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-bazele-de-date-proprii-sistemelor">Considerente generale privind bazele de date proprii sistemelor</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-auditarea-informatiilor">Considerente generale privind auditarea informatiilor</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="doc_src-commercial_agreement-110-sre-general_requirements-aria-de-cuprindere">Aria de cuprindere</h2>
<p>Solutiile propuse prin aceasta propunere tehnica sunt:</p>
<ul>
<li>
<p><strong>INVOICEtoROefact</strong> (<em>code-name</em> <strong><code>api_to_roefact</code></strong>) integrare Sistemul National de Facturi Emise <em>RO e-Factura</em> <a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements">descriere si cerinte aici</a></p>
</li>
<li>
<p><strong>PayValidaBoa</strong> (<em>code-name</em> <strong><code>payments_validation_board</code></strong>) Flux aprobare facturi primite pentru ordonantare la plata <a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements">descriere si cerinte aici</a></p>
</li>
</ul>
<p>In continuare se prezinta o serie de considerente generale valabile pentru toate sistemele din aria de acoperire.</p>
<h2 id="doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-de-securitate">Considerente generale de securitate</h2>
<ul>
<li>
<p><strong>(RSEC-01)</strong> fisierele de configurare a sistemelor (fiind format text <code>UTF-8</code>) vor avea ca <code>owner</code> un utilizator dedicat sistemului respectiv sau utilizatorul <code>root</code>. Numai acesti doi utilizatori pot avea acces <code>RW</code> la aceste fisiere</p>
</li>
<li>
<p><strong>(RSEC-02)</strong> toate documentele de provenienta externa sistemelor vor fi "purtatoare" ale unui certificat digital ce <strong>atesta validitatea documentelor</strong>. Acest certificat va fi de preferinta de tip <em>"semnatura electronica"</em> dar nu obligatoriu calificata. Este suficient un simplu certificat (cheie) tip <code>RSA</code> generat intern si distribuit utilizatorilor autorizati sa emita documentele respective. O copie a certificatului (sau a certificatelor daca se vor emite mai multe) ce atesta validitatea unui document va sta pe server in locatii ce sunt conforme cu <em>RSEC-01</em></p>
</li>
</ul>
<h2 id="doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-bazele-de-date-proprii-sistemelor">Considerente generale privind bazele de date proprii sistemelor</h2>
<ul>
<li>
<p><strong>(DBS-01)</strong> bazele de date vor contine o cheie primara <em>"real primara</em>" (adica avind toate caracteristicile tehnice pentru <code>PK</code> in sensul uzual cunoscut din teoria bazalor de date). Aceasta cheie va fi de tip <code>Char(32)</code> reprezentind tipul <code>uuid4</code> (cunoscut si ca <code>guid</code>) convertit la sir de caractere <code>UTF-8</code> si reversibil ca transformare din <code>string</code> in <code>uuid4</code>. Aceasta cheie va fi generata automat si intretinuta de sistem deservind scopuri pur tehnice de <em>referentiere si relationare</em> a datelor. Modificarea manuala nu este permisa putind genera situatii de hazard.</p>
</li>
<li>
<p><strong>(DBS-02)</strong> bazele de date vor contine si o alta <em>"cheie primara uman recongnoscibila"</em> (<code>AK</code> in teoria bazelor de date) utilizata in scop de <strong>recunoastere si regasire</strong> a informatiei de catre utilizatori. Aceasta cheie va avea urmatoarele catacterisrici:</p>
<ul>
<li>va fi <em>unica</em>, tip <code>Char(10)</code> (limitarea lungimii se va aplica la introducerea datelo si nu in baza de date)</li>
<li><em>agnostic case</em>, nu se va face diferenta intre litere mari sau mici (pentru a evita confuziile)</li>
<li><em>obligatorie</em> iar daca utilizatorul "nu o doreste" se va default-a la <code>PK-ul</code> anterior</li>
</ul>
</li>
<li>
<p><strong>(DBS-03)</strong> bazele de date vor fi intr-unul din formatele: <strong>(a) relational</strong> sau <strong>(b) JSON standard</strong>. Pentru bazele de date in format relational va fi preferata o solutie de SGBD tip open source matura,   intretinuta in urmatoarea ordine de aplicare:</p>
<ul>
<li><code>1.</code> <em><a href="https://www.sqlite.org/index.html">SQLite</a></em> pentru baze de date ce nu vor depasi 10,000 de inregistrari</li>
<li><code>2.</code> <em><a href="https://www.postgresql.org/">PostgreSQL</a></em> pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li>
<li><code>3.</code> <em><a href="https://mariadb.org/">MariaDB</a></em> pentru baze de date ce se esttimeaza ca vor depasi 10,000 de inregistrari</li>
<li>prima varianta va fi preferata datoritra "portabilitatii datelor"</li>
<li>a treia varianta este enumerata ca optiune preferata a utilizatorului la varianta <code>2.</code></li>
</ul>
</li>
<li>
<p><strong>(DBS-04)</strong> bazele de date vor folosi numai cimpuri formate standard, clasice si elemetare:</p>
<ul>
<li>sir de carectere (<code>CHAR</code> sau <code>VARCHAR</code>)</li>
<li>numere intregi cu semn (<code>INTEGER</code>)</li>
<li>numere reale cu semn (<code>FLOAT</code>)</li>
<li>numere combinate a caror valoare poate fi intreg sau real (<code>NUMBER</code>)</li>
<li>valori logice sub forma intreg cu semn astfel: <code>1</code> pentru TRUE si <code>0</code> sau <code>NULL</code> pentru FALSE</li>
<li>valori logice sub forma de caracter astfel: prima litera din lista <code>[Y, y, D, d, T, t]</code> pentru TRUE si orice altceva inclusiv <code>NULL</code> pentru FALSE</li>
</ul>
</li>
<li>
<p><strong>(DBS-05)</strong> in cazul bazelor de date relationale, integritatile referentiale vor fi evitate la maximum prin intretinerea datelor numai cu ajutorul aplicatiei sau in cazull necesitatii modificarii manuale a datelor, aceasta modfica re sa fie efectuata numai de personal calificat</p>
</li>
<li>
<p><strong>(DBS-06)</strong> informatiile de tip data-timp (data, ora, etc...) vor fi stocate de preferinta sub forma de <code>String</code> in formatul ISO: <code>YYYY-MM-DD HH:MM:SS.nnnnn</code>.</p>
</li>
<li>
<p><strong>(DBS-07)</strong> informatii de data-timp vor fi stocate avind valori agnostice de "Time Zone" adica vor fi considerate <code>UTC</code> lucru care va permite comparabilitatea acestora indiferent de locatia /zpna de timp de unde au fost generate.</p>
</li>
</ul>
<h2 id="doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-auditarea-informatiilor">Considerente generale privind auditarea informatiilor</h2>
<ul>
<li>
<p>Cimpurile de audit ce indica utilizatori:</p>
<ul>
<li><strong>(AUD-01)</strong> pentru informatiile CONSTIENT GENERATE DE UTILIZATORI (adica generate prin activarea unor controale vizuale, prin lansarea manuala a unei aplicatii, etc), aceste cimpuri vor contine <strong>numele tip <code>username</code> al utilizatorului folosit pentru autentificarea in sistem</strong></li>
<li><strong>(AUD-02)</strong> pentru informatiile GENERATE DE SISTEM la rulari automate, periodice, de verificare, de validare, etc, aceste cimpuri vor contine textul <strong><code>system</code></strong> (pentru a evita confuzii cu utilizatori reali la nivel de sistem de operare)</li>
</ul>
</li>
<li>
<p><strong>(AUD-03)</strong> Cimpurile de audit ce indica date calendaristice vor respecta standardul ISO fiind in formatul maximal <code>YYYY-MM-DD hh:mm:ss</code></p>
</li>
</ul></section><section class="print-page" id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements"><p><img align="left" alt="api_to_roefact_logo" src="doc_src/pictures/api_to_roefact_logo.png" width="55" />
<small markdown="1"><strong>INVOICEtoROefact System</strong><br>
<em>(c) 2023 RENware Software Systems</em>
</small><br><br></p>
<h1 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-propunere-tehnica-sistem-invoicetoroefact">Propunere tehnica sistem INVOICEtoROefact</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-propunere-tehnica-sistem-invoicetoroefact">Propunere tehnica sistem INVOICEtoROefact</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-obiective">Obiective</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-xl2roefact">Componenta xl2roefact</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-diagrama-logica-de-functionare-a-componentei">Diagrama logica de functionare a componentei</a></li>
</ul>
</li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-web_dashb">Componenta WEB_DASHB</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-system_db">Componenta SYSTEM_DB</a></li>
</ul>
</li>
</ul>
</div>
<ul>
<li>p/n: <code>0000-0095</code></li>
<li>code-name: <code>api_to_roefact</code></li>
<li>commercial name: <strong>INVOICEtoROefact</strong></li>
<li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html</code></li>
<li>git: <code>https://github.com/petre-renware/api_to_roefact</code></li>
</ul>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-propunere-tehnica-sistem-invoicetoroefact">Propunere tehnica sistem INVOICEtoROefact</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-obiective">Obiective</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-xl2roefact">Componenta xl2roefact</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-diagrama-logica-de-functionare-a-componentei">Diagrama logica de functionare a componentei</a></li>
</ul>
</li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-web_dashb">Componenta WEB_DASHB</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-system_db">Componenta SYSTEM_DB</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-obiective">Obiective</h2>
<p>Acest sistem va asigura incarcarea facturilor emise in sistemul <a href="https://www.anaf.ro/anaf/internet/ANAF/despre_anaf/strategii_anaf/proiecte_digitalizare/e.factura">ANAF E-Factura</a> cu respectarea reglementarilor publicate in acest sens (lista contine si legaturi catre fisierele publicate de catre ANAF):</p>
<ul>
<li>
<p><a href="https://static.anaf.ro/static/10/Anaf/Informatii_R/Informatii_modificare_CIUS_RO.pdf">Conformarea la modificarile legislative si utilizarea sistemului</a></p>
</li>
<li>
<p><a href="https://static.anaf.ro/static/10/Anaf/Informatii_R/Comunicat_e-factura_aprilie2022_v2_050422.pdf">Informatii de interes referitoare la implementarea sistemului naÈ›ional privind factura electronicÄƒ RO e-Factura</a></p>
</li>
<li>
<p><a href="https://static.anaf.ro/static/10/Anaf/Informatii_R/API/Oauth_procedura_inregistrare_aplicatii_portal_ANAF.pdf">InstrucÈ›iuni de utilizare</a></p>
</li>
</ul>
<h2 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</h2>
<p>Solutia <code>api_to_roefact</code> consta din urmatoarele componente:</p>
<ul>
<li>
<p><code>api_to_roefact</code>.<strong><code>xl2roefact</code></strong> aceasta componenta are rolul de a implementa efectiv obiectivele principale ale sistemului <strong>INVOICEtoROefact</strong>. Componenta este capabila sa ruleze atit "<em>standalone</em>" (ca linie de comanda CLI) dar si prin utilizarea ei de catre componenta <code>WEB_DASHB</code> si astfel utilizarea ei in varianta de sistem prezentat "<em>over internet / intranet</em>". <a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-xl2roefact">Prezentarea detalita a acesteia se gaseste aici</a>.</p>
</li>
<li>
<p><code>api_to_roefact</code>.<strong><code>WEB_DASHB</code></strong> aceasta componenta are rolul de agrega componentele si de a prezenta solutia <strong>INVOICEtoROefact</strong> "<em>over internet / intranet</em>". De asemenea componenta asigura modulele UI necesare pentru administrarea sistemului. <a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-web_dashb">Prezentarea detalita a acesteia se gaseste aici</a>.</p>
</li>
<li>
<p><code>api_to_roefact</code>.<strong><code>SYSTEM_DB</code></strong> .Aceasta componente reprezita baza de date a sistemului <strong>INVOICEtoROefact</strong> atit partea relationala dar si partea <code>no-sql</code> a acesteia (utilizata pentru eventuale sincrnizari provenite din utilizarea CLI a componentei <code>xl2roefact</code>). <a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-system_db">Prezentarea detalita a acesteia se gaseste aici</a>.</p>
</li>
</ul>
<p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>api_to_roefact</code>.</p>
<p><img alt="arh-api_to_roefact" src="doc_src/pictures/api_to_roefact_architecture.png" /></p>
<h2 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-xl2roefact">Componenta xl2roefact</h2>
<ul>
<li>
<p><strong>(RDINV)</strong> modul de procesare a fisierului format <code>XLSX</code> ce contine factura si colectare a datelor aferente</p>
<ul>
<li><em>INTRARI</em>: fisier format <code>XLSX</code> ce contine factura emisa (cod: <strong><code>f-XLSX</code></strong>)</li>
<li><em>IESIRI</em>: fisier format <code>JSON</code> imagine a datelor facturii (cod: <strong><code>f-JSON</code></strong>)</li>
</ul>
</li>
<li>
<p><strong>(WRXML)</strong> modul de generare a fisierului format <code>XML</code></p>
<ul>
<li><em>INTRARI</em>: fisier <code>f-JSON</code></li>
<li><em>IESIRI</em>: fisier format <code>XML</code> conform cerintelor si sistemului <code>ANAF E-Factura</code> (cod: <strong><code>f-XML</code></strong>)</li>
</ul>
</li>
<li>
<p><strong>(CHKXML)</strong> modul de validare a facturii in sistemul <code>ANAF E-Factura</code></p>
<ul>
<li><em>INTRARI</em>: fisier <code>f-XML</code></li>
<li><em>IESIRI</em>: raport cu eventualele erori de validare <sup id="fnref2:1"><a class="footnote-ref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fn:1">1</a></sup></li>
</ul>
</li>
<li>
<p><strong>(LDXML)</strong> modul de incarcare a facturii in sistemul <code>ANAF E-Factura</code></p>
<ul>
<li><em>INTRARI</em>: fisier <code>f-XML</code></li>
<li><em>IESIRI</em>: raport cu validarea si identificatorul incarcarii <sup id="fnref:1"><a class="footnote-ref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fn:1">1</a></sup></li>
</ul>
</li>
<li>
<p><strong>(CHKISLD)</strong> modul de verificare a starii de incarcare a unei facturi emise</p>
<ul>
<li><em>INTRARI</em>: fisier <code>f-XLSX</code> sau numarul / cheia / codul facturii</li>
<li><em>IESIRI</em>: valoarea echivalent <code>TRUE</code> daca factura a fost deja incarcata sau valoare echivalent <code>FALSE</code> daca factura nu a fost incarcata <sup id="fnref:2"><a class="footnote-ref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fn:2">2</a></sup></li>
</ul>
</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Formatul fisierelor Excel cu factura</p>
<p><code>XLSX</code> este sigurul format de fisier acceptat</p>
</div>
<h3 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-diagrama-logica-de-functionare-a-componentei">Diagrama logica de functionare a componentei</h3>
<pre class="mermaid"><code>flowchart TD
    start(["start"])
    stop(["stop &amp; \nrepeta ciclul"])
    RDINV["procesare a fisierului format XLSX"]
    WRXML["generare a fisierului format XML"]
    CHKXML["validare a facturii"]
    LDXML["incarcare a facturii in sistemul E-Factura"]
    CHKISLD["verificare stare de incarcare facturi"]

    f-XLSX[\"f-XLSX"/]
    f-XML[\"f-XML"/]
    f-JSON[\"f-JSON"/]
    DBS[("system database")]

    loaded{"incarcata?"}

    start ---&gt; RDINV
    f-XLSX --&gt; RDINV
    RDINV ---&gt; f-JSON
    RDINV --&gt; CHKISLD

    CHKISLD --&gt; loaded
    loaded --DA--&gt; stop

    loaded --NU--&gt; WRXML
    WRXML --&gt; f-XML
    WRXML --&gt; LDXML
    LDXML --&gt; CHKXML
    CHKXML --&gt; stop

    CHKXML --&gt; DBS

    LDXML ---&gt; DBS</code></pre>
<p>...#FIXME explicatii necesare ?...<!--#TODO --></p>
<h2 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-web_dashb">Componenta WEB_DASHB<!--#TODO --></h2>
<p>...INCOMING... <img alt="wip-picture" src="doc_src/pictures/under_maintenance.png" width="150" /> <!--#TODO --></p>
<h2 id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-system_db">Componenta SYSTEM_DB<!--#TODO --></h2>
<p>...INCOMING... <img alt="wip-picture" src="doc_src/pictures/under_maintenance.png" width="150" /> <!--#TODO --></p>
<!-- #NOTE note generale / footnotes -->

<div class="footnote">
<hr />
<ol>
<li id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fn:1">
<p>raportul se scrie in baza de date a sistemului si in fisierul <code>f-XLSX</code> intr-un worksheet separat dedicat acestui scop&#160;<a class="footnote-backref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fn:2">
<p>in cazul valorii echivalent <code>TRUE</code> se poate intoarce identificatorul incarcarii daca este disponibil&#160;<a class="footnote-backref" href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-propunere-tehnica-sistem-payvalidaboa">Propunere tehnica sistem PayValidaBoa</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-propunere-tehnica-sistem-payvalidaboa">Propunere tehnica sistem PayValidaBoa</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-obiective">Obiective</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-cerinte-functionale-generale">Cerinte functionale generale</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-componenta-xxx">Componenta xxx</a></li>
</ul>
</li>
</ul>
</div>
<ul>
<li>p/n: <code>0000-0094</code></li>
<li>code-name: <code>payments_validation_board</code></li>
<li>commercial name: <strong>PayValidaBoa</strong></li>
<li>url propunere tehnica: <code>http://apitoroefact.renware.eu/commercial_agreement/110-SRE-payments_validation_board_req.uirements.html</code></li>
<li>git: <code>n/a</code></li>
</ul>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-propunere-tehnica-sistem-payvalidaboa">Propunere tehnica sistem PayValidaBoa</a><ul>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-obiective">Obiective</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-cerinte-functionale-generale">Cerinte functionale generale</a></li>
<li><a href="#doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-componenta-xxx">Componenta xxx</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-obiective">Obiective</h2>
<p>Acest sistem asigura prezentarea unui "<em>dashboard</em>" cu lista facturilor primite si starea lor de <strong>verificare si aprobare interna</strong> in vederea ordonantarii lor la plata.</p>
<h2 id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-vedere-de-ansamblu-a-solutiei">Vedere de ansamblu a solutiei</h2>
<p>Sistemul <code>payments_validation_board</code> consta din urmatoarele componente:</p>
<ul>
<li>
<p><strong><code>INV_TOPMNG_BOARD</code></strong> - aceasta componenta prezinta <em>pentru MANAGEMNTul tip CFO</em> lista facturilor primite si starea lor referitor la <em>validarea si aprobarea lor finala</em> si un control pentru <em>APROBARE FINALA sau BUN DE PATA</em>. <!--#TODO wip... --></p>
</li>
<li>
<p><strong><code>INV_CHK_BOARD</code></strong> - aceasta componenta prezinta <em>pentru VERIFICATORI si APROBABTORI</em> lista fa/turilor primite si <em>diverse controale pentru aprobarea si scrierea de diverse note</em> si observatii. <!--#TODO wip... --></p>
</li>
<li>
<p><strong><code>INV_NOTIF_BOARD</code></strong> aceasta componenta prezinta notificari referitoare la <em>diversele OBSERVATII si NOTE</em> facture asupra facturilor primite in diverse stadii de aprobare de catre persoanele care efectueaza verificari asupra lor (prin componenta <code>INV_CHK</code>). Notificarile sunt disponibile atit in interfata aplicatiei iar <em>unele din ele pot fi transmise prin mail</em>. <!--#TODO wip... --></p>
</li>
<li>
<p><strong><code>INV_LD_FOR_APPRV</code></strong> - aceasta componenta permite <em>incarcarea facturilor in fluxul de aprobare</em>. Optiuni de incarcare:</p>
<ul>
<li>manuala (dintr-un board al aplicatiei)</li>
<li>automata dintr-un director</li>
<li>dintr-o baza de date externa sistemului (cu "marcarea" facturilor ce vor trebui incarcate)</li>
<li>la incarcare (indiferent de metoda) vor trebui specificati (sau dedusi din alte informatii) DESTINATARII ce primesc documentul<!--#TODO wip... --></li>
</ul>
</li>
<li>
<p><strong><code>ADMIN_CFG</code></strong> aceasta componenta permite <em>pentru ADMINISTRATORI</em> diverse <em>OPTIUNI DE CONFIGURARE</em>:</p>
<ul>
<li>lista utilizatorilor ce fac parte dinfluxul de aprobare</li>
<li>adresele e-mail ale utilizatorilor</li>
<li>rolul utilizatorilor in accea ce priveste fluxul de aprobare facturile primite</li>
<li>certificate si semnaturile de certificare a "semnaturilor" de aprobare</li>
<li>... <!--#TODO wip... --></li>
</ul>
</li>
</ul>
<p>Figura urmatoare prezinta schematic rolul general al componentelor precum si interactiunea acestora cu mediul exterior sistemului <code>payments_validation_board</code>.</p>
<!--#NOTE_update_me ![arh-api_to_roefact](../pictures/api_to_roefact_architecture.png) -->
<p>...IN PROGRESS... <img alt="wip-picture" src="doc_src/pictures/under_maintenance.png" width="150" /> <!--#TODO --></p>
<h2 id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-cerinte-functionale-generale">Cerinte functionale generale</h2>
<p>...INCOMING... <img alt="wip-picture" src="doc_src/pictures/under_maintenance.png" width="150" /> <!--#TODO --></p>
<h2 id="doc_src-commercial_agreement-110-sre-payments_validation_board_req.uirements-componenta-xxx">Componenta xxx</h2>
<p>...INCOMING... <img alt="wip-picture" src="doc_src/pictures/under_maintenance.png" width="150" /> <!--#TODO --></p>
<!--#TODO --></section><section class="print-page" id="doc_src-commercial_agreement-agreed_options"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="doc_src-commercial_agreement-agreed_options-optiuni-tehnice">Optiuni tehnice</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-commercial_agreement-agreed_options-optiuni-tehnice">Optiuni tehnice</a><ul>
<li><a href="#doc_src-commercial_agreement-agreed_options-optiuni-sistem-invoicetoroefact">Optiuni sistem INVOICEtoROefact</a><ul>
<li><a href="#doc_src-commercial_agreement-agreed_options-recomandari-sistem-invoicetoroefact">Recomandari sistem INVOICEtoROefact</a></li>
</ul>
</li>
<li><a href="#doc_src-commercial_agreement-agreed_options-optiuni-sistem-payvalidaboa">Optiuni sistem PayValidaBoa</a></li>
<li><a href="#doc_src-commercial_agreement-agreed_options-optiuni-generale-de-implementare">Optiuni generale de implementare</a></li>
</ul>
</li>
</ul>
</div>
<p>Acest document prezinta posibilele optiuni tehnice la cele doua sisteme, optiuni care vor trebui agreate si (preferabil) planificate cel putin din punct de vedere al prioritatii.</p>
<h2 id="doc_src-commercial_agreement-agreed_options-optiuni-sistem-invoicetoroefact">Optiuni sistem INVOICEtoROefact</h2>
<div class="admonition example">
<p class="admonition-title">Forma de utilizare si interactionare</p>
<ul>
<li>&#x2610; (<strong>INVOICEtoROefact-RQ-01</strong>) -
varianta CLI (command line) cu utilizare "individuala"</li>
<li>&#x2610; (<strong>INVOICEtoROefact-RQ-02</strong>) -
varianta WEB cu utilizare centralizata</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Configurabilitate</p>
<ul>
<li>&#x2610; (<strong>INVOICEtoROefact-RQ-03</strong>) -
varianta in care se prelucreaza un model de fisier <code>Excel</code> in care sunt "fixate si blocate" locatiile celulelor ce contin date relevante</li>
<li>&#x2610; (<strong>INVOICEtoROefact-RQ-04</strong>) -
varianta in care structura si formatul fisierului <code>Excel</code> contin "cuvinte cheie" ce determina regasirea date relevante (de exemplu textul "Client:" intr-o celula semnifica inceperea unei zone cu datele clientului de la acea celula in jos si pina prima celula necompletata ce va fi gasita)</li>
</ul>
</div>
<h3 id="doc_src-commercial_agreement-agreed_options-recomandari-sistem-invoicetoroefact">Recomandari sistem INVOICEtoROefact</h3>
<ul>
<li>
<p>varianta (INVOICEtoROefact-RQ-01) este recomandata ca fiind "aproape obligatorie" deoarece chiar si in varianta WEB ea va trebui scrisa intr-o forma neutilizabila direct (sub forma de functie a sistemlui). Transformarea acestei functii in varianta CLI va permite o executie portabila ("la purtator") si offline (in situatii extreme se poate folosi doar fisierul <code>XML</code> generat si acesta va putea fi manual incarcat in ANAF-SPV). Informatia privind "starea de incarcare a facturii" va fi oricum salvata si in fisierul Excel aferent facturii si va putea fi preluata de catre varianta WEB pentru centralizarea informatiilor- a se vedea si <a href="#doc_src-commercial_agreement-110-sre-api_to_roefact_requirements-componenta-xl2roefact">modulul <code>LDXML</code> si notele de subsol aferente</a></p>
</li>
<li>
<p>optiunea (INVOICEtoROefact-RQ-03) este recomandata ca varianta de start deoarece va permite realizarea unei variante OPERATIONALE (de lucru curent si testare) intr-un termen mai scurt, urmind ca aceasta optiune sa fie gradat extinsa si cu optiunea (INVOICEtoROefact-RQ-04). Aceasta "linie de lucru" nu va induce probleme, avind in vedere ca orice optiune / varianta aleasa ca varianta de start si planificata a fi extinsa va implica si MIGRAREA datelor deja produse la momentul extinderii ei</p>
</li>
</ul>
<h2 id="doc_src-commercial_agreement-agreed_options-optiuni-sistem-payvalidaboa">Optiuni sistem PayValidaBoa</h2>
<div class="admonition example">
<p class="admonition-title">Framework standardizat de orchestrare</p>
<ul>
<li>&#x2610; (<strong>PayValidaBoa-RQ-01</strong>) - utilizarea unui framework specializat de orchestrare si integrare cu alte sisteme "externe"<ul>
<li><em>Implicatii:</em> poate mari durata de implementare</li>
<li><em>Avantaje:</em> utilizarea ulterioara pentru integrare intre sisteme ce prezita interfata standardizata (REST, SOA, NTFS, EXT4, OAuth, ...)</li>
</ul>
</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Semnare electronica a facturilor verificate</p>
<ul>
<li>&#x2610; (<strong>PayValidaBoa-RQ-02</strong>) - utilizarea de certificat tip "semnatura electronica" pentru autentificarea verificarii facturilor <em>EMBEDDED IN FACTURA</em></li>
<li>&#x2610; (<strong>PayValidaBoa-RQ-03</strong>) - utilizarea de certificat tip "semnatura electronica" pentru autentificarea verificarii facturilor <em>adiacet facturii - disponibil pentru consultare numai in sistemul PayValidaBoa</em></li>
<li>&#x2610; (<strong>PayValidaBoa-RQ-04</strong>) - verificarea facturilor nu necesita certificat tip "semnatura electronica" ci simpla informatie existenta in sistemul PayValidaBoa este suficienta</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Baza de date 'interna / specifica' sistemului PayValidaBoa</p>
<ul>
<li>a se vedea <a href="#doc_src-commercial_agreement-110-sre-general_requirements-considerente-generale-privind-bazele-de-date-proprii-sistemelor">documentul <em>"Considerente tehnice generale"</em>, sectiunea <em>"Considerente generale privind bazele de date proprii sistemelor"</em>, item <em>"(DBS-03)"</em></a> pentru opptiuni privind baza de date ce va fi utilizata "pentru operatiuni interne si specifice" de catre sistemul PayValidaBoa</li>
</ul>
</div>
<h2 id="doc_src-commercial_agreement-agreed_options-optiuni-generale-de-implementare">Optiuni generale de implementare</h2>
<div class="admonition example">
<p class="admonition-title">Sistemele tip infrastructura ce vor fi utilizate</p>
<ul>
<li>&#x2610; (<strong>general-RQ-01</strong>) - server web-HTTP pentru aplicatiile de tip WEB (<em>ATENTIE:</em> sistemele WEB ce vor fi implementate necesita interfata / mod de operare standard <code>WSGI</code>)</li>
<li>&#x2610; (<strong>general-RQ-02</strong>) - sistem de autentificare utilizat (intern aplicatie, Google, Identity Management propriu, ...)</li>
<li>&#x2610; (<strong>general-RQ-03</strong>) - sistemele vor rula pe infrastructura proprie sau aceastea vor rula in infrastructuri gazduite</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Alte optiuni 'ad-hoc' (in sedinta)</p>
<ul>
<li>...</li>
<li>...</li>
<li>...</li>
<li>...</li>
<li>...</li>
<li>...</li>
</ul>
</div>
<!--#NOTE special HTML characters to use:
    - &#x2610; checkbox as NOT CHECKED
    - &#x2611; checkbox as CHECKED
--></section><h1 class='nav-section-title-end'>Ended: Cerintele sistemului</h1><section class="print-page" id="doc_src-downloads"><p><small><strong>RENware Software Systems</strong></small></p>
<h1 id="doc_src-downloads-descarcare-resurse-downloads">Descarcare resurse (downloads)</h1>
<p><strong><em>Cuprins:</em></strong></p>
<div class="toc">
<ul>
<li><a href="#doc_src-downloads-descarcare-resurse-downloads">Descarcare resurse (downloads)</a><ul>
<li><a href="#doc_src-downloads-format-biblioteca-python">Format biblioteca Python  </a></li>
<li><a href="#doc_src-downloads-format-msi-instalare-windows-x64">Format MSI instalare Windows x64  </a></li>
<li><a href="#doc_src-downloads-format-deb-instalare-linux">Format DEB instalare Linux</a></li>
<li><a href="#doc_src-downloads-format-xlsx-office-excel">Format XLSX Office Excel  </a></li>
</ul>
</li>
</ul>
</div>
<!-- #FIXME DROP SECTION AFTER TEST...
---------------[ALL OF DOWNLOADS - should remove duplicates if there are]--- #NOTE: all paths are relative to `doc_src/`

#### work.section... [xl2roefact... `xl2roefact/doc/README_xl2roefact_library.md`]---
* ...moved.all...

#### work.section... [main `/README.md`]---
* ...moved.all...

#### [invoice template `excel_invoice_template/README.md`]---
* ...moced.all...

#### links to use in ext doc to ref sectios

...doc_src/downloads.md#format-biblioteca-python
...doc_src/downloads.md#format-msi-instalare-windows-x64
...doc_src/downloads.md#format-xlsx-office-excel

#FIXME up here to drop------------------------------------>

<h2 id="doc_src-downloads-format-biblioteca-python">Format biblioteca Python  <!-- TODO: rdy to test up to v0.1.20 --></h2>
<ul>
<li><a href="xl2roefact/dist/xl2roefact-0.1.20-py3-none-any.whl" title="download">0.1.20.dev invoice customer address WHEEL</a></li>
<li><a href="xl2roefact/dist/xl2roefact-0.1.20.tar.gz" title="download">0.1.20.dev invoice customer address DIST</a></li>
<li><a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19-py3-none-any.whl" title="download">0.1.19.dev invoice customer and partial invoice total values calculations WHEEL</a></li>
<li><a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19.tar.gz" title="download">0.1.19.dev invoice customer and partial invoice total values calculations DIST</a></li>
<li><a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18-py3-none-any.whl" title="download">0.1.18.dev invoice customer CUI partial invoice total values calculations WHEEL</a></li>
<li><a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18.tar.gz" title="download">0.1.18.dev invoice customer CUI partial invoice total values calculations DIST</a></li>
</ul>
<h2 id="doc_src-downloads-format-msi-instalare-windows-x64">Format MSI instalare Windows x64  <!-- TODO: rdy to test up to v0.1.20 --></h2>
<ul>
<li><a href="xl2roefact/dist/xl2roefact-0.1.20-win64.msi" title="download">0.1.20.dev invoice customer address MSI installer win64</a></li>
<li><a href="xl2roefact/dist/0.1.19/xl2roefact-0.1.19-win64.msi" title="download">0.1.19.dev invoice customer and partial invoice total values calculations MSI installer win64</a></li>
<li><a href="xl2roefact/dist/0.1.18/xl2roefact-0.1.18-win64.msi" title="download">0.1.18.dev invoice customer CUI partial invoice total values calculations MSI installer win64</a></li>
</ul>
<h2 id="doc_src-downloads-format-deb-instalare-linux">Format DEB instalare Linux</h2>
<p>No items available.</p>
<h2 id="doc_src-downloads-format-xlsx-office-excel">Format XLSX Office Excel  <!-- TODO: rdy to test up to v0.1.20 --></h2>
<ul>
<li><a href="excel_invoice_template/invoice_template_CU_tva.xlsx" title="download">office Excel XLSX 0.1.20</a></li>
<li><a href="excel_invoice_template/released_packages/0.1.20-excel_invoice_template.zip" title="download">arhiva ZIP 0.1.20</a></li>
<li><a href="excel_invoice_template/released_packages/0.1.11-excel_invoice_template.zip" title="download">arhiva ZIP 0.1.11</a></li>
</ul>
<p>.</p></section><h1 class='nav-section-title-end'>Ended: Help</h1>
                        <h1 class='nav-section-title' id='section-about'>
                            About <a class='headerlink' href='#section-about' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="doc_src-wip"><h1 id="doc_src-wip-under-construction-page">Under construction page</h1>
<p><img alt="wip page" src="doc_src/pictures/under_maintenance.png" /></p>
<p>UPCOMING...</p></section><section class="print-page" id="changelog"><p><small><strong>RENware Software Systems</strong></small></p>
<p><strong>INVOICEtoROefact</strong> Project</p>
<div class="toc">
<ul>
<li><a href="#changelog-changelog">CHANGELOG</a><ul>
<li><a href="#changelog-01-note_wip">0.1 (-#NOTE_wip...)</a><ul>
<li><a href="#changelog-todo_wip-0122dev-xl2roefact-application-interface-improvements-invoice-customer-info-optional-items-bank-email-reg-com-phone-note-upd-dev-qualifier-set-date-here">#TODO..._wip... 0.1.22.dev xl2roefact application interface improvements &amp; invoice customer info-optional items (bank, email, reg-com, phone) (#NOTE upd ".dev" qualifier &amp; set date here...)</a></li>
<li><a href="#changelog-0121post3-cleaned-system-documentation-and-site-240211-h2359">0.1.21.post3 cleaned system documentation and site (240211 h23:59)</a></li>
<li><a href="#changelog-0121post2-xl2roefact-app-detailed-section-with-commands-options-help-like-240206-h2359">0.1.21.post2 xl2roefact app detailed section with commands &amp; options "--help" like (240206 h23:59)</a></li>
<li><a href="#changelog-0121post1-fixed-missing-links-in-site-root-index-page-240203-h1030">0.1.21.post1 fixed missing links in site root index page (240203 h10:30)</a></li>
<li><a href="#changelog-0121-rollout-news-in-system-portal-invoicetoroefactrenwareeu-240203-h0900">0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)</a></li>
<li><a href="#changelog-0120dev-invoice-customer-address-240123-h1000">0.1.20.dev invoice customer address (240123 h10:00)</a></li>
<li><a href="#changelog-0119dev-invoice-customer-and-partial-invoice-total-values-calculations-240116-h0600">0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)</a></li>
<li><a href="#changelog-0118dev-invoice-customer-cui-partial-invoice-total-values-calculations-240105-h0800">0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)</a></li>
<li><a href="#changelog-0117dev-fixed-all-application-package-running-standard-ways-231224-h0530">0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#changelog-archived-changelogs">Archived CHANGELOGs</a></li>
</ul>
</div>
<h1 id="changelog-changelog">CHANGELOG</h1>
<ul>
<li>For version code structure meaning see SDEVEN methodology document</li>
<li>with <em>(F)</em> are marked those changes that are features in order to be copied in a RELNOTE file and with <em>(B)</em> bug fixes from versions released</li>
<li>publishing is made under <code>publishing</code> branch</li>
<li><code>&lt;PROJECT ROOT&gt;/doc_src/</code> is the default starting location in a file path (if not clear from context) (<strong>ATTN</strong> - in production environment is <code>docs/</code>)</li>
<li><code>&lt;WEB_ROOT&gt;/</code> is the HTTP server root directory, as default <code>docs/</code> and supposed if no other parent is specified</li>
</ul>
<h2 id="changelog-01-note_wip">0.1 (-#NOTE_wip...)</h2>
<div class="highlight"><pre><span></span><code>    - ---[ #TODO general planning board ]---------------------------
    * ai un exemplu complet si complet agnostic (trimis Gigi) de factura format XML si PDF tiparit ca sa faci: (1) incarcare XML (2) geenrare PDF (3) compararea variantelor si identificarea schemei XSD + document specificatii ANAF ref sistemul E-Factura (PDF trimis Liviu)
    * -#NOTE link Swagger servicii web: `https://mfinante.gov.ro/web/efactura/informatii-tehnice`
    * -#NOTE link specif API incarcare fact: `https://mfinante.gov.ro/static/10/eFactura/upload.html#/EFacturaUpload/handleRequest`

    - ---[ #TODO short planning board ]---------------------------
    * left OPEN ISSUES on: `0.1.7` release (and drop them when fixed).
      ...Aici descrierea pe scurt: in file `xl2roefact\invoice_files/_PLAN_model_test_factura_generat_anaf.xml`, line 114:_ `&lt;cbc:ID&gt;S&lt;/cbc:ID&gt; #FIXME clarify.me_ pare a fi TIPUL PRODUSULUI: (S)erviciu sau ??? (P)rodus sau ???`
    -
    * ... FUTURE NEW APP COMMANDS :
        * `config` - set `config_settings.py` variables (make it INTERACTIVELY using `Rich prompt`)
        * `xl2json` - crt_wip... (last upd @ 240123)
        * `json2xml` - see module WRXML,
        * `json2pdf` - new tbd..,
        * `xml2roefact` - see mpdule LDXML
        * chk for other commands from doc `https://apitoroefact.renware.eu/commercial_agreement/110-SRE-api_to_roefact_requirements.html#componenta-xl2roefact`
    -
    * -#NOTE_PLAN `rdinv` module:
        * invoice header
            * [ ] wip... invoice header - customer bank, RegCom, email, tel, ...
            * [ ] invoice header - supplier (`&lt;cac:AccountingSupplierParty&gt;`)
            * [ ] invoice grand totals (there was left a comment ref whole XML structure in rdinv(), line # ~ where build &amp; write &quot;Invoice&quot; key)
    -------------------------------------------------------------------------------------------------
</code></pre></div>
<h3 id="changelog-todo_wip-0122dev-xl2roefact-application-interface-improvements-invoice-customer-info-optional-items-bank-email-reg-com-phone-note-upd-dev-qualifier-set-date-here">#TODO..._wip... 0.1.22.dev xl2roefact application interface improvements &amp; invoice customer info-optional items (bank, email, reg-com, phone) (#NOTE upd ".dev" qualifier &amp; set date here...)</h3>
<ul>
<li>
<p>tbd.Must... @RELEASE <a href="#release-qa_checklist">follow <code>/RELEASE-QA_checklist.md</code></a></p>
</li>
<li>
<p>tbd.Would... automate GitHub site build &amp; publishing. See file <code>/gh_mkdocs_auto_publish.md</code>.</p>
</li>
<li>
<p>tbd.Should... [piu_240126] left in <code>setup.py</code> comments &amp; example ref how to <strong><em>pre-set MSI build meta information</em></strong> / parameters (obj: default target dir where install, path registration, ...)</p>
</li>
<li>
<p>tbd.Must... publish <code>xl2roefact</code> package --&gt; read <code>TODO_packaging.md</code></p>
</li>
<li>
<p>tbd.Could... init a PDM simple env in project root. Keep in mind:</p>
<ul>
<li>root project is for SITE GENERATION. ? the <code>web2roefact</code> will need its own directory5like <code>xl2roefact</code> ?</li>
<li>as consequence the project name is <strong>INVOICEtoROefact</strong></li>
<li>and the version is last from CHANGELOG</li>
</ul>
</li>
<li>
<p>tbd.Must... invoice customer search for other keys: "reg com", "bank / IBAN / cont", "tel", "email" (start in <code>rdinv()</code> w./line 179 &amp; then 331)</p>
</li>
<li>
<p>wip...</p>
</li>
<li>
<p>TODO: wip ...240214piu_b make in site a dedicated page for downloads: "Help --&gt; Downloads" and refer it in all places where downloads are intended. Detailed specs:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> dedicated downloads page <code>doc_src/downloads.md</code>  #NOTE use template from main README.md</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> collected all existing dwndld links in <code>doc_src/downloads.md</code> - need to be moved at their right positions in file</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> for next items, in <code>downloads.md</code> there are <strong>already built links to sections</strong> (as html comments in file):<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> refer that page in <code>xl2roefact/README.md</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> refer that page in <code>xl2roefact/doc/README_xl2roefact_library.md</code>, <code>excel_invoice_template/README.md</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> refer that page in <code>excel_invoice_template/README.md</code></li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <code>mkdocs.yml</code> nav entry for  "Help --&gt; Descarcare resurse (Downloads)" to <code>doc_src/downloads.md</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> fill in <code>...downloads.md</code> page with all existing deliverables GROUPED BY file types &amp; ORDER BY version DESC</li>
</ul>
</li>
<li>
<p>-------TODO:.from.here.to.up:-------- test &amp; rebuild all (<code>pdm build_all</code>) &amp; site. Updates to check:
        - page "Help --&gt; Downloads" (or in topnav area?)
        - <code>app_cli.settings()</code> function docstring: display arguments in "Referinta API"
        - chk if show <code>-r</code>  option in "Referinta CLI"</p>
</li>
<li>
<p>240214piu_c.BUGFIX ref <code>240213piu_a.FAILED</code> fixed &amp; enabled <code>.github/.../ci.yml</code>. To test by merging to <code>build</code></p>
</li>
<li>240214piu_a xl2roefact component (<code>.../app_cli.py</code>) function <code>settings(...)</code> add <code>--rules</code> option (param) to display <code>config_settings.__doc__</code></li>
<li>240213piu_a.FAILED merged for <code>/requirements.txt</code> lief package update as OK-PAS &amp; disabled gh-workflow by renaming <code>ci.yml</code> to <code>ci.yml temp_disabled</code>. Actions tried:  (-1.) updated <code>.gh-workflow.../ci.yml</code>  (-2.) "small change" in <code>/README.md</code> in copyright year to test  (-3.) merge to <code>build</code> branch for test</li>
<li>240212piu_e.BUGFIX navigation "xl2roefact --&gt; Referinta CLI" (file <code>/mkdocs.yml</code>). Updated <code>xl2roefact/README.md</code> add a <code>&lt;a id="comenzile-aplicatiei"&gt;&lt;/a&gt;</code> after header "## Comenzile aplicatiei" paragraph "Detalii comenzi:" and ref it accordingly in mkdocs.yml navigation following HTML file, not MARKDOWN one</li>
<li>240212piu_d rebuild all deliverables <code>pdm build_all</code> ==&gt; v0.1.22 MSI, WHL, SDIST &amp; moved them to a dedicated <code>_WIP_0.1.22_/</code> until decide to rebuild or keep</li>
<li>240212piu_c added navigation "xl2roefact --&gt; Referinta CLI" (file <code>/mkdocs.yml</code>). Built &amp; published site (<code>mkdocs build</code>).</li>
<li>240212piu_b updated <code>.../xl2roefact/app_cli.py</code> to format app logo string as markdown. Updated packages (<code>pdm build_all</code>).</li>
<li>240212piu_a review and updated xl2roefact logo (file: <code>...xl2roefact/__version__</code>). Updated API Reference doc (<code>pdm build_doc</code>). Clean project of obsolete files &amp; open issues</li>
</ul>
<h3 id="changelog-0121post3-cleaned-system-documentation-and-site-240211-h2359">0.1.21.post3 cleaned system documentation and site (240211 h23:59)</h3>
<ul>
<li>240211piu_b tested &amp; reviewed <code>240211piu_a</code> ==&gt; published site</li>
<li>240211piu_a updated <code>xl2roefact/README.md</code> clean section "Instalarea", preserved only Windows and Linux specs to run CLI component, ie, dropped library references as irrelevant at this point</li>
<li>240210piu_b test for iss <code>240210piu_a</code> ==&gt; PASS<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> app as functional (there are updates in code),</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> re-build tech doc (<code>pdm build_doc</code>),</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> build &amp; publish site</li>
</ul>
</li>
<li>240210piu_a reviewed &amp; updated all <code>xl2roefact</code> modules for their docstring</li>
<li>240209piu_c updated <code>xl2roefact</code> component, README file, restructured info ref JSON file format (dropped redundant info)</li>
<li>240209piu_b reviewed &amp; corrected <code>240209piu_a, 240208piu_a</code>. Published site</li>
<li>240209piu_a updated <code>xl2roefact *</code> documentation to drop redundant info (badges, prev versions useless details)</li>
<li>240208piu_a updated <code>xl2roefact library</code> documentation, docstring(s) and <code>mkdocs.yml</code> navigation entries to clarify subjects by using specific technical terms (this component address technical users not business ones)</li>
<li>240207piu_b improve site readability by detailed description at bullet items level and dropping / moving in other parts the content non "end user related" from: <code>/README.md</code>, <code>doc_src/.../810.05a-system_components.md</code></li>
<li>240207piu_a updated all site in pages references to system components &amp; deliverables version</li>
</ul>
<h3 id="changelog-0121post2-xl2roefact-app-detailed-section-with-commands-options-help-like-240206-h2359">0.1.21.post2 xl2roefact app detailed section with commands &amp; options "--help" like (240206 h23:59)</h3>
<ul>
<li>240206piu_c test &amp; release: -- create release, -- publish site, -- save deliverable archives</li>
<li>240206piu_b install package: <code>pip install mkdocs-typer</code> &amp; upd back <code>requirements.txt</code></li>
<li>240206piu_a add <code>mkdocs-typer</code> extension and update <code>xl2roefact/README.md</code>, section <code>Comenzile aplicatiei</code> page with generated documentation by this plugin</li>
</ul>
<h3 id="changelog-0121post1-fixed-missing-links-in-site-root-index-page-240203-h1030">0.1.21.post1 fixed missing links in site root index page (240203 h10:30)</h3>
<ul>
<li>240203piu_a fixed links in <code>/README.md</code> for: <code>xl2roefact PyPi</code> entry</li>
</ul>
<h3 id="changelog-0121-rollout-news-in-system-portal-invoicetoroefactrenwareeu-240203-h0900">0.1.21 rollout news in system portal invoicetoroefact.renware.eu (240203 h09:00)</h3>
<ul>
<li>240201piu_a reorganized <code>xl2roefact*</code> components by disseminating the installable application, which is something available "as is now" just for Windows operating system. For Linux there is no difference between command line application and Python package <em>from an end user point of view</em>.</li>
<li>240131piu_a <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code> clean &amp; transform to "first entry to <code>xl2roefactPyPi</code>"</li>
<li>240131piu_a updated <code>mkdocs.yml</code>: cleaned navigation, created version variables, updated default site build directory to <code>docs/</code>, cleared excluded directories entry</li>
<li>240130piu_b reviewed all changes, update site PDF generator file (mvd <code>print_page.md</code> to root) location, fixed navigation. PUBLISHED for <code>xl2roefact</code> component</li>
<li>240130piu_a reviewed <code>xl2roefact</code> README: cleaned, translated 2 RO, structured to "end user needs"</li>
<li>240129piu_d updated <code>xl2roefact</code> to have "Descrierea detliata" link in <code>810.05a-system_components.md</code>. Prepared component to be published: mkdocs.yml navigation &amp; main site README index</li>
<li>240129piu_c updated all site pages to contain <code>&lt;small&gt;**RENware Software Systems**&lt;/small&gt;</code> &amp; <code>[TOC]</code> after title</li>
<li>240129piu_b cleanup project docs, requirements, fresh install ==&gt; published site as is at this point (invoice template finished)</li>
<li>240129piu_a updated <code>xl2roefact/README.md</code> with section for assets download</li>
<li>240128piu_e formal versioning <code>invoice template</code> component</li>
<li>240128piu_d updated &amp; closed component <code>invoice template</code>. Referred in:<ul>
<li><code>doc_src/810-DSGN/810.05a-system_components.md</code></li>
<li>portal first page</li>
<li>navigation in <code>mkdocs.yml</code></li>
</ul>
</li>
<li>240128piu_c moved <code>xl2roefact/excel_invoice_template/</code> directory to root as being distinct component, review it and closed to be published</li>
<li>240128piu_b revised, updated and closed crt version of <code>excel_invoice_template/README.md</code></li>
<li>240128piu_a updated <code>xl2roefact/README.md</code> &amp; <code>excel_invoice_template/README.md</code> files, cleared modularization &amp; structure presented in system public site</li>
<li>240127piu_d Unify main project <code>/READMEmd</code> with <code>doc_src/index.md</code>:<ul>
<li>make the same INDEX just in the project root == index / README of whole project</li>
<li>keep from actual project README.md the section ref project identification and move it to end of file as last section</li>
</ul>
</li>
<li>240127piu_c created <code>/index.html</code> to redirect to "real" system index (<code>doc_src/index.md</code>) and prevent usage of project <code>README.md</code> file instead</li>
<li>240128piu_c checked work <code>240127piu_a</code>, <code>240127piu_b</code>, updated <code>about.md</code> and navigation with ref to sys structure (<code>.../810.05a-system_components.md</code>)</li>
<li>240127piu_b update system components and their classification (in <code>.../810-DSGN/810.05a-system_components.md</code>)</li>
<li>240127piu_a updated <code>810-DSGN/810.05a-system_components.md</code>, defined a classification usable to quickly find out <em>who-does-what</em></li>
<li>240125piu_a updated <code>mkdocs.yml</code> by including <code>mkdocs-same-dir</code> plug-in</li>
</ul>
<h3 id="changelog-0120dev-invoice-customer-address-240123-h1000">0.1.20.dev invoice customer address (240123 h10:00)</h3>
<ul>
<li>
<p>240123piu_b make a full chk / review for FIXME &amp; run <code>pdm build_all</code></p>
</li>
<li>
<p>240123piu_a <code>def_inv_dir</code> issue ref Excel invoices default get directory, see comments in <code>app_cli.py</code> function <code>xl2json(...)</code></p>
</li>
<li>
<p>240121piu_a updated <code>config_settings.py</code> &amp; <code>rdinv.py</code> with constants: <code>PATTERN_FOR_PARTNER_REGCOM</code>, <code>PATTERN_FOR_PARTNER_IBAN</code>, <code>PATTERN_FOR_PARTNER_TEL</code>, <code>PATTERN_FOR_PARTNER_EMAIL</code>, <code>PATTERN_FOR_PARTNER_BANK</code></p>
</li>
<li>
<p>@CANCELED 240118_admin02 generalize a function <code>get_partner_info(partner_type: str "customer" | "supplier")</code> to get partner info with partner type as being parameter</p>
</li>
<li>
<p>240118piu_a reviewed and cleaned code: <code>rdinv.rdinv()</code>, <code>config_settings</code>, <code>excel_invoice_template/invoice_template_CU_tva.xlsx</code> (according to updates in testing used invoice)</p>
</li>
<li>
<p>240113piu_a to find <code>cac:PostalAddress</code> and write to:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 1. right set position of key <code>"cac_PostalAddress"</code> in basic structure (invoice_header_area)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 2a. find excel area ref customer address (...invoice_header_area...)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 2b. disseminate &amp; save excel original area (...invoice_header_area...)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 3. get &amp; set <code>["Invoice"]["cac_PostalAddress"]</code> and all is subsequent keys</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 4. update XML - JSON map for item "under" <code>cac_PostalAddress</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 5. defined and included for use <code>DEFAULT_SUPPLIER_COUNTRY</code> and <code>DEFAULT_CUSTOMER_COUNTRY</code> both for "RO". Detailed desc and usage in <code>config_settings.py</code> &amp; <code>rdinv.rdinv(...)</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 6. updated invoice template for country explicit field</li>
</ul>
</li>
<li>
<p>240116_admin_01 upd <strong>version</strong> for 0.1.20</p>
</li>
</ul>
<h3 id="changelog-0119dev-invoice-customer-and-partial-invoice-total-values-calculations-240116-h0600">0.1.19.dev invoice customer and partial invoice total values calculations (240116 h06:00)</h3>
<ul>
<li>
<p>2401_xl2roefact_doc_01 <code>xl2roefact</code> update technical documentation, file <code>xl2roefact/doc/810.05a-xl2roefact_component.md</code></p>
</li>
<li>
<p>240112piu_b 95% clean code <code>rdinv()</code> from customer area identification, from line 204 (kept a DBG print just for area identification (useful for next task ref the same opers but for Supplier))</p>
</li>
<li>
<p>240112piu_a module <code>app_cli.py</code>, created <code>called_when_no_command(...)</code> function called when no command is invoked and to provide only application version (for external users to test it!)</p>
</li>
<li>
<p>240110piu_c <code>xl2json</code> <code>about</code> command to get version &amp; "nice" LOGO from <code>xl2roefact/__version__.py</code>, vars <code>__version__</code> &amp; <code>__doc__</code></p>
</li>
<li>
<p>240110piu_b <code>xl2roefact/setup.py</code>ref get app version from file when build EXE/MSI test for <code>__version__</code> is correctly get and release</p>
</li>
<li>
<p>240110piu.a reviewed &amp; updated <code>xl2roefact</code> package <code>README.md</code> + <code>xl2roefact/__version__.py</code> with an app logo and for text mistyping bugs</p>
</li>
<li>
<p>240108piu_c changed <code>pyproject.toml</code> for auto update package version from file <code>xl2roefact/__version__.py</code> (see also opiss 240108piu_b)</p>
</li>
<li>
<p>240108piu_b created <code>xl2roefact/__version__</code> file that contains variable <code>__version__</code> with INTENTION to use in <code>pyproject.toml</code> for app version key (in a future issue)</p>
</li>
<li>
<p>240108piu_a more items:</p>
<ul>
<li><code>config_settings.py</code> created entry <code>PATTERN_FOR_PARTNER_ADDRESS</code> &amp; updated <code>rdinv</code> module in constants area</li>
<li>add comments in <code>app_cli.py</code> ref <code>def_inv_dir</code> issue &amp;&amp;...</li>
<li>updated environment dependencies and installed <code>pyinstaller</code> development package with intention to make "single EXE" application to be able to run "from USB stick"</li>
</ul>
</li>
<li>
<p>240107piu_a reviewed <code>xl2roefact</code> package <code>README.md</code>:</p>
<ul>
<li>(c) explained proposed &amp; promoted directory structure used by CLI application</li>
<li>(b) short invoice JSON file structure</li>
<li>(a) created first version of tutorial section</li>
</ul>
</li>
<li>
<p>240106piu_a invoice customer search and persist for "RegistrationName"</p>
</li>
</ul>
<h3 id="changelog-0118dev-invoice-customer-cui-partial-invoice-total-values-calculations-240105-h0800">0.1.18.dev invoice customer CUI partial invoice total values calculations  (240105 h08:00)</h3>
<ul>
<li>
<p>240105piu_c updated <code>xl2roefact</code> package <code>README.md</code> file (with new sections for intro to Excel invoice content rules, tutorial TODO, reference to technical doc)</p>
</li>
<li>
<p>240105piu_b invoice customer search and persist for "CUI"</p>
</li>
<li>
<p>240105piu_a <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for DOWN search-method made it optional with default True (useful for Partners set-of KVs where is supposed to be or IN-LABEL or in RIGHT but NOT DOWN because there is a list of KVs not just one placed anywhere in Excel doc)  #TODO tgis is subject of doc update</p>
</li>
<li>
<p>240103piu_d <code>rdinv.def get_excel_data_at_label(...)</code> changed strategy for IN-LABEL search-method to return all string except first word (supposed to be label) separated by space character (old strategy was to get only last work from all string)</p>
</li>
<li>
<p>240103piu_c ref invoice customer created in <code>config_settings.py</code> PATTERNs for search keys <code>PATTERN_FOR_PARTNER_ID</code> (CUI or ID), <code>PATTERN_FOR_PARTNER_LEGAL_NAME</code></p>
</li>
<li>
<p>240103piu_b calculated item lines VAT amount as <code>cac_InvoiceLine.LineVatAmmount</code> as raw float value (not rounded to be able to round just invoice TOTAL)</p>
</li>
<li>
<p>240103piu_a <code>rdinv.rdinv()</code> updated JSON -- XML map (part of function <code>_build_meta_info_key(...)</code>)</p>
</li>
<li>
<p>240102piu_a <code>rdinv.rdinv()</code> upd &amp; improved a clear Customer specific XML compliant structure. Targeted this XML structure:
                <div class="highlight"><pre><span></span><code>    &lt;cac:PartyLegalEntity&gt;
        &lt;cbc:RegistrationName&gt;IORDANESCU PETRE PFA&lt;/cbc:RegistrationName&gt;
        &lt;cbc:CompanyID&gt;21986376&lt;/cbc:CompanyID&gt;
    &lt;/cac:PartyLegalEntity&gt;
</code></pre></div></p>
</li>
<li>
<p>240101piu_a clean useless &amp; obsolete project files, test new full build (MSI, Python wheel, documentation) ==&gt; PASS OK</p>
</li>
<li>
<p>231229piu_a invoice customer (<code>&lt;cac:AccountingCustomerParty&gt;</code>) detect &amp; set area to search for specific keys (like CUI, RegCom, IBAN, ...)</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 1. established AREA TO SEARCH for PARTNER data an <code>_area_to_search</code> (~line 244)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 2. updated <code>config_settings.py</code> changed: (for a clear understating of constant scope, because will follow others for specific keys like: "reg com", "CUI", "bank / IBAN / cont", ...)<ul>
<li><code>PATTERN_FOR_INVOICE_CUSTOMER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_CUSTOMER_SUBTABLE_MARKER</code></li>
<li><code>PATTERN_FOR_INVOICE_SUPPLIER_LABEL</code> --&gt; <code>PATTERN_FOR_INVOICE_SUPPLIER_SUBTABLE_MARKER</code></li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 3. set-persist <code>_area_to_search</code> for next steps &amp; save its key-info in associated invoice JSON (for further references) - <code>rdinv()</code> ~line 239</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 4. updated main xl2roefact README.md document ref latter changes and app structuring, concepts, ...(ideas evolving :)...</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 5. done code for <code>cac_AccountingSupplierParty</code> key by iterating full <code>invoice_header_area["customer_area"]</code> structure</li>
</ul>
</li>
<li>
<p>231228piu_a improved documentation generation:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> updated all modules docstring(s) to a right markdown representation in generated documentation (ex: when use bullets THEN DO NOT indent at 1st level)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong>@IMP_NOTE:</strong> Changed generated documentation file to <code>doc/810.05a-xl2roefact_DLD_specs.md</code> and referred in main <code>doc/810.05a-xl2roefact_component.md</code> as this being a final solution for whole project documentation (that generated with <code>mkdocs</code>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> updated <code>pyproject.toml, [tool.pdm.scripts]</code> table with new generated doc file name (810.05a-xl2roefact_DLD_specs.md)</li>
</ul>
</li>
<li>
<p>231227piu_b updated <code>xl2roefact.rdinv</code> module ref dropped <code>_</code> chars from internal function names to allow doc generation by PyDoc until will produce a YAML file for PyDoc generator (where will be able to specify concrete list of objects regarding their names)</p>
</li>
<li>
<p>231227piu_a generated a first draft of markdown documentation:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> used Pydoc Markdown @ <code>https://niklasrosenstein.github.io/pydoc-markdown/usage/yaml/#yaml-example</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> results ==&gt; <code>&lt;PJ_ROOT&gt;/xl2roefact/doc/generated_810.05a-xl2roefact_component.md</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> created PDM shell command <code>pdm run</code> (command just for quick remembers: <code>pydoc-markdown -I xl2roefact --render-toc &gt;doc/generated_810.05a-xl2roefact_component.md</code>)</li>
</ul>
</li>
<li>
<p>231226piu_b reviewed <code>xl2roefact</code> all "in use" code and updated <code>docstrings</code></p>
</li>
<li>
<p>231226piu_a made some useful PDM scripts (ref <code>pyproject.toml</code>, table section <code>[tool.pdm.scripts]</code>) like build commands for:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong><code>pdm build_wheel</code></strong> Python package,</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong><code>pdm build_msi</code></strong> MSI package,</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong><code>pdm build_all</code></strong> build all packages</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong><code>pdm xl2roefact</code></strong> run xl2roefact command</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> updated <code>doc/810.05a-xl2roefact_component.md</code></li>
</ul>
</li>
</ul>
<h3 id="changelog-0117dev-fixed-all-application-package-running-standard-ways-231224-h0530">0.1.17.dev fixed all application &amp; package running standard ways (231224 h05:30)</h3>
<ul>
<li>
<p>RELEASES:</p>
<ul>
<li><code>.&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-win64.msi</code></li>
<li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17.tar.gz</code></li>
<li><code>&lt;PROJECT&gt;/xl2roefact/dist/xl2roefact-0.1.17-py3-none-any.whl</code></li>
</ul>
</li>
<li>
<p>231224piu_a made cli app to run as: Python package main app (<code>python -m xl2roefact</code>) and as script (<code>python xl2roefact.py</code>) while still letting the Python library <code>xl2roefact</code> as importable and use in a programmatic way:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> make <code>.../xl2roefact/app_cli.py</code> (from actual <code>.../xl2roefact/__main__.py</code>) which is complete code of CLI app plus a <code>run()</code> function that just launch it</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> make <code>.../xl2roefact/__main__.py</code> that just import <code>app_cli</code> for <code>run()</code> function and call it</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> change actual <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code> to import <code>xl2roefact.app_cli</code> for <code>run()</code> function and call it</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> test for MSI package builds ref <code>&lt;xl2roefact ROOT/&gt;xl2roefact.py</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> clean code, test and close issue:<ul>
<li><code>python xl2roefact.py [OPTIONS] COMMAND [ARGS]...</code></li>
<li><code>python -m xl2roefact [OPTIONS] COMMAND [ARGS]...</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>231223piu_a multiple changes ref main code: <code>xl2roefact.py</code> and library <code>xl2roefact</code>, MAINLY created <code>xl2roefact/__main__.py</code> as normal of xl2roefact.py</p>
</li>
</ul>
<h1 id="changelog-archived-changelogs">Archived CHANGELOGs</h1>
<ul>
<li><a href="#changelog_history-changelog-0.1.16.dev">0.1.16.dev improving Excel kv-data search with "IN-LABEL" method</a></li>
<li><a href="#changelog_history-changelog-0.1.15">0.1.15 updated solution portal <code>http://invoicetoroefact.renware.eu/</code></a></li>
<li><a href="#changelog_history-changelog-0.1.14.dev">0.1.14.dev invoice issue date</a></li>
<li><a href="#changelog_history-changelog-0.1.13.dev">0.1.13.dev invoice currency</a></li>
<li><a href="#changelog_history-changelog-0.1.12.dev">0.1.12.dev invoice number</a></li>
<li><a href="#changelog_history-changelog-0.1.11.dev">0.1.11.dev packaging improvements for app &amp; xl2roefact package</a></li>
<li><a href="#changelog_history-changelog-0.1.10.dev">0.1.10.dev command interface improved, <code>msi</code> package building, invoice template &amp; updated documentation</a></li>
<li><a href="#changelog_history-changelog-0.1.9.dev">0.1.9.dev <code>xl2roefact.RDINV</code> running executable and distribution kit</a></li>
<li><a href="#changelog_history-changelog-0.1.8.dev">0.1.8.dev improved application structure and first executable release</a></li>
<li><a href="#changelog_history-changelog-0.1.7.dev">0.1.7.dev <code>xl2roefact.RDINV</code> invoice items &amp; metadata + <em>OPEN ISSUES</em></a></li>
<li><a href="#changelog_history-changelog-0.1.6.dev">0.1.6.dev commercial agreement OPTIONS document</a></li>
<li><a href="#changelog_history-changelog-0.1.5.dev">0.1.5.dev init component <em>xl2roefact</em> for CLI application</a></li>
<li><a href="#changelog_history-changelog-0.1.4.dev">0.1.4.dev Create system backbone structure</a></li>
<li><a href="#changelog_history-changelog-0.1.3.dev">0.1.3.dev Enhancing <code>payments_validation_board</code> technical proposal</a></li>
<li><a href="#changelog_history-changelog-0.1.2.dev">0.1.2.dev Enhancing <code>APItoROefact</code> technical proposal</a></li>
<li><a href="#changelog_history-changelog-0.1.1.dev">0.1.1.dev Elaborating technical proposal</a></li>
<li><a href="#changelog_history-changelog-0.1.0.dev">0.1.0.dev System raw backbone</a></li>
</ul>
<!-- #TODO create this ? released notes are alreay (@240207) published in GitHub releases

# [Release Notes](RELNOTE.md)

* wip... [not_yet_created... 0.1]  (./changelog_history/...)

--></section><h1 class='nav-section-title-end'>Ended: About</h1></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) RENware Software Systems
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "/", "features": ["navigation.tabs", "navigation.tracking", "navigation.tabs.sticky", "navigation.path"], "search": "assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="js/print-site.js"></script>
        
      
        
          <script src="optionalConfig.js"></script>
        
      
        
          <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
        
      
        
          <script src="extra-loader.js"></script>
        
      
    
  </body>
</html>